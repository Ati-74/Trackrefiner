<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="Welcome to Trackrefiner’s documentation!" href="index.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Modules - Trackrefiner 2025 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Trackrefiner 2025 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">Trackrefiner 2025 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Modules</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/modules.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Link to this heading">¶</a></h1>
<section id="module-processCellProfilerData">
<span id="module-processcellprofilerdata"></span><h2>Module: processCellProfilerData<a class="headerlink" href="#module-processCellProfilerData" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="processCellProfilerData.process_objects_data">
<span class="sig-prename descclassname"><span class="pre">processCellProfilerData.</span></span><span class="sig-name descname"><span class="pre">process_objects_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp_output_csv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segmentation_res_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_csv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doubling_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elongation_rate_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_per_micron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assigning_cell_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_tracking_correction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_boundaries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_boundaries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_npy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">command</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/processCellProfilerData.html#process_objects_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#processCellProfilerData.process_objects_data" title="Link to this definition">¶</a></dt>
<dd><p>Processes CellProfiler output data, performs tracking correction, assigns cell types,
and calculates additional features related to the life history of bacteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp_output_csv</strong> (<em>str</em>) – Path to the CellProfiler output file in CSV format, which contains measured bacterial features.</p></li>
<li><p><strong>segmentation_res_dir</strong> (<em>str</em>) – Path to the directory containing npy files (segmentation results exported from the CellProfiler pipeline).</p></li>
<li><p><strong>neighbor_csv</strong> (<em>str</em>) – Path to a CSV file containing information about the neighbors of each object.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Path to the directory where processed output files will be saved.</p></li>
<li><p><strong>interval_time</strong> (<em>float</em>) – Time interval between consecutive images (in minutes).</p></li>
<li><p><strong>doubling_time</strong> (<em>float</em>) – Minimum life history duration of bacteria (in minutes) for analysis.</p></li>
<li><p><strong>elongation_rate_method</strong> (<em>str</em>) – Method for calculating the elongation rate. Options:
- ‘Average’: Computes average growth rate.
- ‘Linear Regression’: Estimates growth rate using linear regression.</p></li>
<li><p><strong>pixel_per_micron</strong> (<em>float</em>) – Conversion factor for pixels to microns (e.g., default value is 0.144).</p></li>
<li><p><strong>assigning_cell_type</strong> (<em>bool</em>) – If True, assigns cell types to objects based on intensity thresholds.</p></li>
<li><p><strong>intensity_threshold</strong> (<em>float</em>) – Threshold to classify objects into specific cell types based on intensity values.</p></li>
<li><p><strong>disable_tracking_correction</strong> (<em>bool</em>) – If True, disables tracking correction and performs calculations directly on the CellProfiler output data.</p></li>
<li><p><strong>clf</strong> (<em>str</em>) – Name of the classifier to be used for model training during tracking correction.
Options: ‘LogisticRegression’, ‘GaussianProcessClassifier’, ‘C-Support Vector Classifier’.</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>) – Number of CPU cores to be used for parallel computing.
- <cite>-1</cite> indicates that all available CPUs will be utilized.</p></li>
<li><p><strong>image_boundaries</strong> (<em>str</em>) – Boundary limits defined for all time steps to filter out objects outside the image area.</p></li>
<li><p><strong>dynamic_boundaries</strong> (<em>str</em>) – Path to a CSV file specifying boundary limits for each time step. The file should contain columns:
<cite>Time Step</cite>, <cite>Lower X Limit</cite>, <cite>Upper X Limit</cite>, <cite>Lower Y Limit</cite>, <cite>Upper Y Limit</cite>.</p></li>
<li><p><strong>save_npy</strong> (<em>bool</em>) – If True, results are saved in <cite>.npy</cite> format.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, displays warnings and additional details during processing.</p></li>
<li><p><strong>command</strong> (<em>str</em>) – User’s Command Statement</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. Processed data and outputs are saved to the specified <code class="docutils literal notranslate"><span class="pre">out_dir</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-findFixTrackingErrors">
<span id="module-findfixtrackingerrors"></span><h2>Module: findFixTrackingErrors<a class="headerlink" href="#module-findFixTrackingErrors" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="findFixTrackingErrors.calculate_bacteria_features_and_assign_flags">
<span class="sig-prename descclassname"><span class="pre">findFixTrackingErrors.</span></span><span class="sig-name descname"><span class="pre">calculate_bacteria_features_and_assign_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assigning_cell_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findFixTrackingErrors.html#calculate_bacteria_features_and_assign_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findFixTrackingErrors.calculate_bacteria_features_and_assign_flags" title="Link to this definition">¶</a></dt>
<dd><p>Calculate bacterial features and assign initial flags for further analysis.</p>
<p>This function computes features related to bacterial behavior, such as movement, division, life history,
and spatial relationships. Additionally, it assigns flags and classifications (e.g., division flags,
unexpected events, and daughters assignment) for downstream analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pd.DataFrame</em>) – Input dataframe containing bacterial measured bacterial features.</p></li>
<li><p><strong>intensity_threshold</strong> (<em>float</em>) – Threshold value used for intensity-based cell type assignment.</p></li>
<li><p><strong>assigning_cell_type</strong> (<em>bool</em>) – Whether to assign cell types based on intensity values.</p></li>
<li><p><strong>neighbor_df</strong> (<em>pd.DataFrame</em>) – Dataframe containing information about neighboring bacteria.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of bacterial centers.
Example: {‘x’: ‘Center_X’, ‘y’: ‘Center_Y’}</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the dataframe.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the dataframe.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple:</p>
<ul class="simple">
<li><p><strong>dataframe</strong> (<em>pd.DataFrame</em>): Updated dataframe with calculated features and assigned flags.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>): Sparse matrix indicating neighboring relationships between bacteria.</p></li>
<li><p><strong>cell_type_array</strong> (<em>np.array</em>): Array containing assigned cell types if <cite>assigning_cell_type</cite> is True;
otherwise, an empty array.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findFixTrackingErrors.find_fix_tracking_errors">
<span class="sig-prename descclassname"><span class="pre">findFixTrackingErrors.</span></span><span class="sig-name descname"><span class="pre">find_fix_tracking_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp_output_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted_seg_npy_files_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_rel_center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doubling_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_per_micron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.144</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assigning_cell_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_tracking_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_boundaries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_boundaries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findFixTrackingErrors.html#find_fix_tracking_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findFixTrackingErrors.find_fix_tracking_errors" title="Link to this definition">¶</a></dt>
<dd><p>This function detects and corrects tracking errors in bacterial tracking data. It applies a comprehensive pipeline
that includes filter out objects outside the image area, noise removal, feature calculation,
training machine learning models for behavioral analysis, resolving tracking errors, and generating logs.</p>
<dl class="simple">
<dt><strong>Key Steps</strong>:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt><strong>Unit Conversion</strong>:</dt><dd><p>Converts tracking data units (e.g., pixel to micron) for consistency.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Boundary Checking</strong>:</dt><dd><p>Ensures bacteria remain within defined image or dynamic boundaries.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Noise Removal</strong>:</dt><dd><p>Removes small or low-intensity objects that may represent noise.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Feature Calculation</strong>:</dt><dd><p>Computes features like length, direction, and motion alignment for all bacteria.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Model Training</strong>:</dt><dd><p>Trains machine learning models for bacterial behavior:
- <strong>Division vs. Non-Division</strong>: Identifies dividing bacteria.
- <strong>Continuity</strong>: Tracks the life history of bacteria across frames.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Error Resolution</strong>:</dt><dd><ul class="simple">
<li><p>Resolves over assigned daughters, redundant parent links and missing connectivity.</p></li>
<li><p>Handles unexpected beginnings and ends in tracking.</p></li>
<li><p>Restores tracking links removed due to errors in previous steps.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Label Propagation</strong>:</dt><dd><p>Reassigns sequential IDs and propagates labels for corrected data.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Log Generation</strong>:</dt><dd><p>Creates a detailed log of all corrections, errors, and progress.</p>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp_output_df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame from the CellProfiler pipeline containing tracking information and measured bacterial features.</p></li>
<li><p><strong>sorted_seg_npy_files_list</strong> (<em>list</em>) – List of sorted <cite>.npy</cite> files containing segmentation masks for each time step.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame representing neighbor relationships between bacteria.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the x and y coordinate column names, e.g., <cite>{‘x’: ‘Center_X’, ‘y’: ‘Center_Y’}</cite>.</p></li>
<li><p><strong>all_rel_center_coord_cols</strong> (<em>dict</em>) – Relative center coordinate columns for mapping bacteria in segmentation data.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent bacterium’s image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent bacterium’s object number.</p></li>
<li><p><strong>label_col</strong> (<em>str</em>) – Column name for bacteria labels.</p></li>
<li><p><strong>interval_time</strong> (<em>float</em>) – Time interval (in minutes) between consecutive frames.</p></li>
<li><p><strong>doubling_time</strong> (<em>float</em>) – Expected doubling time (in minutes) for bacterial division.</p></li>
<li><p><strong>pixel_per_micron</strong> (<em>float</em>) – Conversion factor from pixels to microns (default: <cite>0.144</cite>).</p></li>
<li><p><strong>intensity_threshold</strong> (<em>float</em>) – Threshold to classify objects into specific cell types based on intensity values. (default: <cite>0.1</cite>).</p></li>
<li><p><strong>assigning_cell_type</strong> (<em>bool</em>) – If True, assigns cell types to objects based on intensity thresholds.</p></li>
<li><p><strong>disable_tracking_correction</strong> (<em>bool</em>) – Flag to disable tracking error correction (default: <cite>False</cite>).</p></li>
<li><p><strong>clf</strong> (<em>str</em>) – Classifier to use for machine learning models (default: <cite>None</cite>).</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>) – Number of CPUs to use for parallel processing (default: <cite>-1</cite>, use all available CPUs).</p></li>
<li><p><strong>image_boundaries</strong> (<em>str</em>) – Boundary limits defined for all time steps to filter out objects outside the image area.</p></li>
<li><p><strong>dynamic_boundaries</strong> (<em>str</em>) – Path to a CSV file specifying boundary limits for each time step. The file should contain columns:
<cite>Time Step</cite>, <cite>Lower X Limit</cite>, <cite>Upper X Limit</cite>, <cite>Lower Y Limit</cite>, <cite>Upper Y Limit</cite>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Directory to save output files and logs.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, displays warnings and additional details during processing.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><p>tuple:</p>
<ul class="simple">
<li><p><strong>pandas.DataFrame df</strong>: Corrected tracking data.</p></li>
<li><p><strong>list logs_list</strong>: List of progress and log messages.</p></li>
<li><p><strong>pandas.DataFrame logs_df</strong>: Detailed log of tracking corrections.</p></li>
<li><p><strong>pandas.DataFrame identified_tracking_errors_df</strong>: Identified tracking errors before correction.</p></li>
<li><p><strong>pandas.DataFrame fixed_errors</strong>: Corrected tracking errors.</p></li>
<li><p><strong>pandas.DataFrame remaining_errors_df</strong>: Remaining errors after corrections.</p></li>
<li><p><strong>pandas.DataFrame neighbors_df</strong>: Updated neighbors DataFrame.</p></li>
<li><p><strong>numpy.ndarray cell_type_array</strong>: Array of assigned cell types.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-multiRegionsDetection">
<span id="module-multiregionsdetection"></span><h2>Module: multiRegionsDetection<a class="headerlink" href="#module-multiRegionsDetection" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="multiRegionsDetection.map_and_detect_multi_regions">
<span class="sig-prename descclassname"><span class="pre">multiRegionsDetection.</span></span><span class="sig-name descname"><span class="pre">map_and_detect_multi_regions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted_seg_npy_files_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_per_micron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_rel_center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/multiRegionsDetection.html#map_and_detect_multi_regions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#multiRegionsDetection.map_and_detect_multi_regions" title="Link to this definition">¶</a></dt>
<dd><p>Map objects to segmentation files, detect multi-region areas, and prepare pixel data for tacking correction.</p>
<p>This function maps objects from the tracking dataframe (<cite>df</cite>) to their corresponding regions in segmentation
files (<cite>npy</cite> format). It detects multi-region areas where disconnected regions share the same color and flags
them for correction in a separate function. For all objects, their pixels are mapped into a sparse coordinate
matrix and color array for further analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Dataframe containing bacterial measured bacterial features.</p></li>
<li><p><strong>sorted_seg_npy_files_list</strong> (<em>list</em>) – sorted List of file paths to the segmentation files in <cite>.npy</cite> format.</p></li>
<li><p><strong>pixel_per_micron</strong> (<em>float</em>) – Conversion factor from pixels to microns for spatial measurements.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of object centers.
Example: {‘x’: ‘Center_X’, ‘y’: ‘Center_Y’}</p></li>
<li><p><strong>all_rel_center_coord_cols</strong> (<em>dict</em>) – Dictionary containing x and y coordinate column names.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the dataframe.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the dataframe.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print detailed information about the processing steps for debugging.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple containing:</p>
<ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>): Updated dataframe with mapped object data.
Objects with incorrect regions in the segmentation file are flagged as noise.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>): Sparse matrix indicating the pixel locations of objects.</p></li>
<li><p><strong>color_array</strong> (<em>np.ndarray</em>): Array of RGB color values for each object.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-multiRegionsCorrection">
<span id="module-multiregionscorrection"></span><h2>Module: multiRegionsCorrection<a class="headerlink" href="#module-multiRegionsCorrection" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="multiRegionsCorrection.modify_existing_object">
<span class="sig-prename descclassname"><span class="pre">multiRegionsCorrection.</span></span><span class="sig-name descname"><span class="pre">modify_existing_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faulty_row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/multiRegionsCorrection.html#modify_existing_object"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#multiRegionsCorrection.modify_existing_object" title="Link to this definition">¶</a></dt>
<dd><p>Modifies attributes of an existing object in the image and updates the relevant data structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing object data, including tracking and feature information.</p></li>
<li><p><strong>regions_color</strong> (<em>list</em>) – list representing the colors assigned to different regions.</p></li>
<li><p><strong>faulty_row</strong> (<em>dict</em>) – A dictionary containing details about the faulty object, including indices used for updates.</p></li>
<li><p><strong>img_array</strong> (<em>numpy.ndarray</em>) – Image array where object regions are represented by their respective colors.</p></li>
<li><p><strong>regions_coordinates</strong> (<em>list</em><em> of </em><em>numpy.ndarray</em>) – A list of arrays where element indices are region indices, and
elements are arrays of coordinates for each region.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Boolean array tracking encoded spatial coordinates for each object.</p></li>
<li><p><strong>color_array</strong> (<em>numpy.ndarray</em>) – Array storing the color of each object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple:</p>
<p>Updated DataFrame (<cite>df</cite>), image array (<cite>img_array</cite>), coordinate array (<cite>coordinate_array</cite>),
and color array (<cite>color_array</cite>).</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="multiRegionsCorrection.multi_region_correction">
<span class="sig-prename descclassname"><span class="pre">multiRegionsCorrection.</span></span><span class="sig-name descname"><span class="pre">multi_region_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_df_cp_connected_regions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_center_particles_stat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_center_particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_rel_center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_distance_prev_objects_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/multiRegionsCorrection.html#multi_region_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#multiRegionsCorrection.multi_region_correction" title="Link to this definition">¶</a></dt>
<dd><p>Corrects multi-region objects by identifying mismatched or faulty associations and updating or removing objects
as necessary. Ensures consistency between regions and objects while maintaining accurate data records.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing object data.</p></li>
<li><p><strong>img_array</strong> (<em>numpy.ndarray</em>) – Image array representing the current state of the image.</p></li>
<li><p><strong>distance_df_cp_connected_regions</strong> (<em>pandas.DataFrame</em>) – DataFrame containing pairwise distances between objects (based on CellProfiler records) and regions.</p></li>
<li><p><strong>img_number</strong> (<em>int</em>) – Current image number</p></li>
<li><p><strong>regions_center_particles_stat</strong> (<em>list</em>) – List of statistics for regions’ center points.</p></li>
<li><p><strong>regions_center_particles</strong> (<em>list</em>) – List of coordinates for regions’ center points.</p></li>
<li><p><strong>regions_color</strong> (<em>list</em>) – list of region colors in current time step.</p></li>
<li><p><strong>regions_coordinates</strong> (<em>list</em><em> of </em><em>numpy.ndarray</em>) – A list of arrays where each region index maps to an array of its coordinates.</p></li>
<li><p><strong>regions_features</strong> (<em>list</em><em> of </em><em>dict</em>) – A list of dictionaries where each region index maps to its features (e.g., orientation, axis lengths).</p></li>
<li><p><strong>all_rel_center_coord_cols</strong> (<em>dict</em>) – Dictionary containing x and y coordinate column names.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Name of the parent image number column in the DataFrame.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Name of the parent object number column in the DataFrame.</p></li>
<li><p><strong>min_distance_prev_objects_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing previous object distance information.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Boolean array tracking encoded spatial coordinates for each object.</p></li>
<li><p><strong>color_array</strong> (<em>numpy.ndarray</em>) – Array storing the colors of objects.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple: Updated DataFrame (<cite>df</cite>), coordinate array (<cite>coordinate_array</cite>), and color array (<cite>color_array</cite>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="multiRegionsCorrection.remove_object_from_image">
<span class="sig-prename descclassname"><span class="pre">multiRegionsCorrection.</span></span><span class="sig-name descname"><span class="pre">remove_object_from_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faulty_row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_coordinates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/multiRegionsCorrection.html#remove_object_from_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#multiRegionsCorrection.remove_object_from_image" title="Link to this definition">¶</a></dt>
<dd><p>Removes an object from the image by removing its region in the image array and marking it as noise in the DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing object data, including tracking and feature information.</p></li>
<li><p><strong>faulty_row</strong> (<em>dict</em>) – A dictionary containing details about the faulty object, including indices used for updates.</p></li>
<li><p><strong>img_array</strong> (<em>numpy.ndarray</em>) – Image array where object regions are represented by their respective colors.</p></li>
<li><p><strong>regions_coordinates</strong> (<em>list</em><em> of </em><em>numpy.ndarray</em>) – A list of arrays where element indices are region indices, and
elements are arrays of coordinates for each region.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple: Updated DataFrame (<cite>df</cite>) and image array (<cite>img_array</cite>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="multiRegionsCorrection.update_object_records">
<span class="sig-prename descclassname"><span class="pre">multiRegionsCorrection.</span></span><span class="sig-name descname"><span class="pre">update_object_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faulty_row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/multiRegionsCorrection.html#update_object_records"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#multiRegionsCorrection.update_object_records" title="Link to this definition">¶</a></dt>
<dd><p>Updates the records and attributes of a multi-region object after determining the best-fitting region.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing object data, including tracking and feature information.</p></li>
<li><p><strong>faulty_row</strong> (<em>dict</em>) – A dictionary containing details about the faulty object, including indices used for updates.</p></li>
<li><p><strong>img_array</strong> (<em>numpy.ndarray</em>) – Image array where object regions are represented by their respective colors.</p></li>
<li><p><strong>regions_coordinates</strong> (<em>list</em><em> of </em><em>numpy.ndarray</em>) – A list of Arrays where element indices are region indices, and
elements are arrays of coordinates for each region.</p></li>
<li><p><strong>regions_color</strong> (<em>list</em>) – list representing the colors assigned to different regions.</p></li>
<li><p><strong>regions_features</strong> (<em>list</em><em> of </em><em>dict</em>) – A list of dictionaries where keys are region indices, and values contain feature data for each region
(e.g., orientation, major/minor axis lengths).</p></li>
<li><p><strong>all_center_coord_cols</strong> (<em>dict</em>) – A dictionary mapping coordinate types (<cite>x</cite>, <cite>y</cite>) to their respective column names in the DataFrame.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name in the DataFrame representing the parent image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name in the DataFrame representing the parent object number.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Boolean array tracking encoded spatial coordinates for each object.</p></li>
<li><p><strong>color_array</strong> (<em>numpy.ndarray</em>) – Array storing the color of each object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple: Updated DataFrame (<cite>df</cite>), image array (<cite>img_array</cite>), coordinate array (<cite>coordinate_array</cite>),
and color array (<cite>color_array</cite>).</p>
<p>Updates include:</p>
<ul class="simple">
<li><p><strong>Center Coordinates</strong>: Updates the x and y center positions (<cite>center_x</cite>, <cite>center_y</cite>) in the DataFrame.</p></li>
<li><p><strong>Shape Attributes</strong>: Updates the major axis length (<cite>AreaShape_MajorAxisLength</cite>),
minor axis length (<cite>AreaShape_MinorAxisLength</cite>), and orientation (<cite>AreaShape_Orientation</cite>) in radians.</p></li>
<li><p><strong>Parent Information</strong>: Resets the parent image number and parent object number to <cite>0</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-regionOfInterestFilter">
<span id="module-regionofinterestfilter"></span><h2>Module: regionOfInterestFilter<a class="headerlink" href="#module-regionOfInterestFilter" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="regionOfInterestFilter.filter_objects_outside_boundary">
<span class="sig-prename descclassname"><span class="pre">regionOfInterestFilter.</span></span><span class="sig-name descname"><span class="pre">filter_objects_outside_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_per_micron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regionOfInterestFilter.html#filter_objects_outside_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regionOfInterestFilter.filter_objects_outside_boundary" title="Link to this definition">¶</a></dt>
<dd><p>Identifies and marks objects outside a user-defined boundary in the image, applying the same boundary
limits across all time steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_min</strong> (<em>float</em>) – The minimum x-coordinate (in micrometers) for the boundary.</p></li>
<li><p><strong>x_max</strong> (<em>float</em>) – The maximum x-coordinate (in micrometers) for the boundary.</p></li>
<li><p><strong>y_min</strong> (<em>float</em>) – The minimum y-coordinate (in micrometers) for the boundary.</p></li>
<li><p><strong>y_max</strong> (<em>float</em>) – The maximum y-coordinate (in micrometers) for the boundary.</p></li>
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The DataFrame containing tracking data and measured bacterial features for objects.
This DataFrame is updated in place.</p></li>
<li><p><strong>pixel_per_micron</strong> (<em>float</em>) – The conversion factor from pixels to micrometers.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of object centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: The updated DataFrame with objects outside the boundary marked as noise (<cite>noise_bac=True</cite>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="regionOfInterestFilter.filter_objects_outside_dynamic_boundary">
<span class="sig-prename descclassname"><span class="pre">regionOfInterestFilter.</span></span><span class="sig-name descname"><span class="pre">filter_objects_outside_dynamic_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamic_boundaries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_per_micron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regionOfInterestFilter.html#filter_objects_outside_dynamic_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regionOfInterestFilter.filter_objects_outside_dynamic_boundary" title="Link to this definition">¶</a></dt>
<dd><p>Identifies and marks objects outside user-defined, time-dependent boundaries in the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamic_boundaries</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing time-dependent boundary limits for each time step. It includes columns specifying
lower and upper limits for x and y coordinates (<cite>Lower X Limit</cite>, <cite>Upper X Limit</cite>, <cite>Lower Y Limit</cite>,
<cite>Upper Y Limit</cite>) and the corresponding time step (<cite>Time Step</cite>).</p></li>
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing tracking data and measured bacterial features for all objects.
This DataFrame is updated in place.</p></li>
<li><p><strong>pixel_per_micron</strong> (<em>float</em>) – The conversion factor from micrometers to pixels.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of object centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: The updated DataFrame with objects outside the boundaries marked as noise (<cite>noise_bac=True</cite>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="regionOfInterestFilter.find_inside_boundary_objects">
<span class="sig-prename descclassname"><span class="pre">regionOfInterestFilter.</span></span><span class="sig-name descname"><span class="pre">find_inside_boundary_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boundary_limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_boundaries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_per_micron</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regionOfInterestFilter.html#find_inside_boundary_objects"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regionOfInterestFilter.find_inside_boundary_objects" title="Link to this definition">¶</a></dt>
<dd><p>Identifies and retains objects within specified boundary limits, either static or time-dependent,
by filtering out objects outside these boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>boundary_limits</strong> (<em>str</em>) – A comma-separated string defining static boundary limits in micrometers as <cite>x_min, x_max, y_min, y_max</cite>.
If provided, these limits are applied consistently across all time steps.</p></li>
<li><p><strong>dynamic_boundaries</strong> (<em>str</em>) – Path to a CSV file containing time-dependent boundary limits. The CSV must include columns specifying
<cite>Lower X Limit</cite>, <cite>Upper X Limit</cite>, <cite>Lower Y Limit</cite>, <cite>Upper Y Limit</cite>, and <cite>Time Step</cite>. This parameter is
used if <cite>boundary_limits</cite> is <cite>None</cite>.</p></li>
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing tracking data and measured bacterial features for all objects.
This DataFrame is updated in place.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of object centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>pixel_per_micron</strong> (<em>float</em>) – The conversion factor from micrometers to pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: The updated DataFrame with objects outside the boundaries marked as noise (<cite>noise_bac=True</cite>)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-noiseObjects">
<span id="module-noiseobjects"></span><h2>Module: noiseObjects<a class="headerlink" href="#module-noiseObjects" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="noiseObjects.detect_and_remove_noise_bacteria">
<span class="sig-prename descclassname"><span class="pre">noiseObjects.</span></span><span class="sig-name descname"><span class="pre">detect_and_remove_noise_bacteria</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noiseObjects.html#detect_and_remove_noise_bacteria"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#noiseObjects.detect_and_remove_noise_bacteria" title="Link to this definition">¶</a></dt>
<dd><p>Detect and remove noise bacteria from tracking data.</p>
<p>This function identifies noise objects (bacteria) based on major length and removes
them from the dataframe. It iteratively detects noise objects, removes them, and updates
neighbor relationships.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Dataframe containing bacterial tracking data, including features such as object major length</p></li>
<li><p><strong>neighbors_df</strong> (<em>pd.DataFrame</em>) – Dataframe containing information about neighboring bacteria relationships.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the dataframe.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the dataframe.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple:</p>
<ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>): Updated dataframe with noise bacteria removed.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pd.DataFrame</em>): Updated neighbor relationships after removing noise bacteria.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="noiseObjects.update_tracking_after_removing_noise">
<span class="sig-prename descclassname"><span class="pre">noiseObjects.</span></span><span class="sig-name descname"><span class="pre">update_tracking_after_removing_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_objects_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noiseObjects.html#update_tracking_after_removing_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#noiseObjects.update_tracking_after_removing_noise" title="Link to this definition">¶</a></dt>
<dd><p>Update tracking and neighbor relationships after removing noise bacteria.</p>
<p>This function updates the tracking data and neighbor relationships when noise bacteria
are identified and flagged. It:
- Removes relationships where noise bacteria are parents.
- Cleans up incorrect neighbor relationships involving noise bacteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Dataframe containing bacterial tracking data, including IDs, features, and noise flags.</p></li>
<li><p><strong>noise_objects_df</strong> (<em>pd.DataFrame</em>) – Subset of the dataframe containing the detected noise bacteria to be removed.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pd.DataFrame</em>) – Dataframe containing neighbor relationship information for bacteria.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the dataframe.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the dataframe.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple:</p>
<ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>): Updated dataframe with noise bacteria flagged and their parent relationships reset.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pd.DataFrame</em>): Updated neighbor relationships with noise bacteria removed.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bacterialBehaviorModelTraining">
<span id="module-bacterialbehaviormodeltraining"></span><h2>Module: bacterialBehaviorModelTraining<a class="headerlink" href="#module-bacterialBehaviorModelTraining" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bacterialBehaviorModelTraining.train_bacterial_behavior_models">
<span class="sig-prename descclassname"><span class="pre">bacterialBehaviorModelTraining.</span></span><span class="sig-name descname"><span class="pre">train_bacterial_behavior_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacterialBehaviorModelTraining.html#train_bacterial_behavior_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bacterialBehaviorModelTraining.train_bacterial_behavior_models" title="Link to this definition">¶</a></dt>
<dd><p>Trains machine learning models to predict bacterial behaviors, including division, non-division,
and distinguishing between divided and non-divided bacteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing bacterial tracking data with spatial, temporal, and neighbor information.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing bacterial neighbor relationships for all time steps.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>csr_matrix</em>) – Sparse matrix representing neighbor relationships for efficient lookup.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of bacterial centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name representing the image number of parent bacteria.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name representing the object number of parent bacteria.</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – Directory to save the trained models and performance logs.</p></li>
<li><p><strong>clf</strong> (<em>str</em>) – Classifier type (e.g., <cite>‘LogisticRegression’</cite>, <cite>‘GaussianProcessClassifier’</cite>, <cite>‘SVC’</cite>).</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>) – Number of CPUs to use for parallel processing during model training.</p></li>
<li><p><strong>coordinate_array</strong> (<em>np.ndarray</em>) – Array of spatial coordinates for evaluating bacterial connections.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt>tuple: Three trained machine learning models:</dt><dd><ul class="simple">
<li><p><strong>divided_vs_non_divided_model</strong>: Model to distinguish between dividing and non-dividing bacteria.</p></li>
<li><p><strong>non_divided_model</strong>: Model to predict the behavior of non-dividing bacteria.</p></li>
<li><p><strong>divided_bac_model</strong>: Model to analyze the characteristics of dividing bacteria.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mlModelDivisionVsNonDivision">
<span id="module-mlmodeldivisionvsnondivision"></span><h2>Module: mlModelDivisionVsNonDivision<a class="headerlink" href="#module-mlModelDivisionVsNonDivision" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mlModelDivisionVsNonDivision.train_division_vs_non_division_model">
<span class="sig-prename descclassname"><span class="pre">mlModelDivisionVsNonDivision.</span></span><span class="sig-name descname"><span class="pre">train_division_vs_non_division_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connected_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlModelDivisionVsNonDivision.html#train_division_vs_non_division_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlModelDivisionVsNonDivision.train_division_vs_non_division_model" title="Link to this definition">¶</a></dt>
<dd><p>Constructs a machine learning model to compare divided and non-divided bacteria.
The model uses features such as movement, spatial relationships, neighbor changes,
and bacterial morphology to classify each instance.</p>
<dl class="simple">
<dt><strong>Workflow</strong>:</dt><dd><ul class="simple">
<li><p>Splits the dataset into “divided” and “non-divided” bacteria based on duplication in parent relationships.</p></li>
<li><p>Extracts and calculates features for each group, including:
- Intersection over Union (IoU).
- Spatial distances.
- Neighbor differences and ratios.
- Direction of motion and motion alignment angles.
- Length change ratios.</p></li>
<li><p>Labels the “divided” group as negative and the “non-divided” group as positive.</p></li>
<li><p>Combines the features and trains the specified classifier.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connected_bac</strong> (<em>pandas.DataFrame</em>) – DataFrame containing connected bacteria data, including spatial, temporal, and neighbor information.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of bacterial centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name representing the image number of parent bacteria.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name representing the object number of parent bacteria.</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – Directory where model outputs (e.g., performance logs, trained models) will be saved.</p></li>
<li><p><strong>clf</strong> (<em>str</em>) – Classifier type (e.g., <cite>‘LogisticRegression’</cite>, <cite>‘GaussianProcessClassifier’</cite>, <cite>‘SVC’</cite>).</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>) – Number of CPUs to use for parallel processing during training.</p></li>
<li><p><strong>coordinate_array</strong> (<em>np.ndarray</em>) – Array of spatial coordinates for evaluating bacterial links.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt><strong>Returns</strong>:</dt><dd><p>sklearn.Model:</p>
<p>Trained machine learning model to classify divided and non-divided bacteria.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mlModelNonDividedBacteria">
<span id="module-mlmodelnondividedbacteria"></span><h2>Module: mlModelNonDividedBacteria<a class="headerlink" href="#module-mlModelNonDividedBacteria" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mlModelNonDividedBacteria.train_non_divided_bacteria_model">
<span class="sig-prename descclassname"><span class="pre">mlModelNonDividedBacteria.</span></span><span class="sig-name descname"><span class="pre">train_non_divided_bacteria_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connected_bac_high_chance_to_be_correct_with_neighbors_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlModelNonDividedBacteria.html#train_non_divided_bacteria_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlModelNonDividedBacteria.train_non_divided_bacteria_model" title="Link to this definition">¶</a></dt>
<dd><p>Constructs a machine learning model to predict whether a bacterium will continue its life history.</p>
<dl class="simple">
<dt><strong>Workflow</strong>:</dt><dd><ul class="simple">
<li><p>Extracts features for bacteria and their neighbors, including:
- Size relationships (e.g., <cite>LengthChangeRatio</cite>).
- Spatial relationships (e.g., <cite>IoU</cite>, distances, neighbor differences).
- Motion alignment.</p></li>
<li><p>Trains the specified classifier on the engineered features.</p></li>
<li><p>Outputs the trained model.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The complete dataset containing bacterial tracking information across time steps.</p></li>
<li><p><strong>connected_bac_high_chance_to_be_correct_with_neighbors_info</strong> (<em>pandas.DataFrame</em>) – Subset of bacteria with high probabilities of being correctly linked, including neighbor-related information.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing details about bacterial neighbors.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>csr_matrix</em>) – Sparse matrix representation of bacterial neighbor relationships.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of bacterial centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name representing the image number of parent bacteria.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name representing the object number of parent bacteria.</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – Directory where model outputs (e.g., performance logs, trained models) will be saved.</p></li>
<li><p><strong>clf</strong> (<em>str</em>) – Classifier type (e.g., <cite>‘LogisticRegression’</cite>, <cite>‘GaussianProcessClassifier’</cite>, <cite>‘SVC’</cite>).</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>) – Number of CPUs to use for parallel processing during training.</p></li>
<li><p><strong>coordinate_array</strong> (<em>scipy.sparse.csr_matrix</em>) – Sparse matrix of spatial coordinates for evaluating bacterial links.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt><strong>Returns</strong>:</dt><dd><p>sklearn.Model:</p>
<p>Trained machine learning model to predict non-divided bacteria.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mlModelDividedBacteria">
<span id="module-mlmodeldividedbacteria"></span><h2>Module: mlModelDividedBacteria<a class="headerlink" href="#module-mlModelDividedBacteria" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mlModelDividedBacteria.train_divided_bacteria_model">
<span class="sig-prename descclassname"><span class="pre">mlModelDividedBacteria.</span></span><span class="sig-name descname"><span class="pre">train_divided_bacteria_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connected_bac_high_chance_to_be_correct_with_neighbors_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlModelDividedBacteria.html#train_divided_bacteria_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlModelDividedBacteria.train_divided_bacteria_model" title="Link to this definition">¶</a></dt>
<dd><p>Constructs a machine learning model to predict whether a bacterium will divide and be born daughters.</p>
<dl class="simple">
<dt><strong>Workflow</strong>:</dt><dd><ul class="simple">
<li><p>Extracts features for bacteria pairs with division signals (<cite>mother-daughter</cite> relationships).</p></li>
<li><p>Filters outliers based on size and neighbor characteristics.</p></li>
<li><p>Computes key features such as:
- Intersection over Union (IoU).
- Spatial distances.
- Neighbor changes (difference and common neighbors).
- Angle between mother and daughter bacteria.</p></li>
<li><p>Assigns positive labels for actual divisions and negative labels for unrelated bacteria pairs
(link between daughter and source’s neighbor).</p></li>
<li><p>Trains the specified machine learning classifier using the derived features.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The complete dataset containing bacterial tracking information across time steps.</p></li>
<li><p><strong>connected_bac_high_chance_to_be_correct_with_neighbors_info</strong> (<em>pandas.DataFrame</em>) – Subset of bacteria with high probabilities of being correctly linked, including neighbor-related information.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>csr_matrix</em>) – Sparse matrix representation of bacterial neighbor relationships.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of bacterial centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name representing the image number of parent bacteria.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name representing the object number of parent bacteria.</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – Directory where model outputs (e.g., performance logs, trained models) will be saved.</p></li>
<li><p><strong>clf</strong> (<em>str</em>) – Classifier type (e.g., <cite>‘LogisticRegression’</cite>, <cite>‘GaussianProcessClassifier’</cite>, <cite>‘SVC’</cite>).</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>) – Number of CPUs to use for parallel processing during training.</p></li>
<li><p><strong>coordinate_array</strong> (<em>scipy.sparse.csr_matrix</em>) – sparse matrix of spatial coordinates for evaluating bacterial links.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt><strong>Returns</strong>:</dt><dd><p>sklearn.Model:</p>
<p>Trained machine learning model to classify divided bacteria relationships.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-machineLearningPipeline">
<span id="module-machinelearningpipeline"></span><h2>Module: machineLearningPipeline<a class="headerlink" href="#module-machineLearningPipeline" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="machineLearningPipeline.log_model_performance">
<span class="sig-prename descclassname"><span class="pre">machineLearningPipeline.</span></span><span class="sig-name descname"><span class="pre">log_model_performance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_class_prob_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specificity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_importance_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_positive</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_negative</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/machineLearningPipeline.html#log_model_performance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#machineLearningPipeline.log_model_performance" title="Link to this definition">¶</a></dt>
<dd><p>Logs the performance metrics of a machine learning model and saves the results to files,
including a probability distribution plot and a text log file.
This function is designed to provide detailed insights into the model’s performance and feature importance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_directory</strong> (<em>str</em>) – The directory where output files, including performance logs and plots, will be saved.
A subdirectory named ML/ is created if it does not already exist.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Descriptive name of model (divided_vs_non_divided, non_divided, divided)</p></li>
<li><p><strong>pos_class_prob_values</strong> (<em>np.ndarray</em>) – Predicted probabilities for the positive class from the trained model.</p></li>
<li><p><strong>accuracy</strong> (<em>float</em>) – Overall accuracy of the model, calculated as (TP + TN) / (TP + TN + FP + FN).</p></li>
<li><p><strong>specificity</strong> (<em>float</em>) – Model specificity, calculated as TN / (TN + FP).</p></li>
<li><p><strong>sensitivity</strong> (<em>float</em>) – Model sensitivity (recall), calculated as TP / (TP + FN).</p></li>
<li><p><strong>feature_importance_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing feature names and their respective weights or importances.
Empty if the model does not support feature importance extraction.</p></li>
<li><p><strong>tp</strong> (<em>int</em>) – Count of true positive predictions.</p></li>
<li><p><strong>tn</strong> (<em>int</em>) – Count of true negative predictions.</p></li>
<li><p><strong>fp</strong> (<em>int</em>) – Count of false positive predictions.</p></li>
<li><p><strong>fn</strong> (<em>int</em>) – Count of false negative predictions.</p></li>
<li><p><strong>clf</strong> (<em>str</em>) – Name of the classifier used for the analysis.</p></li>
<li><p><strong>n_positive</strong> (<em>int</em>) – Total number of positive samples (links exist in dataframe) in the dataset.</p></li>
<li><p><strong>n_negative</strong> (<em>int</em>) – Total number of negative samples (synthetic links between targets and neighbors of sources) in the dataset.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="machineLearningPipeline.train_model">
<span class="sig-prename descclassname"><span class="pre">machineLearningPipeline.</span></span><span class="sig-name descname"><span class="pre">train_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">merged_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns_to_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/machineLearningPipeline.html#train_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#machineLearningPipeline.train_model" title="Link to this definition">¶</a></dt>
<dd><p>Trains a machine learning model using the specified classifier and evaluates its performance.
The function applies preprocessing, trains the model, and calculates various performance metrics such as
accuracy, specificity, and sensitivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>merged_df</strong> (<em>pandas.DataFrame</em>) – The input DataFrame containing the features and target labels for training the model.
The target labels are expected to be in a column named <cite>label</cite>.</p></li>
<li><p><strong>feature_list</strong> (<em>list</em>) – A list of column names in merged_df representing the features used for training.</p></li>
<li><p><strong>columns_to_scale</strong> (<em>list</em>) – A list of feature columns in merged_df that should be scaled using StandardScaler.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Descriptive name of model (divided_vs_non_divided, non_divided, divided)</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – The directory where output files, including performance logs and plots, will be saved.</p></li>
<li><p><strong>clf</strong> (<em>str</em>) – <dl class="simple">
<dt>The name of the classifier to use. Supported classifiers include:</dt><dd><ul>
<li><p>’LogisticRegression’</p></li>
<li><p>’GaussianProcessClassifier’</p></li>
<li><p>’C-Support Vector Classifier’</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>) – Number of CPU cores to use for parallel processing in the classifier.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns:</dt><dd><p>sklearn.pipeline.Pipeline</p>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A trained machine learning pipeline containing the preprocessing steps and the classifier.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-findOutlier">
<span id="module-findoutlier"></span><h2>Module: findOutlier<a class="headerlink" href="#module-findOutlier" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="findOutlier.calculate_bacterial_length_boundary">
<span class="sig-prename descclassname"><span class="pre">findOutlier.</span></span><span class="sig-name descname"><span class="pre">calculate_bacterial_length_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findOutlier.html#calculate_bacterial_length_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findOutlier.calculate_bacterial_length_boundary" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the statistical boundary (average and standard deviation) for bacterial length values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the column “AreaShape_MajorAxisLength”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict: A dictionary with ‘avg’ (average) and ‘std’ (standard deviation) for bacterial lengths.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findOutlier.calculate_length_change_ratio_boundary">
<span class="sig-prename descclassname"><span class="pre">findOutlier.</span></span><span class="sig-name descname"><span class="pre">calculate_length_change_ratio_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findOutlier.html#calculate_length_change_ratio_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findOutlier.calculate_length_change_ratio_boundary" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the statistical boundary for bacterial length change ratios below 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the column “LengthChangeRatio”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict: A dictionary with ‘avg’ (average) and ‘std’ (standard deviation) for the ratios below 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findOutlier.calculate_lower_statistical_bound">
<span class="sig-prename descclassname"><span class="pre">findOutlier.</span></span><span class="sig-name descname"><span class="pre">calculate_lower_statistical_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_boundary_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findOutlier.html#calculate_lower_statistical_bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findOutlier.calculate_lower_statistical_bound" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the lower statistical boundary using the formula: avg - 1.96 * std.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>feature_boundary_dict</strong> (<em>dict</em>) – Dictionary containing ‘avg’ (average) and ‘std’ (standard deviation).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float: The lower statistical boundary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findOutlier.calculate_max_daughter_to_mother_boundary">
<span class="sig-prename descclassname"><span class="pre">findOutlier.</span></span><span class="sig-name descname"><span class="pre">calculate_max_daughter_to_mother_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findOutlier.html#calculate_max_daughter_to_mother_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findOutlier.calculate_max_daughter_to_mother_boundary" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the statistical boundary (average and standard deviation) for the maximum
daughter-to-mother length ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the column “max_daughter_len_to_mother”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict: A dictionary with ‘avg’ (average) and ‘std’ (standard deviation) for the ratio.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findOutlier.calculate_sum_daughter_to_mother_len_boundary">
<span class="sig-prename descclassname"><span class="pre">findOutlier.</span></span><span class="sig-name descname"><span class="pre">calculate_sum_daughter_to_mother_len_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findOutlier.html#calculate_sum_daughter_to_mother_len_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findOutlier.calculate_sum_daughter_to_mother_len_boundary" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the statistical boundary (average and standard deviation) for the
sum_daughter-to-mother length ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the column “daughter_length_to_mother”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict: A dictionary with ‘avg’ (average) and ‘std’ (standard deviation) for the ratio.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findOutlier.calculate_upper_statistical_bound">
<span class="sig-prename descclassname"><span class="pre">findOutlier.</span></span><span class="sig-name descname"><span class="pre">calculate_upper_statistical_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_boundary_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findOutlier.html#calculate_upper_statistical_bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findOutlier.calculate_upper_statistical_bound" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the upper statistical boundary using the formula: avg + 1.96 * std.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>feature_boundary_dict</strong> (<em>dict</em>) – Dictionary containing ‘avg’ (average) and ‘std’ (standard deviation).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float: The upper statistical boundary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findOutlier.detect_daughter_to_mother_length_outliers">
<span class="sig-prename descclassname"><span class="pre">findOutlier.</span></span><span class="sig-name descname"><span class="pre">detect_daughter_to_mother_length_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findOutlier.html#detect_daughter_to_mother_length_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findOutlier.detect_daughter_to_mother_length_outliers" title="Link to this definition">¶</a></dt>
<dd><p>Detects outliers in the daughter-to-mother length ratios.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing “daughter_length_to_mother” and “max_daughter_len_to_mother” columns.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: A subset of the input DataFrame containing rows that exceed
the calculated upper bounds for daughter-to-mother ratios or have ratios &gt; 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findOutlier.detect_length_change_ratio_outliers">
<span class="sig-prename descclassname"><span class="pre">findOutlier.</span></span><span class="sig-name descname"><span class="pre">detect_length_change_ratio_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findOutlier.html#detect_length_change_ratio_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findOutlier.detect_length_change_ratio_outliers" title="Link to this definition">¶</a></dt>
<dd><p>Detects bacterial length change ratio outliers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the column “LengthChangeRatio” for analysis.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float: The maximum outlier value for bacterial length change ratios, or NaN if none exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findOutlier.find_bacterial_length_outliers">
<span class="sig-prename descclassname"><span class="pre">findOutlier.</span></span><span class="sig-name descname"><span class="pre">find_bacterial_length_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findOutlier.html#find_bacterial_length_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#findOutlier.find_bacterial_length_outliers" title="Link to this definition">¶</a></dt>
<dd><p>Identifies bacterial length outliers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<em>numpy.ndarray</em>) – Array of bacterial length values to analyze.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float: The maximum outlier value below the calculated lower bound, if any exist.
Otherwise, returns NaN.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-overAssignedDaughters">
<span id="module-overassigneddaughters"></span><h2>Module: overAssignedDaughters<a class="headerlink" href="#module-overAssignedDaughters" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="overAssignedDaughters.resolve_over_assigned_daughters_link">
<span class="sig-prename descclassname"><span class="pre">overAssignedDaughters.</span></span><span class="sig-name descname"><span class="pre">resolve_over_assigned_daughters_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_bac_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/overAssignedDaughters.html#resolve_over_assigned_daughters_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#overAssignedDaughters.resolve_over_assigned_daughters_link" title="Link to this definition">¶</a></dt>
<dd><p>This function identifies parent bacteria with over-assigned daughter links (OAD), evaluates
the validity of these links using a machine learning model, and resolves the issue by:
- Removing invalid daughter links.
- Updating features for parent bacteria with corrected daughters.
- Propagating corrected features to the daughter bacteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing tracking data for bacteria, including division-related features.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image numbers.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object numbers.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>divided_bac_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to evaluate the probability of valid division links.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Array of spatial coordinates used for evaluating spatial relationships.</p></li>
</ul>
</dd>
</dl>
<p><strong>Returns</strong>:
:returns pandas.DataFrame: Updated DataFrame with corrected division links and propagated features.</p>
</dd></dl>

</section>
<section id="module-redundantParentLink">
<span id="module-redundantparentlink"></span><h2>Module: redundantParentLink<a class="headerlink" href="#module-redundantParentLink" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="redundantParentLink.detect_and_resolve_redundant_parent_link">
<span class="sig-prename descclassname"><span class="pre">redundantParentLink.</span></span><span class="sig-name descname"><span class="pre">detect_and_resolve_redundant_parent_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/redundantParentLink.html#detect_and_resolve_redundant_parent_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redundantParentLink.detect_and_resolve_redundant_parent_link" title="Link to this definition">¶</a></dt>
<dd><p>Detects and resolves redundant parent links (RPL) in bacterial lineage tracking by evaluating mother-daughter
relationships based on geometric, motion, and neighbor-based features.
This function performs iterative checks to detect RPLs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing tracking data for bacteria.</p></li>
<li><p><strong>neighbor_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing neighbor relationships between bacteria.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Matrix representing neighbor connections between bacteria.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name in <cite>df</cite> for the parent bacterium’s image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name in <cite>df</cite> for the parent bacterium’s object number.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>non_divided_model</strong> (<em>sklearn.Model</em>) – <dl class="simple">
<dt>Machine learning model used to evaluate which target bacterium the source bacterium should link to in order to</dt><dd><p>continue its life history.</p>
</dd>
</dl>
</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Matrix of spatial coordinates used for geometric and spatial calculations.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt><strong>Returns</strong>:</dt><dd><p>pandas.DataFrame:</p>
<p>Updated DataFrame with resolved RPLs and recalculated features.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-missingConnectivityLink">
<span id="module-missingconnectivitylink"></span><h2>Module: missingConnectivityLink<a class="headerlink" href="#module-missingConnectivityLink" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="missingConnectivityLink.detect_and_resolve_missing_connectivity_link">
<span class="sig-prename descclassname"><span class="pre">missingConnectivityLink.</span></span><span class="sig-name descname"><span class="pre">detect_and_resolve_missing_connectivity_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doubling_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_vs_non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_bac_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/missingConnectivityLink.html#detect_and_resolve_missing_connectivity_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#missingConnectivityLink.detect_and_resolve_missing_connectivity_link" title="Link to this definition">¶</a></dt>
<dd><p>Detect and resolve missing connectivity links in bacterial tracking data.</p>
<p>This function identifies missing connectivity links in bacterial tracking, finds candidate
sources for linking with target bacteria, and evaluates candidates based on statistical
conditions, biological plausibility, and machine learning models. If valid candidates are
found, the function modifies the tracking data to establish new links.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Dataframe containing bacterial tracking data, including IDs, life histories, and coordinates.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pd.DataFrame</em>) – Dataframe containing information about neighboring bacteria.</p></li>
<li><p><strong>neighbor_matrix</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighbor relationships.</p></li>
<li><p><strong>doubling_time</strong> (<em>float</em>) – Estimated doubling time for bacteria, used to set thresholds for division and growth.</p></li>
<li><p><strong>interval_time</strong> (<em>float</em>) – Time interval between frames in the tracking data.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the dataframe.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the dataframe.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of bacterial centers.
Example: {‘x’: ‘Center_X’, ‘y’: ‘Center_Y’}</p></li>
<li><p><strong>divided_vs_non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to compare divided and non-divided states for bacteria.</p></li>
<li><p><strong>non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to evaluate candidate links for non-divided bacteria.</p></li>
<li><p><strong>divided_bac_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to validate division links.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Array of spatial coordinates used for evaluating candidate links (calculation of IOU).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pd.DataFrame:</p>
<p>Updated dataframe with resolved connectivity links and adjusted bacterial life histories.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="missingConnectivityLink.resolve_missing_connectivity_links">
<span class="sig-prename descclassname"><span class="pre">missingConnectivityLink.</span></span><span class="sig-name descname"><span class="pre">resolve_missing_connectivity_links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_probability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_target_bac_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_frame_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/missingConnectivityLink.html#resolve_missing_connectivity_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#missingConnectivityLink.resolve_missing_connectivity_links" title="Link to this definition">¶</a></dt>
<dd><p>Resolve missing connectivity links by removing incorrect links and establishing new ones.</p>
<p>This function adjusts bacterial tracking data to resolve missing connectivity by
removing redundant or incorrect links and creating new ones. Based on the
<cite>link_probability</cite> and the <cite>link_type</cite>, it establishes or removes connections
for division links (<cite>‘division’</cite>) or continuity links (<cite>‘continuity’</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Dataframe containing bacterial tracking data, including IDs, relationships, and coordinates.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pd.DataFrame</em>) – Dataframe containing neighbor relationship information for bacteria.</p></li>
<li><p><strong>neighbor_matrix</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighbor relationships.</p></li>
<li><p><strong>source_bac_idx</strong> (<em>int</em>) – Index of the source bacteria whose tracking link is being resolved.</p></li>
<li><p><strong>source_bac</strong> (<em>pd.Series</em>) – Data for the source bacteria whose link needs to be adjusted.</p></li>
<li><p><strong>link_probability</strong> (<em>float</em>) – Probability value from a machine learning model. The value <cite>1 - link_probability</cite> represents
the likelihood that the proposed new link is valid.</p></li>
<li><p><strong>new_target_bac_idx</strong> (<em>int</em>) – Index of the target bacteria to establish a new link with.</p></li>
<li><p><strong>link_type</strong> (<em>str</em>) – Type of link to handle:
- <cite>‘division’</cite>: Handles division events.
- <cite>‘continuity’</cite>: Handles continuity of the same bacteria across frames.</p></li>
<li><p><strong>target_frame_bacteria</strong> (<em>pd.DataFrame</em>) – Subset of the dataframe containing bacteria in the target time frame.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the dataframe.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the dataframe.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of bacterial centers.
Example: {‘x’: ‘Center_X’, ‘y’: ‘Center_Y’}</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pd.DataFrame:</p>
<p>Updated dataframe with resolved missing connectivity link and adjusted bacterial tracking features.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-unexpectedBeginning">
<span id="module-unexpectedbeginning"></span><h2>Module: unexpectedBeginning<a class="headerlink" href="#module-unexpectedBeginning" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="unexpectedBeginning.handle_unexpected_beginning_bacteria">
<span class="sig-prename descclassname"><span class="pre">unexpectedBeginning.</span></span><span class="sig-name descname"><span class="pre">handle_unexpected_beginning_bacteria</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doubling_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_vs_non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">division_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/unexpectedBeginning.html#handle_unexpected_beginning_bacteria"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#unexpectedBeginning.handle_unexpected_beginning_bacteria" title="Link to this definition">¶</a></dt>
<dd><p>Handle unexpected beginning bacteria by finding and validating candidate sources, and creating new links.</p>
<p>This function processes bacteria flagged with <cite>unexpected_beginning</cite> by identifying candidate target bacteria
in the next frame. It validates potential links using statistical conditions, biological plausibility,
and machine learning models. If validated, it creates new links to resolve tracking gaps.</p>
<dl class="simple">
<dt>The function handles two scenarios:</dt><dd><ul class="simple">
<li><p><strong>continuity</strong>: The source bacterium’s life history continues to the next frame.</p></li>
<li><p><strong>division</strong>: The source bacterium divides, linking to two daughter bacteria.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Dataframe containing bacterial measured bacterial features.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pd.DataFrame</em>) – Dataframe containing neighbor relationship information for bacteria.</p></li>
<li><p><strong>neighbor_matrix</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighbor relationships.</p></li>
<li><p><strong>interval_time</strong> (<em>float</em>) – Time interval between frames in the tracking data.</p></li>
<li><p><strong>doubling_time</strong> (<em>float</em>) – Estimated doubling time for bacteria, used to determine plausible division events.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the dataframe.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the dataframe.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of bacterial centers.
Example: {‘x’: ‘Center_X’, ‘y’: ‘Center_Y’}</p></li>
<li><p><strong>divided_vs_non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to compare divided and non-divided states for bacteria.</p></li>
<li><p><strong>non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to evaluate candidate links for continuity events.</p></li>
<li><p><strong>division_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to validate division links.</p></li>
<li><p><strong>color_array</strong> (<em>np.ndarray</em>) – Array representing the colors of objects in the tracking data. This is used for mapping
bacteria from the dataframe to the coordinate array for spatial analysis.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Array of spatial coordinates used for evaluating candidate links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pd.DataFrame</p>
<p>Updated dataframe with resolved links for unexpected beginning bacteria.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="unexpectedBeginning.resolve_unexpected_beginning_bacteria">
<span class="sig-prename descclassname"><span class="pre">unexpectedBeginning.</span></span><span class="sig-name descname"><span class="pre">resolve_unexpected_beginning_bacteria</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_beginning_bac_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_beginning_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_probability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_begging_bac_time_step_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maintenance_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redundant_link_division_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/unexpectedBeginning.html#resolve_unexpected_beginning_bacteria"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#unexpectedBeginning.resolve_unexpected_beginning_bacteria" title="Link to this definition">¶</a></dt>
<dd><p>Resolves unexpected beginning bacteria by establishing new links to them and, if needed, modifying or removing
existing links to source bacteria, based on the specified link type and probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing bacterial life history and tracking information.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing neighboring relationships between bacteria, including their image and object numbers.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighbor connections between bacteria.</p></li>
<li><p><strong>unexpected_beginning_bac_idx</strong> (<em>int</em>) – Index of the unexpected beginning bacterium being resolved.</p></li>
<li><p><strong>unexpected_beginning_bac</strong> (<em>pandas.Series</em>) – Series containing data for the unexpected beginning bacterium.</p></li>
<li><p><strong>link_probability</strong> (<em>float</em>) – Probability associated with the proposed link between the source and unexpected beginning bacterium.
A valid link is established if <cite>1 - link_probability &gt; 0.5</cite>.</p></li>
<li><p><strong>source_bac_idx</strong> (<em>int</em>) – Index of the source bacterium being linked to the unexpected beginning bacterium.</p></li>
<li><p><strong>link_type</strong> (<em>str</em>) – <dl class="simple">
<dt>Type of link being evaluated:</dt><dd><ul>
<li><p>’division’: Division link (source bacterium divides into two daughters, including the
unexpected beginning bacterium).</p></li>
<li><p>’continuity’: Continuity link (unexpected beginning bacterium continues the life history of
the source bacterium).</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>unexpected_begging_bac_time_step_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing all bacteria present in the time step of the unexpected beginning bacterium.</p></li>
<li><p><strong>maintenance_cost</strong> (<em>pandas.DataFrame</em>) – Cost DataFrame representing the cost of maintaining existing links for source bacteria.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name in the DataFrame for parent image numbers.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name in the DataFrame for parent object numbers.</p></li>
<li><p><strong>center_coord_col</strong> (<em>dict</em>) – Dictionary containing column names for x and y center coordinates.</p></li>
<li><p><strong>redundant_link_division_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing redundant links between candidate source bacteria and their current targets.
These links are removed to allow the unexpected beginning bacterium to link to the candidate bacterium.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>Updated DataFrame with resolved links for the unexpected beginning bacterium.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-unExpectedEnd">
<span id="module-unexpectedend"></span><h2>Module: unExpectedEnd<a class="headerlink" href="#module-unExpectedEnd" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="unExpectedEnd.handle_unexpected_end_bacteria">
<span class="sig-prename descclassname"><span class="pre">unExpectedEnd.</span></span><span class="sig-name descname"><span class="pre">handle_unexpected_end_bacteria</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doubling_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_vs_non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">division_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/unExpectedEnd.html#handle_unexpected_end_bacteria"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#unExpectedEnd.handle_unexpected_end_bacteria" title="Link to this definition">¶</a></dt>
<dd><p>Handle unexpected end bacteria by finding and validating candidate targets, and creating new links.</p>
<p>This function processes bacteria flagged with <cite>unexpected_end</cite> by identifying candidate target bacteria
in the next frame. It validates potential links using statistical conditions, biological plausibility,
and machine learning models. If validated, it creates new links to resolve tracking gaps.</p>
<p>The function handles two scenarios:
- <strong>continuity</strong>: The bacterium’s life history continues to the next frame.
- <strong>division</strong>: The bacterium divides, linking to two daughter bacteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Dataframe containing bacterial measured bacterial features.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pd.DataFrame</em>) – Dataframe containing neighbor relationship information for bacteria.</p></li>
<li><p><strong>neighbor_matrix</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighbor relationships.</p></li>
<li><p><strong>interval_time</strong> (<em>float</em>) – Time interval between frames in the tracking data.</p></li>
<li><p><strong>doubling_time</strong> (<em>float</em>) – Estimated doubling time for bacteria, used to determine plausible division events.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the dataframe.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the dataframe.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of bacterial centers.
Example: {‘x’: ‘Center_X’, ‘y’: ‘Center_Y’}</p></li>
<li><p><strong>divided_vs_non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to compare divided and non-divided states for bacteria.</p></li>
<li><p><strong>non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to evaluate candidate links for continuity events.</p></li>
<li><p><strong>division_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to validate division links.</p></li>
<li><p><strong>color_array</strong> (<em>np.ndarray</em>) – Array representing the colors of objects in the tracking data. This is used for mapping
bacteria from the dataframe to the coordinate array for spatial analysis.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Array of spatial coordinates used for evaluating candidate links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pd.DataFrame</p>
<p>Updated dataframe with resolved links for unexpected end bacteria.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="unExpectedEnd.resolve_unexpected_end_bacteria">
<span class="sig-prename descclassname"><span class="pre">unExpectedEnd.</span></span><span class="sig-name descname"><span class="pre">resolve_unexpected_end_bacteria</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_end_bac_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daughter_bac_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daughter_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_frame_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_link_probability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daughter_link_probability</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/unExpectedEnd.html#resolve_unexpected_end_bacteria"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#unExpectedEnd.resolve_unexpected_end_bacteria" title="Link to this definition">¶</a></dt>
<dd><p>Resolve unexpected end bacteria by creating new tracking links.</p>
<p>This function handles unexpected end bacteria by creating new tracking
links to the next frame. It supports two types of links:
- <cite>‘continuity’</cite>: The source bacterium’s life history continues to the target bacterium in the next frame.
- <cite>‘division’</cite>: The source bacterium divides, creating links to both a target bacterium and a daughter bacterium.</p>
<p>The function uses probabilities from an ML model to validate the links and removes previous
links if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Dataframe containing bacterial tracking data, including IDs, life histories, and coordinates.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pd.DataFrame</em>) – Dataframe containing neighbor relationship information for bacteria.</p></li>
<li><p><strong>neighbor_matrix</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighbor relationships.</p></li>
<li><p><strong>link_type</strong> (<em>str</em>) – Type of link to establish:
- <cite>‘continuity’</cite>: Continuity link to the target bacterium in the next frame.
- <cite>‘division’</cite>: Division link to the target bacterium and a daughter bacterium in the next frame.</p></li>
<li><p><strong>unexpected_end_bac_idx</strong> (<em>int</em>) – Index of the unexpected end bacterium (source bacterium).</p></li>
<li><p><strong>target_bac_idx</strong> (<em>int</em>) – Index of the target bacterium in the next frame.</p></li>
<li><p><strong>target_bac</strong> (<em>pd.Series</em>) – Data for the target bacterium in the next frame.</p></li>
<li><p><strong>daughter_bac_idx</strong> (<em>int</em>) – Index of the daughter bacterium, used for division links.</p></li>
<li><p><strong>daughter_bac</strong> (<em>pd.Series</em>) – Data for the daughter bacterium, used for division links.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the dataframe.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the dataframe.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for x and y coordinates of bacterial centers.
Example: {‘x’: ‘Center_X’, ‘y’: ‘Center_Y’}</p></li>
<li><p><strong>next_frame_bacteria</strong> (<em>pd.DataFrame</em>) – Dataframe containing bacteria in the next frame relative to the source bacterium.</p></li>
<li><p><strong>target_link_probability</strong> (<em>float</em>) – Probability value from the ML model for the link to the target bacterium.
A valid link is considered if <cite>1 - target_link_probability &gt; 0.5</cite>.</p></li>
<li><p><strong>daughter_link_probability</strong> (<em>float</em>) – Probability value from the ML model for the link to the daughter bacterium (division).
A valid link is considered if <cite>1 - daughter_link_probability &gt; 0.5</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pd.DataFrame</p>
<p>Updated dataframe with new links added and previous links removed.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-restoringTrackingLinks">
<span id="module-restoringtrackinglinks"></span><h2>Module: restoringTrackingLinks<a class="headerlink" href="#module-restoringTrackingLinks" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="restoringTrackingLinks.add_tracking_link">
<span class="sig-prename descclassname"><span class="pre">restoringTrackingLinks.</span></span><span class="sig-name descname"><span class="pre">add_tracking_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_bac_in_target_bac_time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/restoringTrackingLinks.html#add_tracking_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#restoringTrackingLinks.add_tracking_link" title="Link to this definition">¶</a></dt>
<dd><p>Adds a new tracking link between a source bacterium and a target bacterium if conditions are met.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing tracking information for bacteria.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame representing the neighbor relationships between bacteria.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>scipy.sparse.csr_matrix</em>) – Sparse matrix representing neighborhood connectivity for all bacteria.</p></li>
<li><p><strong>source_bac_idx</strong> (<em>int</em>) – Index of the source bacterium in the current DataFrame.</p></li>
<li><p><strong>target_bac_idx</strong> (<em>int</em>) – Index of the target bacterium in the current DataFrame.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent bacterium’s image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent bacterium’s object number.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for the x and y centroid coordinates,
e.g., <cite>{‘x’: ‘Center_X’, ‘y’: ‘Center_Y’}</cite>.</p></li>
<li><p><strong>all_bac_in_target_bac_time_step</strong> (<em>pandas.DataFrame</em>) – Subset of the DataFrame containing all bacteria in the target bacterium’s time step.</p></li>
<li><p><strong>prob_val</strong> (<em>float</em>) – Probability value indicating the likelihood of the new link being valid. A lower probability (<cite>1 - prob_val</cite>)
must exceed a threshold (0.5) for the link to be considered.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt>pandas.DataFrame:</dt><dd><p>The updated DataFrame with the new tracking link added if the conditions are met.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="restoringTrackingLinks.restore_tracking_links">
<span class="sig-prename descclassname"><span class="pre">restoringTrackingLinks.</span></span><span class="sig-name descname"><span class="pre">restore_tracking_links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_raw_before_rpl_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_bac_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/restoringTrackingLinks.html#restore_tracking_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#restoringTrackingLinks.restore_tracking_links" title="Link to this definition">¶</a></dt>
<dd><p>Attempts to restore previously removed tracking links for bacteria by re-evaluating conditions and costs.
This function focuses on resolving links for unexpected beginning bacteria while maintaining tracking integrity.</p>
<dl class="simple">
<dt><strong>Process</strong>:</dt><dd><ul class="simple">
<li><p>Identifies bacteria with <cite>unexpected_beginning</cite> status.</p></li>
<li><p>Cross-checks these bacteria against the raw tracking data to find potential links that were removed.</p></li>
<li><dl class="simple">
<dt>Evaluates potential links based on:</dt><dd><ul>
<li><p>Continuity (single-link bacteria).</p></li>
<li><p>Division (bacteria dividing into daughters).</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Applies machine learning models to calculate costs for restoring links and uses
an optimization algorithm (Hungarian method) to finalize the link restoration.</p></li>
<li><p>Updates the DataFrame with restored links if conditions are satisfied.</p></li>
</ul>
</dd>
<dt><strong>Key Features</strong>:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><strong>Continuity Links</strong>:</dt><dd><ul>
<li><p>Checks whether the bacterium in question can continue its life history based on its source link.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Division Links</strong>:</dt><dd><ul>
<li><p>Ensures division links meet criteria, such as the daughter-to-mother length ratio being below a threshold.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Optimization</strong>:</dt><dd><ul>
<li><p>Uses a cost matrix and optimization algorithm to assign links with minimal cost.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The current DataFrame containing bacteria tracking data.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame representing the neighbor relationships between bacteria.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighborhood connectivity for all bacteria.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent bacterium’s image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent bacterium’s object number.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary containing the column names for x and y centroid coordinates,
e.g., <cite>{‘x’: ‘Center_X’, ‘y’: ‘Center_Y’}</cite>.</p></li>
<li><p><strong>df_raw_before_rpl_errors</strong> (<em>pandas.DataFrame</em>) – Original tracking data before resolving RPL errors, used to verify previously existing links.</p></li>
<li><p><strong>non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model to evaluate the validity of non-divided bacteria continuity links.</p></li>
<li><p><strong>divided_bac_model</strong> (<em>sklearn.Model</em>) – Machine learning model to evaluate division-based links for bacteria.</p></li>
<li><p><strong>coordinate_array</strong> (<em>numpy.ndarray</em>) – Array containing precomputed spatial coordinates for bacteria.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt>pandas.DataFrame:</dt><dd><p>The updated DataFrame with restored tracking links where applicable.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-candidateBacteriaFeatureSpace">
<span id="module-candidatebacteriafeaturespace"></span><h2>Module: candidateBacteriaFeatureSpace<a class="headerlink" href="#module-candidateBacteriaFeatureSpace" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="candidateBacteriaFeatureSpace.find_candidates_for_unexpected_beginning">
<span class="sig-prename descclassname"><span class="pre">candidateBacteriaFeatureSpace.</span></span><span class="sig-name descname"><span class="pre">find_candidates_for_unexpected_beginning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_begging_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_beginning_bac_time_step_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_time_step_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/candidateBacteriaFeatureSpace.html#find_candidates_for_unexpected_beginning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candidateBacteriaFeatureSpace.find_candidates_for_unexpected_beginning" title="Link to this definition">¶</a></dt>
<dd><p>Finds candidate bacteria from the previous time step to link with unexpected beginning bacteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing neighboring relationships between bacteria, including their image and object numbers.</p></li>
<li><p><strong>unexpected_begging_bac</strong> (<em>pandas.DataFrame</em>) – DataFrame containing information about unexpected beginning bacteria.</p></li>
<li><p><strong>unexpected_beginning_bac_time_step_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing all bacteria in the time step of the unexpected beginning bacteria.</p></li>
<li><p><strong>previous_time_step_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing all bacteria from the previous time step.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary mapping x and y center coordinates to their respective column names.</p></li>
<li><p><strong>color_array</strong> (<em>numpy.ndarray</em>) – Array storing color-coded information for bacterial objects.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Sparse boolean array representing encoded spatial coordinates of bacteria.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p><strong>final_candidate_bacteria_info</strong> (<em>pandas.DataFrame</em>): Subset of bacteria from the previous time step
that can potentially link to unexpected beginning bacteria and are selected for further analysis.</p></li>
<li><p><strong>final_candidate_bacteria</strong> (<em>pandas.DataFrame</em>): DataFrame containing detailed information about
candidate bacteria and their neighbors, combined with unexpected beginning bacteria data.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candidateBacteriaFeatureSpace.find_candidates_for_unexpected_end">
<span class="sig-prename descclassname"><span class="pre">candidateBacteriaFeatureSpace.</span></span><span class="sig-name descname"><span class="pre">find_candidates_for_unexpected_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_end_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_end_bac_time_step_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_time_step_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/candidateBacteriaFeatureSpace.html#find_candidates_for_unexpected_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candidateBacteriaFeatureSpace.find_candidates_for_unexpected_end" title="Link to this definition">¶</a></dt>
<dd><p>Finds candidate bacteria from the next time step to link with unexpected end bacteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing neighboring relationships between bacteria, including their image and object numbers.</p></li>
<li><p><strong>unexpected_end_bac</strong> (<em>pandas.DataFrame</em>) – DataFrame containing information about unexpected end bacteria.</p></li>
<li><p><strong>unexpected_end_bac_time_step_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing all bacteria in the time step of the unexpected end bacteria.</p></li>
<li><p><strong>next_time_step_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing all bacteria from the next time step.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary mapping x and y center coordinates to their respective column names.</p></li>
<li><p><strong>color_array</strong> (<em>numpy.ndarray</em>) – Array storing color-coded information for bacterial objects.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Sparse boolean array representing encoded spatial coordinates of bacteria.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p><strong>final_candidate_bacteria_info</strong> (<em>pandas.DataFrame</em>): Subset of bacteria from the previous time step
that can potentially link to unexpected end bacteria and are selected for further analysis.</p></li>
<li><p><strong>final_candidate_bacteria</strong> (<em>pandas.DataFrame</em>): DataFrame containing detailed information about
candidate bacteria and their neighbors, combined with unexpected end bacteria data.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calculateInitialCostTerms">
<span id="module-calculateinitialcostterms"></span><h2>Module: calculateInitialCostTerms<a class="headerlink" href="#module-calculateInitialCostTerms" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calculateInitialCostTerms.calc_distance_and_overlap_matrices">
<span class="sig-prename descclassname"><span class="pre">calculateInitialCostTerms.</span></span><span class="sig-name descname"><span class="pre">calc_distance_and_overlap_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_time_step_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_source_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bacteria_in_target_time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_target_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daughter_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maintain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateInitialCostTerms.html#calc_distance_and_overlap_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateInitialCostTerms.calc_distance_and_overlap_matrices" title="Link to this definition">¶</a></dt>
<dd><p>Constructs initial distance and overlap matrices for tracking bacteria across consecutive time steps.</p>
<dl class="simple">
<dt><strong>Distance Calculation</strong>:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>When <cite>maintain=True</cite>:</dt><dd><ul>
<li><dl class="simple">
<dt>Calculates distances to maintain both division and continuity links:</dt><dd><ul>
<li><p>Division links: Evaluates spatial relationships between parent and daughter bacteria.</p></li>
<li><p>Continuity links: Tracks life history continuity of the same bacterium across time steps.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>When <cite>maintain=False</cite>:</dt><dd><ul>
<li><dl class="simple">
<dt>Computes overlaps and distances between bacteria in the source and target time steps:</dt><dd><ul>
<li><p>Centroid distances (<cite>center_distance</cite>).</p></li>
<li><dl class="simple">
<dt>Endpoint distances:</dt><dd><ul>
<li><p>Between first endpoints (<cite>endpoint1_1_distance</cite>).</p></li>
<li><p>Between second endpoints (<cite>endpoint2_2_distance</cite>).</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Additional distances for daughter tracking:</dt><dd><ul>
<li><p>Between mismatched endpoints (<cite>endpoint1_2_distance</cite> and <cite>endpoint2_1_distance</cite>).</p></li>
<li><p>Between centroids and endpoints (<cite>center_endpoint1_distance</cite> and <cite>center_endpoint2_distance</cite>).</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>Determines the minimum distance for each source-target pair and pivots the results into a distance matrix.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_time_step_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing tracking data for bacteria in the source time step.</p></li>
<li><p><strong>sel_source_bacteria</strong> (<em>pandas.DataFrame</em>) – Subset of source bacteria selected for analysis.</p></li>
<li><p><strong>bacteria_in_target_time_step</strong> (<em>pandas.DataFrame</em>) – DataFrame containing tracking data for bacteria in the target objects time step.</p></li>
<li><p><strong>sel_target_bacteria</strong> (<em>pandas.DataFrame</em>) – Subset of target bacteria selected for analysis.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>color_array</strong> (<em>np.ndarray</em>) – Array representing the colors of objects in the tracking data. This is used for mapping
bacteria from the dataframe to the coordinate array for spatial analysis.</p></li>
<li><p><strong>daughter_flag</strong> (<em>bool</em>) – Whether to include additional distances related to parent-daughter relationships.</p></li>
<li><p><strong>maintain</strong> (<em>bool</em>) – If <cite>True</cite>, computes distance terms for maintaining division and continuity links.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Array of spatial coordinates used for evaluating candidate links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple: (overlap_df, distance_df)</dt><dd><ul class="simple">
<li><p><cite>overlap_df</cite>: Overlap matrix indicating the existence of relationships between bacteria.</p></li>
<li><p><cite>distance_df</cite>: Distance matrix with minimum distances for source-target pairs.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateInitialCostTerms.calc_distance_term_for_maintain_continuity_links">
<span class="sig-prename descclassname"><span class="pre">calculateInitialCostTerms.</span></span><span class="sig-name descname"><span class="pre">calc_distance_term_for_maintain_continuity_links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">continuity_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateInitialCostTerms.html#calc_distance_term_for_maintain_continuity_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateInitialCostTerms.calc_distance_term_for_maintain_continuity_links" title="Link to this definition">¶</a></dt>
<dd><p>Calculates a distance matrix to maintain continuity links.</p>
<dl class="simple">
<dt><strong>Distance Calculation</strong>:</dt><dd><dl class="simple">
<dt>For each source-target pair, the following distances are calculated:</dt><dd><ul class="simple">
<li><p>The Euclidean distance between the centroids of the source object and the target object.</p></li>
<li><p>The Euclidean distance between the first endpoints of the source and target objects
(located on the same side).</p></li>
<li><p>The Euclidean distance between the second endpoints of the source and target objects
(located on the opposite side).</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p>For each source-target pair, the smallest of these three distances is selected as the min_distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>continuity_df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing information about objects in consecutive time steps. The DataFrame must
include centroid and endpoint coordinates for calculating distances between source and target objects.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of object centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>pandas.DataFrame: A pivoted distance matrix where:</dt><dd><ul class="simple">
<li><p>Rows correspond to source objects (<cite>index_1</cite>).</p></li>
<li><p>Columns correspond to target objects (<cite>index_2</cite>).</p></li>
<li><p>Values represent the minimum distance between a source and target.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateInitialCostTerms.calc_distance_term_for_maintain_division">
<span class="sig-prename descclassname"><span class="pre">calculateInitialCostTerms.</span></span><span class="sig-name descname"><span class="pre">calc_distance_term_for_maintain_division</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">division_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateInitialCostTerms.html#calc_distance_term_for_maintain_division"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateInitialCostTerms.calc_distance_term_for_maintain_division" title="Link to this definition">¶</a></dt>
<dd><p>Calculates a distance matrix to maintain relationship between parent and daughter objects in a division event.</p>
<dl class="simple">
<dt><strong>Distance Calculation</strong>:</dt><dd><dl class="simple">
<dt>For each parent-daughter pair, the following distances are calculated:</dt><dd><ul class="simple">
<li><p>The Euclidean distance between the centroids of the parent and daughter objects (<cite>center_distance</cite>).</p></li>
<li><p>The Euclidean distance between the first endpoints of the parent and daughter objects
(<cite>endpoint1_1_distance</cite>).</p></li>
<li><p>The Euclidean distance between the second endpoints of the parent and daughter objects
(<cite>endpoint2_2_distance</cite>).</p></li>
<li><p>The Euclidean distance between the first endpoint of the parent and the second endpoint of the daughter
(<cite>endpoint12_distance</cite>).</p></li>
<li><p>The Euclidean distance between the second endpoint of the parent and the first endpoint of the daughter
(<cite>endpoint21_distance</cite>).</p></li>
<li><p>The Euclidean distance between the centroid of the parent and the first endpoint of the daughter
(<cite>center_endpoint1_distance</cite>).</p></li>
<li><p>The Euclidean distance between the centroid of the parent and the second endpoint of the daughter
(<cite>center_endpoint2_distance</cite>).</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p>For each parent-daughter pair, the smallest of these distances is selected as the <cite>min_distance</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>division_df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing information about parent-daughter relationships in division events. The DataFrame
must include centroid and endpoint coordinates for both parent and daughter objects.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of object centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>pandas.DataFrame: A pivoted distance matrix where:</dt><dd><ul class="simple">
<li><p>Rows correspond to parent objects (<cite>index_parent</cite>).</p></li>
<li><p>Columns correspond to daughter objects (<cite>index_daughter</cite>).</p></li>
<li><p>Values represent the minimum distance between a parent and daughter.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calculateCreateLinkCost">
<span id="module-calculatecreatelinkcost"></span><h2>Module: calculateCreateLinkCost<a class="headerlink" href="#module-calculateCreateLinkCost" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calculateCreateLinkCost.calc_continuity_link_cost">
<span class="sig-prename descclassname"><span class="pre">calculateCreateLinkCost.</span></span><span class="sig-name descname"><span class="pre">calc_continuity_link_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_with_can_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_divided_bac_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_vs_non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maintain_exist_link_cost_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_maintenance_for</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateCreateLinkCost.html#calc_continuity_link_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateCreateLinkCost.calc_continuity_link_cost" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the cost of establishing continuity link between a source bacterium and its potential target bacterium.
This function evaluates continuity links by analyzing spatial, geometric, and neighborhood-based features.
It determines the likelihood that a bacterium in one time step corresponds to the same bacterium in the next
time step.</p>
<p><strong>Behavior</strong>:
- Calculates features like intersection-over-union (IoU), centroid distance, length ratios, and neighbor overlap.
- Predicts continuity probabilities using a pre-trained model (<cite>non_divided_bac_model</cite>).
- Compares continuity and division probabilities using a comparison model (<cite>divided_vs_non_divided_model</cite>).
- Adjusts costs based on whether maintaining existing links is preferable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Full DataFrame containing bacterial features for the current time step.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame describing relationships between neighboring bacteria.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighbor relationships.</p></li>
<li><p><strong>source_bac_with_can_target</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the source bacteria and their candidate targets in the next time step.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>col_source</strong> (<em>str</em>) – Suffix for source bacterium columns.</p></li>
<li><p><strong>col_target</strong> (<em>str</em>) – Suffix for target bacterium columns.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number.</p></li>
<li><p><strong>non_divided_bac_model</strong> (<em>sklearn.Model</em>) – Machine learning model to predict continuity probabilities.</p></li>
<li><p><strong>divided_vs_non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to compare divided and non-divided states for bacteria.</p></li>
<li><p><strong>maintain_exist_link_cost_df</strong> (<em>pandas.DataFrame</em>) – Cost of maintaining current links between bacteria.</p></li>
<li><p><strong>check_maintenance_for</strong> (<em>str</em>) – Specifies whether maintenance costs are evaluated for the <cite>target</cite> or <cite>source</cite>. Default is <cite>‘target’</cite>.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – spatial coordinate matrix for neighborhood and overlap calculations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>A cost matrix for potential continuity links, with rows as source bacteria and columns as their
candidate targets.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateCreateLinkCost.calc_continuity_link_cost_for_restoring_links">
<span class="sig-prename descclassname"><span class="pre">calculateCreateLinkCost.</span></span><span class="sig-name descname"><span class="pre">calc_continuity_link_cost_for_restoring_links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_with_can_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_divided_bac_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateCreateLinkCost.html#calc_continuity_link_cost_for_restoring_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateCreateLinkCost.calc_continuity_link_cost_for_restoring_links" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the cost of restoring continuity link between a source bacterium and its potential UB target bacterium.
This function evaluates continuity links by analyzing spatial, geometric, and neighborhood-based features.
It determines the likelihood that a bacterium in one time step corresponds to the same bacterium in the next
time step.</p>
<p><strong>Behavior</strong>:
- Calculates features like intersection-over-union (IoU), centroid distance, length ratios, and neighbor overlap.
- Predicts continuity probabilities using a pre-trained model (<cite>non_divided_bac_model</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Full DataFrame containing bacterial features for the current time step.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame describing relationships between neighboring bacteria.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighbor relationships.</p></li>
<li><p><strong>source_bac_with_can_target</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the source bacteria and their candidate UB target in the next time step.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>col_source</strong> (<em>str</em>) – Suffix for source bacterium columns.</p></li>
<li><p><strong>col_target</strong> (<em>str</em>) – Suffix for target bacterium columns.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number.</p></li>
<li><p><strong>non_divided_bac_model</strong> (<em>sklearn.Model</em>) – Machine learning model to predict continuity probabilities.`.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – spatial coordinate matrix for neighborhood and overlap calculations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>A cost matrix for potential continuity links, with rows as source bacteria and columns as their
candidate targets (UB bacteria).</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateCreateLinkCost.calc_division_link_cost">
<span class="sig-prename descclassname"><span class="pre">calculateCreateLinkCost.</span></span><span class="sig-name descname"><span class="pre">calc_division_link_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_source_daughter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_bac_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_vs_non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maintain_exist_link_cost_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_maintenance_for</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateCreateLinkCost.html#calc_division_link_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateCreateLinkCost.calc_division_link_cost" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the cost of establishing division links between a source bacterium and its potential daughter bacteria.
This function evaluates potential division links by calculating various spatial, geometric, and
neighborhood-based features. It uses machine learning models to assess the likelihood of a division event
based on these features.</p>
<p><strong>Behavior</strong>:
- Calculates features like intersection-over-union (IoU), centroid distance, length ratios, and neighbor overlap.
- Predicts division probabilities using a pre-trained model (<cite>divided_bac_model</cite>).
- Compares division and continuity probabilities using a comparison model (<cite>divided_vs_non_divided_model</cite>).
- Adjusts costs based on whether maintaining existing links is preferable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Full DataFrame containing bacterial features for the current time step.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame describing relationships between neighboring bacteria.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighbor relationships.</p></li>
<li><p><strong>df_source_daughter</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the source bacteria and their candidate daughters.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>col_source</strong> (<em>str</em>) – Suffix for source bacterium columns.</p></li>
<li><p><strong>col_target</strong> (<em>str</em>) – Suffix for target bacterium (daughter) columns.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number.</p></li>
<li><p><strong>divided_bac_model</strong> (<em>sklearn.Model</em>) – Machine learning model to predict division probabilities.</p></li>
<li><p><strong>divided_vs_non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to compare divided and non-divided states for bacteria.</p></li>
<li><p><strong>maintain_exist_link_cost_df</strong> (<em>pandas.DataFrame</em>) – Cost of maintaining current links between bacteria.</p></li>
<li><p><strong>check_maintenance_for</strong> (<em>str</em>) – Specifies whether maintenance costs are evaluated for the <cite>target</cite> or <cite>source</cite>. Default is <cite>‘target’</cite>.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – spatial coordinate matrix for neighborhood and overlap calculations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>A cost matrix for potential division links, with rows as source bacteria and columns as their
candidate daughters.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateCreateLinkCost.calc_division_link_cost_for_restoring_links">
<span class="sig-prename descclassname"><span class="pre">calculateCreateLinkCost.</span></span><span class="sig-name descname"><span class="pre">calc_division_link_cost_for_restoring_links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_source_daughter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_bac_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateCreateLinkCost.html#calc_division_link_cost_for_restoring_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateCreateLinkCost.calc_division_link_cost_for_restoring_links" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the cost of restoring division links between a source bacterium and its potential daughter
bacteria (UB bacteria). This function evaluates potential division links by calculating various spatial,
geometric, and neighborhood-based features.
It uses machine learning model to assess the likelihood of a division event based on these features.</p>
<p><strong>Behavior</strong>:
- Calculates features like intersection-over-union (IoU), centroid distance, length ratios, and neighbor overlap.
- Predicts division probabilities using a pre-trained model (<cite>divided_bac_model</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Full DataFrame containing bacterial features for the current time step.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame describing relationships between neighboring bacteria.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighbor relationships.</p></li>
<li><p><strong>df_source_daughter</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the source bacteria and their candidate daughters.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>col_source</strong> (<em>str</em>) – Suffix for source bacterium columns.</p></li>
<li><p><strong>col_target</strong> (<em>str</em>) – Suffix for target bacterium (daughter) columns.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number.</p></li>
<li><p><strong>divided_bac_model</strong> (<em>sklearn.Model</em>) – Machine learning model to predict division probabilities.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – spatial coordinate matrix for neighborhood and overlap calculations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>A cost matrix for potential division links, with rows as source bacteria and columns as their
candidate daughters.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateCreateLinkCost.optimize_assignment_using_hungarian">
<span class="sig-prename descclassname"><span class="pre">calculateCreateLinkCost.</span></span><span class="sig-name descname"><span class="pre">optimize_assignment_using_hungarian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cost_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateCreateLinkCost.html#optimize_assignment_using_hungarian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateCreateLinkCost.optimize_assignment_using_hungarian" title="Link to this definition">¶</a></dt>
<dd><p>Optimizes the assignment of rows to columns in a cost matrix using the Hungarian algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cost_df</strong> (<em>pandas.DataFrame</em>) – A cost matrix represented as a DataFrame</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame</p>
<p>A DataFrame containing the optimized assignments and their associated costs:</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calculateMaintainingLinkCost">
<span id="module-calculatemaintaininglinkcost"></span><h2>Module: calculateMaintainingLinkCost<a class="headerlink" href="#module-calculateMaintainingLinkCost" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calculateMaintainingLinkCost.calc_maintain_exist_link_cost">
<span class="sig-prename descclassname"><span class="pre">calculateMaintainingLinkCost.</span></span><span class="sig-name descname"><span class="pre">calc_maintain_exist_link_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sel_source_bacteria_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_target_bacteria_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_vs_non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateMaintainingLinkCost.html#calc_maintain_exist_link_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateMaintainingLinkCost.calc_maintain_exist_link_cost" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the cost of maintaining existing links between bacteria in consecutive time steps.
This function calculates features such as IOU, distance, neighbor relationships,
and motion alignment for each source-target pair. These features are used as inputs to a predictive
model to calculate the cost of maintaining each link.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sel_source_bacteria_info</strong> (<em>pandas.DataFrame</em>) – Subset of bacteria in the source time step selected for analysis.</p></li>
<li><p><strong>sel_target_bacteria_info</strong> (<em>pandas.DataFrame</em>) – Subset of bacteria in the target time step selected for analysis.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>divided_vs_non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to evaluate the probability of division vs. continuity links.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Array of spatial coordinates used for evaluating spatial relationships between bacteria.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>A cost matrix for maintaining existing links between bacteria.
Rows correspond to source bacteria, columns correspond to target bacteria, and
values represent the cost of maintaining each link.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calculateCreateLinkCostMCC">
<span id="module-calculatecreatelinkcostmcc"></span><h2>Module: calculateCreateLinkCostMCC<a class="headerlink" href="#module-calculateCreateLinkCostMCC" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calculateCreateLinkCostMCC.create_continuity_link_cost">
<span class="sig-prename descclassname"><span class="pre">calculateCreateLinkCostMCC.</span></span><span class="sig-name descname"><span class="pre">create_continuity_link_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcc_target_neighbors_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_divided_bac_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_vs_non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maintain_exist_link_cost_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateCreateLinkCostMCC.html#create_continuity_link_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateCreateLinkCostMCC.create_continuity_link_cost" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the cost of creating a new continuity link between a source bacterium with a missing connectivity
(MCC link) and candidate target bacteria, and replacing the MCC link with this new link.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Main DataFrame containing tracking data for bacteria.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing neighboring relationships between bacteria.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighboring relationships for fast lookups.</p></li>
<li><p><strong>mcc_target_neighbors_features</strong> (<em>pandas.DataFrame</em>) – DataFrame containing bacterial measured bacterial features of MCC target neighbors (candidate bacteria)</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name representing parent image numbers.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name representing parent object numbers.</p></li>
<li><p><strong>non_divided_bac_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to evaluate candidate links for non-divided bacteria.</p></li>
<li><p><strong>divided_vs_non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to compare divided and non-divided states for bacteria.</p></li>
<li><p><strong>maintain_exist_link_cost_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing maintenance costs for existing links.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Array of spatial coordinates used for evaluating candidate links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>DataFrame containing the cost of replacing MCC links with new continuity links.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateCreateLinkCostMCC.division_detection_cost">
<span class="sig-prename descclassname"><span class="pre">calculateCreateLinkCostMCC.</span></span><span class="sig-name descname"><span class="pre">division_detection_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidate_source_daughter_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_life_history_of_bacteria_time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_bac_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_vs_non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maintain_exist_link_cost_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateCreateLinkCostMCC.html#division_detection_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateCreateLinkCostMCC.division_detection_cost" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates the cost of maintaining a missing connectivity link (MCC link) while adding a division link
between the source bacterium and candidate daughter bacteria.</p>
<dl class="simple">
<dt><strong>Workflow</strong>:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Checks if the source bacterium can support a valid division event by:</dt><dd><ul>
<li><p>Ensuring biological feasibility based on length ratios.</p></li>
<li><p>Evaluating statistical boundaries for daughter-to-mother length relationships.</p></li>
<li><p>Considering the age and unexpected beginning status of the source bacterium.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Identifies candidate target bacteria that meet division conditions.</p></li>
<li><p>Calculates the cost of adding division links using the <cite>calc_division_link_cost</cite> function.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Main DataFrame containing tracking data for bacteria.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing neighboring relationships between bacteria.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix representing neighboring relationships for fast lookups.</p></li>
<li><p><strong>candidate_source_daughter_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing features of source bacteria and their potential daughter bacteria.</p></li>
<li><p><strong>min_life_history_of_bacteria_time_step</strong> (<em>int</em>) – Minimum life history time steps required for a bacterium to be considered valid.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name representing parent image numbers.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name representing parent object numbers.</p></li>
<li><p><strong>divided_bac_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to validate division links.</p></li>
<li><p><strong>divided_vs_non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to compare divided and non-divided states for bacteria.</p></li>
<li><p><strong>maintain_exist_link_cost_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing maintenance costs for existing links.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Array of spatial coordinates used for evaluating candidate links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>DataFrame containing the cost of maintaining MCC links while adding division links.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calculateCreateLinkCostUB">
<span id="module-calculatecreatelinkcostub"></span><h2>Module: calculateCreateLinkCostUB<a class="headerlink" href="#module-calculateCreateLinkCostUB" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calculateCreateLinkCostUB.compute_create_link_to_unexpected_beginning_cost">
<span class="sig-prename descclassname"><span class="pre">calculateCreateLinkCostUB.</span></span><span class="sig-name descname"><span class="pre">compute_create_link_to_unexpected_beginning_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_begging_bac_time_step_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_begging_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_time_step_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_life_history_time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_vs_non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">division_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateCreateLinkCostUB.html#compute_create_link_to_unexpected_beginning_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateCreateLinkCostUB.compute_create_link_to_unexpected_beginning_cost" title="Link to this definition">¶</a></dt>
<dd><p>Computes the cost of linking unexpected beginning bacteria to bacteria from a previous time step,
evaluating continuity link cost, division costs, and  maintenance the current links of candidate bacteria costs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing bacterial measured bacterial features.</p></li>
<li><p><strong>unexpected_begging_bac_time_step_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing all bacteria present in the time step of unexpected beginnings.</p></li>
<li><p><strong>unexpected_begging_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing unexpected beginning bacteria.</p></li>
<li><p><strong>previous_time_step_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing all bacteria from the previous time step.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing neighboring relationships between bacteria, including their image and object numbers.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Array storing neighbor connections for bacteria.</p></li>
<li><p><strong>min_life_history_time_step</strong> (<em>int</em>) – Minimum number of life history frames required for a bacterium to be considered</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name in the DataFrame for parent image numbers.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name in the DataFrame for parent object numbers.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary containing column names for x and y center coordinates.</p></li>
<li><p><strong>divided_vs_non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to compare divided and non-divided states for bacteria</p></li>
<li><p><strong>non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to evaluate candidate links for continuity events.</p></li>
<li><p><strong>division_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to validate division links.</p></li>
<li><p><strong>color_array</strong> (<em>np.ndarray</em>) – Array representing the colors of objects in the tracking data. This is used for mapping
bacteria from the dataframe to the coordinate array for spatial analysis.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Array of spatial coordinates used for evaluating candidate links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p><strong>continuity_link_cost_df</strong> (<em>pandas.DataFrame</em>): Cost DataFrame for creating links to
continue the life histories of bacteria across time steps.</p></li>
<li><p><strong>division_cost_df</strong> (<em>pandas.DataFrame</em>): Cost DataFrame for creating division links.</p></li>
<li><p><strong>redundant_link_division_df</strong> (<em>pandas.DataFrame</em>): DataFrame containing redundant links between
candidate bacteria and one of their current daughter bacteria.
These links are flagged for removal to allow unexpected beginning bacteria to establish new link with
the candidate bacteria.</p></li>
<li><p><strong>maintain_exist_link_cost_df</strong> (<em>pandas.DataFrame</em>): Cost DataFrame for maintaining the current links of
candidate bacteria</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-evaluateDivisionLinkForUB">
<span id="module-evaluatedivisionlinkforub"></span><h2>Module: evaluateDivisionLinkForUB<a class="headerlink" href="#module-evaluateDivisionLinkForUB" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="evaluateDivisionLinkForUB.evaluate_division_link_feasibility">
<span class="sig-prename descclassname"><span class="pre">evaluateDivisionLinkForUB.</span></span><span class="sig-name descname"><span class="pre">evaluate_division_link_feasibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_source_daughter_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">division_cost_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_ndx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac_ndx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_next_time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_daughter_len_to_mother_ratio_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_daughter_len_to_mother_ratio_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_life_history_of_bacteria</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluateDivisionLinkForUB.html#evaluate_division_link_feasibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#evaluateDivisionLinkForUB.evaluate_division_link_feasibility" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates the feasibility of replacing a continuity link with a division link between a source bacterium
and a target bacterium by checking specific biological and statistical conditions. Updates the division
cost dictionary with the evaluated cost.</p>
<dl class="simple">
<dt><strong>Logic</strong>:</dt><dd><ul class="simple">
<li><p>Computes the length ratios between the source bacterium and its potential daughters to validate
whether a division event is biologically plausible.</p></li>
<li><p>Compares these ratios against statistically derived boundaries to ensure the division adheres to
expected patterns.</p></li>
<li><p>Evaluates the age of the source bacterium.</p></li>
<li><p>If all conditions pass, retrieves the precomputed division cost from the input DataFrame.</p></li>
<li><p>If any condition fails, assigns a high cost (<cite>1</cite>), indicating that the link is highly improbable.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_source_daughter_cost</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the precomputed division costs between source and daughter bacteria.</p></li>
<li><p><strong>division_cost_dict</strong> (<em>dict</em>) – Dictionary storing division costs for source-target bacterium pairs.</p></li>
<li><p><strong>source_bac_ndx</strong> (<em>int</em>) – Index of the source bacterium in the DataFrame.</p></li>
<li><p><strong>source_bac</strong> (<em>pandas.Series</em>) – Attributes of the source bacterium.</p></li>
<li><p><strong>target_bac_ndx</strong> (<em>int</em>) – Index of the target bacterium in the DataFrame.</p></li>
<li><p><strong>target_bac</strong> (<em>pandas.Series</em>) – Attributes of the target bacterium.</p></li>
<li><p><strong>source_bac_next_time_step</strong> (<em>pandas.DataFrame</em>) – Attributes of the source bacterium in the next time step.</p></li>
<li><p><strong>sum_daughter_len_to_mother_ratio_boundary</strong> (<em>dict</em>) – Dictionary containing ‘avg’ (average) and ‘std’ (standard deviation) for
the sum of daughter-to-mother length ratios.</p></li>
<li><p><strong>max_daughter_len_to_mother_ratio_boundary</strong> (<em>dict</em>) – Dictionary containing ‘avg’ (average) and ‘std’ (standard deviation) for
the maximum daughter-to-mother length ratio.</p></li>
<li><p><strong>min_life_history_of_bacteria</strong> (<em>int</em>) – Minimum required life history frames for a valid bacterium.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>dict:</p>
<p>Updated <cite>division_cost_dict</cite> with the evaluated division cost for the source-target pair.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="evaluateDivisionLinkForUB.evaluate_new_division_link">
<span class="sig-prename descclassname"><span class="pre">evaluateDivisionLinkForUB.</span></span><span class="sig-name descname"><span class="pre">evaluate_new_division_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maintenance_cost_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">existing_daughters_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac_ndx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_ndx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_daughter_prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redundant_link_dict_division</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluateDivisionLinkForUB.html#evaluate_new_division_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#evaluateDivisionLinkForUB.evaluate_new_division_link" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates whether an existing daughter link should be replaced with a new link to minimize the overall cost.</p>
<dl class="simple">
<dt><strong>Logic</strong>:</dt><dd><ul class="simple">
<li><p>Compares the probabilities associated with maintaining the existing daughter links and the new link.</p></li>
<li><p>Identifies the “worst” existing daughter (the one with the minimum probability).</p></li>
<li><p>If the “worst” daughter is not the target bacterium, updates the cost to add the new link and marks
the redundant link in the <cite>redundant_link_dict_division</cite>.</p></li>
<li><p>If the target bacterium is already the “worst” link, assigns a high cost (<cite>1</cite>) to indicate an
improbable replacement.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maintenance_cost_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the maintenance costs for existing daughter links.</p></li>
<li><p><strong>existing_daughters_idx</strong> (<em>list</em>) – Indices of the existing daughters.</p></li>
<li><p><strong>target_bac_ndx</strong> (<em>int</em>) – Index of the target bacterium (the new daughter candidate).</p></li>
<li><p><strong>source_bac_ndx</strong> (<em>int</em>) – Index of the source bacterium.</p></li>
<li><p><strong>new_daughter_prob</strong> (<em>float</em>) – Probability of establishing a new daughter link with the target bacterium.</p></li>
<li><p><strong>redundant_link_dict_division</strong> (<em>dict</em>) – Dictionary storing redundant links for division events.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p>float: Cost of adding the new daughter link.</p></li>
<li><p>dict: Updated <cite>redundant_link_dict_division</cite> with the identified redundant link.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="evaluateDivisionLinkForUB.evaluate_replacement_daughter_link">
<span class="sig-prename descclassname"><span class="pre">evaluateDivisionLinkForUB.</span></span><span class="sig-name descname"><span class="pre">evaluate_replacement_daughter_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maintenance_cost_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_ndx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac_ndx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_daughter_cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_daughters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_daughter_len_to_mother_ratio_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_daughter_len_to_mother_ratio_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redundant_link_dict_division</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluateDivisionLinkForUB.html#evaluate_replacement_daughter_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#evaluateDivisionLinkForUB.evaluate_replacement_daughter_link" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates whether an existing division link can be replaced with a new link to minimize the overall cost,
while ensuring the replacement adheres to biological constraints.</p>
<dl class="simple">
<dt><strong>Logic</strong>:</dt><dd><ul class="simple">
<li><p>Computes the new length ratios for the potential division link, incorporating the source bacterium,
its existing daughters, and the target bacterium.</p></li>
<li><p>Compares the new ratios against statistical boundaries (<cite>max_daughter_len_to_mother_ratio_boundary</cite> and
<cite>sum_daughter_len_to_mother_ratio_boundary</cite>) to ensure the new division link is biologically plausible.</p></li>
<li><p>If only one daughter satisfies the constraints, compares the probability of the target bacterium
against the least probable existing daughter link. If the new link is more probable, it replaces the
least probable link.</p></li>
<li><p>If multiple daughters satisfy the constraints, delegates the decision to
<cite>evaluate_replacement_daughter_link</cite> to identify the best replacement.</p></li>
<li><p>If no daughters meet the constraints, assigns a high cost (<cite>1</cite>), indicating the link is improbable.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maintenance_cost_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the maintenance costs for existing daughter links.</p></li>
<li><p><strong>source_bac_ndx</strong> (<em>int</em>) – Index of the source bacterium in the DataFrame.</p></li>
<li><p><strong>source_bac</strong> (<em>pandas.Series</em>) – Attributes of the source bacterium.</p></li>
<li><p><strong>target_bac_ndx</strong> (<em>int</em>) – Index of the target bacterium in the DataFrame.</p></li>
<li><p><strong>target_bac</strong> (<em>pandas.Series</em>) – Attributes of the target bacterium.</p></li>
<li><p><strong>new_daughter_cost</strong> (<em>float</em>) – Cost of establishing a new daughter link with the target bacterium.</p></li>
<li><p><strong>source_bac_daughters</strong> (<em>pandas.DataFrame</em>) – DataFrame containing attributes of the source bacterium’s existing daughters.</p></li>
<li><p><strong>max_daughter_len_to_mother_ratio_boundary</strong> (<em>dict</em>) – Dictionary containing ‘avg’ (average) and ‘std’ (standard deviation) for
the maximum daughter-to-mother length ratio.</p></li>
<li><p><strong>sum_daughter_len_to_mother_ratio_boundary</strong> (<em>dict</em>) – Dictionary containing ‘avg’ (average) and ‘std’ (standard deviation) for
the sum of daughter-to-mother length ratios.</p></li>
<li><p><strong>redundant_link_dict_division</strong> (<em>dict</em>) – Dictionary storing redundant links for division events.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p>float: Cost of adding the new daughter link.</p></li>
<li><p>dict: Updated <cite>redundant_link_dict_division</cite> with the identified redundant link.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="evaluateDivisionLinkForUB.handle_two_daughter_links">
<span class="sig-prename descclassname"><span class="pre">evaluateDivisionLinkForUB.</span></span><span class="sig-name descname"><span class="pre">handle_two_daughter_links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">division_cost_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maintenance_cost_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">division_cost_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_ndx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac_ndx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redundant_link_dict_division</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_daughters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_daughter_len_to_mother_ratio_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_daughter_len_to_mother_ratio_boundary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluateDivisionLinkForUB.html#handle_two_daughter_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#evaluateDivisionLinkForUB.handle_two_daughter_links" title="Link to this definition">¶</a></dt>
<dd><p>Handles scenarios where a source bacterium already has two daughter links and evaluates the feasibility of
replacing one of the existing links with a new division link to minimize the overall cost.</p>
<dl class="simple">
<dt><strong>Logic</strong>:</dt><dd><ul class="simple">
<li><p>Retrieves the cost of adding a new daughter link from the <cite>division_cost_df</cite>.</p></li>
<li><p>Delegates the evaluation of replacing an existing link to
<cite>evaluate_replacement_daughter_link</cite>, which ensures biological constraints are satisfied and
identifies the most redundant link if applicable.</p></li>
<li><p>Updates the <cite>division_cost_dict</cite> with the resulting cost for the new link.</p></li>
<li><p>Updates the <cite>redundant_link_dict_division</cite> to mark any redundant links that were replaced.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>division_cost_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing precomputed division costs for source-target links.</p></li>
<li><p><strong>maintenance_cost_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing maintenance costs for existing daughter links.</p></li>
<li><p><strong>division_cost_dict</strong> (<em>dict</em>) – Dictionary storing division costs for source-target bacterium pairs.</p></li>
<li><p><strong>source_bac_ndx</strong> (<em>int</em>) – Index of the source bacterium in the DataFrame.</p></li>
<li><p><strong>source_bac</strong> (<em>pandas.Series</em>) – Attributes of the source bacterium.</p></li>
<li><p><strong>target_bac_ndx</strong> (<em>int</em>) – Index of the target bacterium in the DataFrame.</p></li>
<li><p><strong>target_bac</strong> (<em>pandas.Series</em>) – Attributes of the target bacterium.</p></li>
<li><p><strong>redundant_link_dict_division</strong> (<em>dict</em>) – Dictionary storing redundant links for division events.</p></li>
<li><p><strong>source_bac_daughters</strong> (<em>pandas.DataFrame</em>) – DataFrame containing attributes of the source bacterium’s existing daughters.</p></li>
<li><p><strong>max_daughter_len_to_mother_ratio_boundary</strong> (<em>dict</em>) – Dictionary containing ‘avg’ (average) and ‘std’ (standard deviation) for
the maximum daughter-to-mother length ratio.</p></li>
<li><p><strong>sum_daughter_len_to_mother_ratio_boundary</strong> (<em>dict</em>) – Dictionary containing ‘avg’ (average) and ‘std’ (standard deviation) for
the sum of daughter-to-mother length ratios.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p>dict: Updated <cite>division_cost_dict</cite> with the cost for the new link.</p></li>
<li><p>dict: Updated <cite>redundant_link_dict_division</cite> with any redundant links replaced.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="evaluateDivisionLinkForUB.update_division_cost_and_redundant_links">
<span class="sig-prename descclassname"><span class="pre">evaluateDivisionLinkForUB.</span></span><span class="sig-name descname"><span class="pre">update_division_cost_and_redundant_links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">division_cost_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maintenance_cost_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">division_cost_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_ndx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac_ndx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redundant_link_dict_division</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_daughter_len_to_mother_ratio_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_daughter_len_to_mother_ratio_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_life_history_of_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_next_time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac_daughters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluateDivisionLinkForUB.html#update_division_cost_and_redundant_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#evaluateDivisionLinkForUB.update_division_cost_and_redundant_links" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Evaluates two scenarios for link feasibility:</dt><dd><ol class="arabic simple">
<li><p><strong>Single Link Scenario</strong>: The source bacterium has one existing link. The function evaluates
the feasibility of adding a new link from the target bacterium to the source bacterium.</p></li>
<li><dl class="simple">
<dt><strong>Double Link Scenario</strong>: The source bacterium has two existing links (daughter links).</dt><dd><p>The function evaluates the feasibility of removing one of the existing links and
replacing it with a new link from the target bacterium.</p>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>division_cost_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing costs for potential division links.</p></li>
<li><p><strong>maintenance_cost_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing costs for maintaining current links of candidate source bacteria.</p></li>
<li><p><strong>division_cost_dict</strong> (<em>dict</em>) – Dictionary storing updated division costs for all bacteria.</p></li>
<li><p><strong>source_bac_ndx</strong> (<em>int</em>) – Index of the source bacterium being evaluated.</p></li>
<li><p><strong>source_bac</strong> (<em>pandas.Series</em>) – Data for the source bacterium being evaluated.</p></li>
<li><p><strong>target_bac_ndx</strong> (<em>int</em>) – Index of the target bacterium being evaluated.</p></li>
<li><p><strong>target_bac</strong> (<em>pandas.Series</em>) – Data for the target bacterium being evaluated.</p></li>
<li><p><strong>redundant_link_dict_division</strong> (<em>dict</em>) – Dictionary storing redundant links for division relationships.</p></li>
<li><p><strong>sum_daughter_len_to_mother_ratio_boundary</strong> (<em>dict</em>) – Dictionary containing ‘avg’ (average) and ‘std’ (standard deviation) for
the sum of daughter-to-mother length ratios.</p></li>
<li><p><strong>max_daughter_len_to_mother_ratio_boundary</strong> (<em>dict</em>) – Dictionary containing ‘avg’ (average) and ‘std’ (standard deviation) for
the maximum daughter-to-mother length ratio.</p></li>
<li><p><strong>min_life_history_of_bacteria</strong> (<em>int</em>) – Minimum number of life history frames required for a bacterium to be considered valid.</p></li>
<li><p><strong>source_bac_next_time_step</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the next time step’s candidate for the source bacterium.</p></li>
<li><p><strong>source_bac_daughters</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the daughters of the source bacterium.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p><strong>division_cost_dict</strong> (<em>dict</em>): Updated dictionary of division costs for source-target pairs.</p></li>
<li><p><strong>redundant_link_dict_division</strong> (<em>dict</em>): Updated dictionary of redundant links.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calculateCreateLinkCostUE">
<span id="module-calculatecreatelinkcostue"></span><h2>Module: calculateCreateLinkCostUE<a class="headerlink" href="#module-calculateCreateLinkCostUE" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calculateCreateLinkCostUE.compute_create_link_from_unexpected_end_cost">
<span class="sig-prename descclassname"><span class="pre">calculateCreateLinkCostUE.</span></span><span class="sig-name descname"><span class="pre">compute_create_link_from_unexpected_end_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_end_bac_time_step_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unexpected_end_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_time_step_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_life_history_time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divided_vs_non_divided_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_divided_bac_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">division_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateCreateLinkCostUE.html#compute_create_link_from_unexpected_end_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateCreateLinkCostUE.compute_create_link_from_unexpected_end_cost" title="Link to this definition">¶</a></dt>
<dd><p>Computes the cost of linking unexpected end bacteria to bacteria from a next time step,
evaluating continuity link cost, division costs, and  maintenance the current links of candidate bacteria costs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing bacterial measured bacterial features.</p></li>
<li><p><strong>unexpected_end_bac_time_step_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing all bacteria present in the time step of unexpected end.</p></li>
<li><p><strong>unexpected_end_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing unexpected end bacteria.</p></li>
<li><p><strong>next_time_step_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing all bacteria from the previous time step.</p></li>
<li><p><strong>neighbors_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing neighboring relationships between bacteria, including their image and object numbers.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Array storing neighbor connections for bacteria.</p></li>
<li><p><strong>min_life_history_time_step</strong> (<em>int</em>) – Minimum number of life history frames required for a bacterium to be considered</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name in the DataFrame for parent image numbers.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name in the DataFrame for parent object numbers.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary containing column names for x and y center coordinates.</p></li>
<li><p><strong>divided_vs_non_divided_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to compare divided and non-divided states for bacteria</p></li>
<li><p><strong>non_divided_bac_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to evaluate candidate links for continuity events.</p></li>
<li><p><strong>division_model</strong> (<em>sklearn.Model</em>) – Machine learning model used to validate division links.</p></li>
<li><p><strong>color_array</strong> (<em>np.ndarray</em>) – Array representing the colors of objects in the tracking data. This is used for mapping
bacteria from the dataframe to the coordinate array for spatial analysis.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Array of spatial coordinates used for evaluating candidate links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple: A tuple containing the following DataFrames:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><strong>filtered_continuity_link_cost_df</strong> (<em>pandas.DataFrame</em>):</dt><dd><p>Filtered continuity link costs after applying thresholds and validations.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>validated_division_cost_df</strong> (<em>pandas.DataFrame</em>):</dt><dd><p>A DataFrame containing division costs after resolving conflicts and selecting
the most plausible division links. Conflicts are resolved in three main scenarios:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt><strong>Overlapping Division Scenarios for a Single Source</strong>:</dt><dd><ul>
<li><p>When a single source bacterium is involved in multiple division scenarios with
overlapping daughter candidates, the function evaluates each scenario’s probabilities.
The division pair with the highest likelihood is retained,
and other conflicting scenarios are removed.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Overlapping Daughters Across Different Sources</strong>:</dt><dd><ul>
<li><p>When different source bacteria propose overlapping daughters in their division scenarios,
the script compares the average division probabilities for each source.
The highest likely source-daughter link is retained.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Conflict Between Division and Continuity</strong>:</dt><dd><ul>
<li><p>When a candidate bacterium is involved in both division and continuity scenarios,
either for a single source or multiple sources, the function compares probabilities,
retains the more likely link (division or continuity),
and removes the less likely one, ensuring biologically plausible assignments.</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>final_division_cost_df</strong> (<em>pandas.DataFrame</em>):</dt><dd><p>Cleaned and finalized division costs for further analysis.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bacteriaTrackingUpdate">
<span id="module-bacteriatrackingupdate"></span><h2>Module: bacteriaTrackingUpdate<a class="headerlink" href="#module-bacteriaTrackingUpdate" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bacteriaTrackingUpdate.bacteria_modification">
<span class="sig-prename descclassname"><span class="pre">bacteriaTrackingUpdate.</span></span><span class="sig-name descname"><span class="pre">bacteria_modification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_bac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac_life_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_frame_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacteriaTrackingUpdate.html#bacteria_modification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bacteriaTrackingUpdate.bacteria_modification" title="Link to this definition">¶</a></dt>
<dd><p>Modifies bacterial tracking data by assigning target bacterium to source bacterium, either as its child or
the same bacterium, and recalculates features to ensure consistency in the tracking data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing tracking data and measured bacterial features for all bacteria.
This DataFrame is updated in place.</p></li>
<li><p><strong>source_bac</strong> (<em>dict</em>) – Dictionary representing the parent or the bacterium to which target is being assigned. Contains keys such as
<cite>ImageNumber</cite>, <cite>ObjectNumber</cite>, and <cite>id</cite>. If <cite>None</cite>, target bacterium is treated as an unexpected beginning.</p></li>
<li><p><strong>target_bac_life_history</strong> (<em>pandas.DataFrame</em>) – Subset of the DataFrame containing the lifecycle data of target bacterium.</p></li>
<li><p><strong>target_frame_bacteria</strong> (<em>pandas.DataFrame</em>) – DataFrame containing bacteria present in the same time step as the target bacterium.</p></li>
<li><p><strong>neighbor_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing information about neighboring bacteria for calculating neighbor-specific features.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix indicating neighbor relationships between bacteria.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the DataFrame.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the DataFrame.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying column names for bacterial centroid coordinates
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>The updated DataFrame <cite>df</cite> with modified bacterial tracking data.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bacteriaTrackingUpdate.calc_modified_features">
<span class="sig-prename descclassname"><span class="pre">bacteriaTrackingUpdate.</span></span><span class="sig-name descname"><span class="pre">calc_modified_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_bacteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacteriaTrackingUpdate.html#calc_modified_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bacteriaTrackingUpdate.calc_modified_features" title="Link to this definition">¶</a></dt>
<dd><p>Modifies and updates bacterial tracking data by calculating various features related to bacterial life history.</p>
<dl class="simple">
<dt><strong>Calculated Features</strong>:</dt><dd><ul class="simple">
<li><p><cite>id</cite>: Unique identifier for each bacterium.</p></li>
<li><p><cite>divideFlag</cite>: Whether a bacterium has divided.</p></li>
<li><p><cite>unexpected_end</cite> and <cite>unexpected_beginning</cite>: Flags indicating unexpected lifecycle events.</p></li>
<li><p><cite>daughters_index</cite>: List of indices for daughter bacteria.</p></li>
<li><p><cite>division_time</cite>: Time of division.</p></li>
<li><p><cite>LengthChangeRatio</cite>: Ratio of daughter to mother length.</p></li>
<li><p><cite>bacteria_movement</cite>: Distance traveled between time steps.</p></li>
<li><p><cite>TrajectoryX</cite> and <cite>TrajectoryY</cite>: Components of movement trajectory.</p></li>
<li><p><cite>MotionAlignmentAngle</cite>: Angle of motion alignment.</p></li>
<li><p><cite>LifeHistory</cite>: Duration of a bacterium’s lifecycle.</p></li>
<li><p><cite>direction_of_motion</cite>: Direction of movement in degrees.</p></li>
<li><p>Neighbor-related features such as <cite>difference_neighbors</cite>.</p></li>
<li><p>Slope and trajectory information (<cite>bacteria_slope</cite>, <cite>prev_bacteria_slope</cite>).</p></li>
<li><p>Parent-daughter relationships and alignment angles.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing tracking data and measured bacterial features for all bacteria.
This DataFrame is updated in place with calculated features.</p></li>
<li><p><strong>selected_bacteria</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing the subset of rows (bacteria) to be modified. It includes tracking and
measured bacterial features for selected bacteria.</p></li>
<li><p><strong>neighbor_df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing information about neighboring bacteria. Used for calculating neighbor-related
features.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix indicating neighboring relationships between bacteria.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of bacterial centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the dataframe.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the dataframe.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>The updated DataFrame <cite>df</cite> with modified features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bacteriaTrackingUpdate.remove_redundant_link">
<span class="sig-prename descclassname"><span class="pre">bacteriaTrackingUpdate.</span></span><span class="sig-name descname"><span class="pre">remove_redundant_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incorrect_target_bac_life_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacteriaTrackingUpdate.html#remove_redundant_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bacteriaTrackingUpdate.remove_redundant_link" title="Link to this definition">¶</a></dt>
<dd><p>Removes redundant or incorrect link in the bacterial tracking data by modifying the lifecycle information
of a target bacterium.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing tracking data and measured bacterial features for all bacteria.
This DataFrame is updated in place.</p></li>
<li><p><strong>incorrect_target_bac_life_history</strong> (<em>pandas.DataFrame</em>) – Subset of the DataFrame containing the lifecycle data of the target bacterium with incorrect link.</p></li>
<li><p><strong>neighbor_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing information about neighboring bacteria for calculating neighbor-specific features.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>lil_matrix</em>) – Sparse matrix indicating neighbor relationships between bacteria.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Column name for the parent image number in the DataFrame.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Column name for the parent object number in the DataFrame.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – Dictionary specifying the column names for bacterial centroid coordinates
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:</p>
<p>The updated DataFrame with redundant link removed.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-0">
<span id="module-helper"></span><h2>Module: helper<a class="headerlink" href="#module-0" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="helper.calc_distance_matrix">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calc_distance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_bac_coords_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_bac_coords_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calc_distance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calc_distance_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Calculates a distance matrix between two sets of bacteria coordinates.</p>
<p>This function computes the pairwise Euclidean distances between the coordinates of
target bacteria and reference bacteria</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_bac_coords_df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing the coordinates of the target bacteria.</p></li>
<li><p><strong>reference_bac_coords_df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing the coordinates of the reference bacteria.</p></li>
<li><p><strong>x_col</strong> (<em>str</em>) – The column name for the x-coordinate in both DataFrames.</p></li>
<li><p><strong>y_col</strong> (<em>str</em>) – The column name for the y-coordinate in both DataFrames.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas DataFrame representing the distance matrix, where rows correspond to
<cite>target_bac_coords_df</cite> indices and columns correspond to <cite>reference_bac_coords_df</cite> indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calc_movement">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calc_movement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bac2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bac1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coordinate_columns</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calc_movement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calc_movement" title="Link to this definition">¶</a></dt>
<dd><p>This function computes the displacement of a bacterium (<cite>bac1</cite> (source) to <cite>bac2</cite> (target))
using multiple spatial points.</p>
<dl class="simple">
<dt><strong>The computed movements include</strong>:</dt><dd><ul class="simple">
<li><p>Centroid movement.</p></li>
<li><p>Endpoint movements (first and second endpoints).</p></li>
<li><p>Cross-movements between endpoints.</p></li>
</ul>
</dd>
</dl>
<p>The minimum movement among all these calculations is returned to represent the most plausible movement distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bac2</strong> (<em>pandas.Series</em>) – Data for the bacterium in the next time step.</p></li>
<li><p><strong>bac1</strong> (<em>pandas.Series</em>) – Data for the bacterium in the current time step.</p></li>
<li><p><strong>center_coordinate_columns</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of the bacterial centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
</ul>
</dd>
</dl>
<dl>
<dt><strong>Returns</strong>:</dt><dd><p>float:</p>
<p>The minimum movement distance between <cite>bac1</cite> and <cite>bac2</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calc_neighbors_dir_motion_all">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calc_neighbors_dir_motion_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">division_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calc_neighbors_dir_motion_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calc_neighbors_dir_motion_all" title="Link to this definition">¶</a></dt>
<dd><p>Calculates motion alignment features for bacteria based on neighbor trajectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Main DataFrame containing bacterial motion and trajectory data.</p></li>
<li><p><strong>neighbor_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing neighbor information, including image and object numbers for neighbors.</p></li>
<li><p><strong>division_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing division-related indices for bacteria.</p></li>
<li><p><strong>selected_rows</strong> (<em>pandas.DataFrame</em>) – Optional DataFrame for updating specific selected rows. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: The updated DataFrame with motion alignment features added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calc_normalized_angle_between_motion_for_df">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calc_normalized_angle_between_motion_for_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac_motion_x_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bac_motion_y_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_avg_dir_motion_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_avg_dir_motion_y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calc_normalized_angle_between_motion_for_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calc_normalized_angle_between_motion_for_df" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the normalized angles between motion vectors for each row in a DataFrame.</p>
<p>This function computes the angle between a motion vector and its neighbors’ average motion vector
for each row in the DataFrame. The angles are normalized by dividing by 180 degrees.</p>
<p><strong>Mathematical Explanation</strong>:</p>
<ul>
<li><p><strong>Dot Product</strong>:
The dot product of two vectors is a measure of how aligned they are. For two vectors:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathbf{v_1} = (x_1, y_1), \quad \mathbf{v_2} = (x_2, y_2)\]</div>
</div>
<p>The dot product is given by:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathbf{v_1} \cdot \mathbf{v_2} = x_1 \cdot x_2 + y_1 \cdot y_2\]</div>
</div>
</li>
<li><p><strong>Magnitude of a Vector</strong>:
The magnitude (length) of a vector is calculated as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\| \mathbf{v} \| = \sqrt{x^2 + y^2}\]</div>
</div>
</li>
<li><p><strong>Cosine of the Angle</strong>:
The cosine of the angle ( theta ) between two vectors is computed as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\cos(\theta) = \frac{\mathbf{v_1} \cdot \mathbf{v_2}}{\| \mathbf{v_1} \| \| \mathbf{v_2} \|}\]</div>
</div>
<p>If either vector has zero magnitude, the cosine is undefined.</p>
</li>
<li><p><strong>Angle in Radians</strong>:
The angle ( theta ) in radians is obtained using the arccosine function:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\theta = \arccos(\cos(\theta))\]</div>
</div>
<p>To handle numerical precision, the cosine value is clipped to the range ([-1, 1]).</p>
</li>
<li><p><strong>Convert Radians to Degrees</strong>:
The angle is converted from radians to degrees using the formula:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{Angle (degrees)} = \frac{\theta \cdot 180}{\pi}\]</div>
</div>
</li>
<li><p><strong>Normalized Angle</strong>:
Finally, the angle is normalized by dividing the degrees by 180:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{Normalized Angle} = \frac{\text{Angle (degrees)}}{180}\]</div>
</div>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing direction of motion of objects and average direction of motion of neighbors.</p></li>
<li><p><strong>target_bac_motion_x_col</strong> (<em>str</em>) – The column name for the x-component of the object’s motion vector.</p></li>
<li><p><strong>target_bac_motion_y_col</strong> (<em>str</em>) – The column name for the y-component of the object’s motion vector.</p></li>
<li><p><strong>neighbors_avg_dir_motion_x</strong> (<em>str</em>) – The column name for the x-component of the neighbors’ average motion vector.</p></li>
<li><p><strong>neighbors_avg_dir_motion_y</strong> (<em>str</em>) – The column name for the y-component of the neighbors’ average motion vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray: A 1D array of normalized angles (0 to 1) for each row.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calculate_all_bac_endpoints">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calculate_all_bac_endpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calculate_all_bac_endpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calculate_all_bac_endpoints" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the endpoints of bacterial major axes based on orientation, length, and position.</p>
<p>This function determines the two endpoints of a bacterium’s major axis by considering its orientation
(parallel to vertical, horizontal, or otherwise) and center coordinates.</p>
<p><strong>Mathematical Explanation</strong>:</p>
<ul>
<li><p><strong>Condition 1</strong>: Bacteria parallel to the vertical axis <span class="math notranslate nohighlight">\(\pi / 2\)</span>.
For bacteria with orientation close to <span class="math notranslate nohighlight">\(\pm \pi / 2\)</span> (absolute difference less than <span class="math notranslate nohighlight">\(10^{-6}\)</span>),
the endpoints are calculated as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(x_{  {end1}}, y_{    {end1}}) = (x_{ {center}}, y_{  {center}} + L)\\(x_{  {end2}}, y_{    {end2}}) = (x_{ {center}}, y_{  {center}} - L)\end{aligned}\end{align} \]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> is the major axis length.</p>
</li>
<li><p><strong>Condition 2</strong>: Bacteria parallel to the horizontal axis.
For bacteria with orientation close to 0 (absolute difference less than <span class="math notranslate nohighlight">\(10^{-6}\)</span>):</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(x_{  {end1}}, y_{    {end1}}) = (x_{ {center}} + L, y_{      {center}})\\(x_{  {end2}}, y_{    {end2}}) = (x_{ {center}} - L, y_{      {center}})\end{aligned}\end{align} \]</div>
</div>
</li>
<li><p><strong>Condition 3</strong>: Non-axis-aligned bacteria:
“For bacteria with arbitrary orientation <span class="math notranslate nohighlight">\(\theta\)</span>, the endpoints are computed using the
following formulas:”</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{   {end1}} = x_{   {center}} + \frac{L}{2} \cdot \cos(\theta)\\y_{   {end1}} = y_{   {center}} + (x_{        {end1}} - x_{   {center}}) \cdot \tan(\theta)\\x_{   {end2}} = x_{   {center}} - \frac{L}{2} \cdot \cos(\theta)\\y_{   {end2}} = y_{   {center}} + (x_{        {end2}} - x_{   {center}}) \cdot \tan(\theta)\end{aligned}\end{align} \]</div>
</div>
</li>
<li><p>Endpoint selection ensures correct ordering along the major axis.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing bacterial data, including orientation, center coordinates,
and major axis length.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary with keys ‘x’ and ‘y’, specifying the column names for center coordinates.</p></li>
<li><p><strong>angle_tolerance</strong> (<em>float</em>) – The tolerance for detecting vertical or horizontal orientations (default: 1e-6).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: The modified DataFrame with additional columns for endpoints:
- <cite>endpoint1_X</cite>, <cite>endpoint1_Y</cite>: Coordinates of the first endpoint.
- <cite>endpoint2_X</cite>, <cite>endpoint2_Y</cite>: Coordinates of the second endpoint.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calculate_all_bac_slopes">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calculate_all_bac_slopes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calculate_all_bac_slopes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calculate_all_bac_slopes" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the slopes of lines formed by bacterial endpoints in the input DataFrame.</p>
<p>This function determines the slope for each bacterium based on its two endpoints
(<cite>endpoint1_X</cite>, <cite>endpoint1_Y</cite>, <cite>endpoint2_X</cite>, <cite>endpoint2_Y</cite>) provided in the input DataFrame.
The slope is calculated for all bacteria, with special handling for vertical lines
(where the slope is undefined).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing columns for bacterial endpoints:
- <cite>endpoint1_X</cite>, <cite>endpoint1_Y</cite>: Coordinates of the first endpoint.
- <cite>endpoint2_X</cite>, <cite>endpoint2_Y</cite>: Coordinates of the second endpoint.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame: The input DataFrame with an additional column:</p>
<ul class="simple">
<li><p><strong>bacteria_slope</strong>: The slope of the line formed by the bacterial endpoints.
NaN is assigned for vertical lines.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calculate_angles_between_slopes">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calculate_angles_between_slopes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slope_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope_b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calculate_angles_between_slopes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calculate_angles_between_slopes" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the orientation angles between two slopes in degrees.</p>
<p>This function computes the angle in degrees between two lines defined by their slopes.
NaN values are replaced with 90 degrees to handle undefined cases (e.g., perpendicular lines).</p>
<p><strong>Mathematical Explanation</strong>:</p>
<ul>
<li><p><strong>Angle Between Two Slopes</strong>:
The angle <span class="math notranslate nohighlight">\(\theta\)</span> between two lines with slopes <span class="math notranslate nohighlight">\(m_1\)</span> and <span class="math notranslate nohighlight">\(m_2\)</span> is given by:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\theta = \arctan\left( \left| \frac{m_1 - m_2}{1 + m_1 m_2} \right| \right)\]</div>
</div>
<dl class="simple">
<dt>where:</dt><dd><p><span class="math notranslate nohighlight">\(m_1\)</span> is the slope of the first line.
<span class="math notranslate nohighlight">\(m_2\)</span> is the slope of the second line.</p>
</dd>
</dl>
</li>
<li><p><strong>Convert Radians to Degrees</strong>:
The angle in degrees is calculated using:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{Angle (degrees)} = \frac{\theta \cdot 180}{\pi}\]</div>
</div>
</li>
<li><p><strong>Handling Undefined Cases</strong>:
When <span class="math notranslate nohighlight">\(1 + m_1 m_2 = 0\)</span>, the angle is undefined (lines are perpendicular). In such cases,
NaN values are replaced with 90 degrees.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slope_a</strong> (<em>np.ndarray</em>) – An array of slope values for the first set of lines.</p></li>
<li><p><strong>slope_b</strong> (<em>np.ndarray</em>) – An array of slope values for the second set of lines.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array of angles in degrees between the lines.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calculate_bac_endpoints">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calculate_bac_endpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">major</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_rotation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calculate_bac_endpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calculate_bac_endpoints" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the endpoints of the major axis of a bacterium based on its center, length, and orientation.</p>
<p>This function computes the two endpoints of the major axis for a bacterium given its center coordinates,
major axis length, and orientation angle. It handles three cases: bacteria aligned with the vertical axis,
bacteria aligned with the horizontal axis, and bacteria with arbitrary orientations.</p>
<p><strong>Mathematical Explanation</strong>:</p>
<ul>
<li><p><strong>Condition 1</strong>: Bacteria parallel to the vertical axis <span class="math notranslate nohighlight">\(\pi / 2\)</span>.
For bacteria with orientation close to <span class="math notranslate nohighlight">\(\pm \pi / 2\)</span> (absolute difference less than <span class="math notranslate nohighlight">\(10^{-6}\)</span>),
the endpoints are calculated as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(x_{  {end1}}, y_{    {end1}}) = (x_{ {center}}, y_{  {center}} + L)\\(x_{  {end2}}, y_{    {end2}}) = (x_{ {center}}, y_{  {center}} - L)\end{aligned}\end{align} \]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> is the major axis length.</p>
</li>
<li><p><strong>Condition 2</strong>: Bacteria parallel to the horizontal axis.
For bacteria with orientation close to 0 (absolute difference less than <span class="math notranslate nohighlight">\(10^{-6}\)</span>):</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}(x_{  {end1}}, y_{    {end1}}) = (x_{ {center}} + L, y_{      {center}})\\(x_{  {end2}}, y_{    {end2}}) = (x_{ {center}} - L, y_{      {center}})\end{aligned}\end{align} \]</div>
</div>
</li>
<li><p><strong>Condition 3</strong>: Non-axis-aligned bacteria:
“For bacteria with arbitrary orientation <span class="math notranslate nohighlight">\(\theta\)</span>, the endpoints are computed using the
following formulas:”</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{   {end1}} = x_{   {center}} + \frac{L}{2} \cdot \cos(\theta)\\y_{   {end1}} = y_{   {center}} + (x_{        {end1}} - x_{   {center}}) \cdot \tan(\theta)\\x_{   {end2}} = x_{   {center}} - \frac{L}{2} \cdot \cos(\theta)\\y_{   {end2}} = y_{   {center}} + (x_{        {end2}} - x_{   {center}}) \cdot \tan(\theta)\end{aligned}\end{align} \]</div>
</div>
</li>
<li><p>Endpoint selection ensures correct ordering along the major axis.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<em>list</em>) – A list containing the x and y coordinates of the bacterium’s center (e.g., <cite>(x_center, y_center)</cite>).</p></li>
<li><p><strong>major</strong> (<em>float</em>) – The length of the major axis of the bacterium.</p></li>
<li><p><strong>angle_rotation</strong> (<em>float</em>) – The orientation angle of the bacterium in radians.</p></li>
<li><p><strong>angle_tolerance</strong> (<em>float</em>) – The tolerance for detecting vertical or horizontal orientations (default: 1e-6).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list: A list containing two sub lists for the endpoints:
- <cite>[x_end1, y_end1]</cite>: Coordinates of the first endpoint.
- <cite>[x_end2, y_end2]</cite>: Coordinates of the second endpoint.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calculate_bacterial_life_history_features">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calculate_bacterial_life_history_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_all_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">division_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_selected_rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calculate_bacterial_life_history_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calculate_bacterial_life_history_features" title="Link to this definition">¶</a></dt>
<dd><p>Calculates features related to the continuous life history of bacteria.</p>
<p>This function computes various features for bacteria across time steps, such as changes in length,
movement patterns, and directional motion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing bacterial features across time steps.</p></li>
<li><p><strong>calc_all_features</strong> (<em>bool</em>) – If True, computes additional features such as length change ratio, trajectory direction,
and updates neighbor interactions.</p></li>
<li><p><strong>neighbor_df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing information about neighboring bacteria.</p></li>
<li><p><strong>division_df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing division-related information for bacteria.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for x and y center coordinates.
Expected keys:
- <cite>‘x’</cite>: Base column name for x-coordinate.
- <cite>‘y’</cite>: Base column name for y-coordinate.</p></li>
<li><p><strong>use_selected_rows</strong> (<em>bool</em>) – If True, updates features based on selected rows from the original DataFrame.</p></li>
<li><p><strong>original_df</strong> (<em>pandas.DataFrame</em>) – The original DataFrame (optional) for updating selected rows when <cite>flag_selected_rows</cite> is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame: The updated DataFrame with the following newly computed features:</p>
<ul class="simple">
<li><p><strong>Length Change Ratio</strong> (<cite>LengthChangeRatio</cite>):
The ratio of the major axis length between the current and previous time steps.</p></li>
<li><p><strong>Movement</strong> (<cite>bacteria_movement</cite>):
The minimum movement of the bacterium across time steps, calculated as the smallest
displacement among the center and endpoints.</p></li>
<li><p><strong>Direction of Motion</strong>:</p>
<ul>
<li><p><cite>direction_of_motion</cite>: The angle (in radians) representing the trajectory direction.</p></li>
<li><p><cite>TrajectoryX</cite> and <cite>TrajectoryY</cite>: The x and y components of the trajectory displacement.</p></li>
</ul>
</li>
<li><p><strong>Neighbor Interactions</strong>:
Updates direction of motion (<cite>direction_of_motion</cite>) based on neighboring bacteria’s
trajectories and interactions.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calculate_normalized_angle_between_motion_vectors">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calculate_normalized_angle_between_motion_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbor_motion_vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_motion_vectors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calculate_normalized_angle_between_motion_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calculate_normalized_angle_between_motion_vectors" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the normalized angle (0 to 1) between two sets of direction of motion vectors.</p>
<p>This function computes the angles between corresponding direction of motion vectors in two arrays,
normalizes the angles by dividing by 180, and returns the result.</p>
<p><strong>Mathematical Explanation</strong>:</p>
<ul>
<li><p><strong>Dot Product</strong>:
The dot product of two vectors is a measure of how aligned they are. For two vectors:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathbf{v_1} = (x_1, y_1), \quad \mathbf{v_2} = (x_2, y_2)\]</div>
</div>
<p>The dot product is given by:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathbf{v_1} \cdot \mathbf{v_2} = x_1 \cdot x_2 + y_1 \cdot y_2\]</div>
</div>
</li>
<li><p><strong>Magnitude of a Vector</strong>:
The magnitude (length) of a vector is calculated as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\| \mathbf{v} \| = \sqrt{x^2 + y^2}\]</div>
</div>
</li>
<li><p><strong>Cosine of the Angle</strong>:
The cosine of the angle ( theta ) between two vectors is computed as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\cos(\theta) = \frac{\mathbf{v_1} \cdot \mathbf{v_2}}{\| \mathbf{v_1} \| \| \mathbf{v_2} \|}\]</div>
</div>
<p>If either vector has zero magnitude, the cosine is undefined.</p>
</li>
<li><p><strong>Angle in Radians</strong>:
The angle ( theta ) in radians is obtained using the arccosine function:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\theta = \arccos(\cos(\theta))\]</div>
</div>
<p>To handle numerical precision, the cosine value is clipped to the range ([-1, 1]).</p>
</li>
<li><p><strong>Convert Radians to Degrees</strong>:
The angle is converted from radians to degrees using the formula:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{Angle (degrees)} = \frac{\theta \cdot 180}{\pi}\]</div>
</div>
</li>
<li><p><strong>Normalized Angle</strong>:
Finally, the angle is normalized by dividing the degrees by 180:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{Normalized Angle} = \frac{\text{Angle (degrees)}}{180}\]</div>
</div>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neighbor_motion_vectors</strong> (<em>np.ndarray</em>) – A 2D array where each row represents a direction of motion vector for neighbors.</p></li>
<li><p><strong>target_motion_vectors</strong> (<em>np.ndarray</em>) – A 2D array where each row represents a vector for target motions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D array of normalized angles (0 to 1) between the vectors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calculate_trajectory_angles">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calculate_trajectory_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calculate_trajectory_angles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calculate_trajectory_angles" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the angles of trajectory directions between two objects.</p>
<p>This function computes the direction vector between two bacteria and calculates the angle of that direction in
radians. The angles are measured counterclockwise from the positive x-axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing the x and y coordinates for two positions of objects.
These positions are used to calculate the trajectory direction.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of object centers.</p></li>
<li><p><strong>suffix1</strong> (<em>str</em>) – A suffix added to the base column names in <cite>center_coord_cols</cite> to identify the first set of positions.
Default is an empty string.</p></li>
<li><p><strong>suffix2</strong> (<em>str</em>) – An optional suffix added to the base column names in <cite>center_coord_cols</cite> to identify the second set of
positions. If not provided, the function assumes the second set of positions corresponds to columns
prefixed with <cite>prev_time_step</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray: A 1D array of angles (in radians) corresponding to the direction of trajectory for
each object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.calculate_trajectory_displacement">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">calculate_trajectory_displacement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#calculate_trajectory_displacement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.calculate_trajectory_displacement" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the displacement of objects along a specified axis between consecutive positions.</p>
<p>This function computes the difference (displacement) between the current and previous positions
of objects along a specified axis (x or y). It is useful for analyzing movement patterns or
trajectories over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing the current and previous positions of objects.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of the current position.
Expected keys:
- <cite>‘x’</cite>: Base column name for the x-coordinate.
- <cite>‘y’</cite>: Base column name for the y-coordinate.</p></li>
<li><p><strong>axis</strong> (<em>str</em>) – The axis along which to calculate the displacement. Must be one of:
- <cite>‘x’</cite>: Calculates displacement along the x-axis.
- <cite>‘y’</cite>: Calculates displacement along the y-axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.Series: A Series containing the displacements along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.convert_angle_to_radian">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">convert_angle_to_radian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#convert_angle_to_radian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.convert_angle_to_radian" title="Link to this definition">¶</a></dt>
<dd><p>Converts bacterial orientation angles from degrees to radians and modifies the values.</p>
<p>The orientation is adjusted using the formula:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Orientation (radian) = - \frac{(\text{Orientation (degrees)} + 90) \cdot \pi}{180}\]</div>
</div>
<p>This ensures the angles are transformed to a range suitable for downstream computations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing a column named “AreaShape_Orientation” with orientation angles in degrees.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: The modified DataFrame with the “AreaShape_Orientation” column converted to radians.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.convert_end_points_um_to_pixel">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">convert_end_points_um_to_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">um_per_pixel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.144</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#convert_end_points_um_to_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.convert_end_points_um_to_pixel" title="Link to this definition">¶</a></dt>
<dd><p>Converts endpoint coordinates from micrometers (um) to pixel units based on a specified conversion factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end_points</strong> (<em>list</em><em> or </em><em>np.array</em>) – A list or array of endpoint coordinates in micrometers to be converted.</p></li>
<li><p><strong>um_per_pixel</strong> (<em>float</em>) – The conversion factor representing micrometers per pixel (default: 0.144).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array of endpoint coordinates converted to pixel units.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.convert_pixel_to_um">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">convert_pixel_to_um</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_per_micron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_rel_center_coord_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#convert_pixel_to_um"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.convert_pixel_to_um" title="Link to this definition">¶</a></dt>
<dd><p>Converts distance measurements from pixel units to micrometers (um)
within a DataFrame based on a specified conversion factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The input DataFrame containing spatial and shape measurements in pixel units.</p></li>
<li><p><strong>pixel_per_micron</strong> (<em>float</em>) – The conversion factor representing micrometers per pixel.</p></li>
<li><p><strong>all_rel_center_coord_cols</strong> (<em>dict</em>) – A dictionary containing the column names for x and y center coordinates,
e.g., {‘x’: [‘Location_Center_X’, ‘AreaShape_Center_X’], ‘y’: [‘Location_Center_Y’, ‘AreaShape_Center_Y’]}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The modified DataFrame with measurements converted to micrometers.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.convert_um_to_pixel">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">convert_um_to_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">major_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_per_micron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.144</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#convert_um_to_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.convert_um_to_pixel" title="Link to this definition">¶</a></dt>
<dd><p>Converts physical measurements in pixel to micrometers (um) based on a specified conversion factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>major_len</strong> (<em>float</em>) – The length measurement in um to be converted.</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – The radius measurement in um to be converted.</p></li>
<li><p><strong>endpoints</strong> (<em>list</em><em> or </em><em>np.array</em>) – A list or array of endpoint coordinates in um.</p></li>
<li><p><strong>center_pos</strong> (<em>list</em><em> or </em><em>np.array</em>) – A list or array of center coordinate in um.</p></li>
<li><p><strong>pixel_per_micron</strong> (<em>float</em>) – The conversion factor representing pixel per micrometers(default: 0.144).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the converted major_len, radius, endpoints, center_pos in pixel units.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.extract_bacteria_features">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">extract_bacteria_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#extract_bacteria_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.extract_bacteria_features" title="Link to this definition">¶</a></dt>
<dd><p>Extracts key geometric and spatial features of bacteria from the input DataFrame.</p>
<p>This function retrieves the major axis length, minor axis length, radius, orientation,
and center coordinates of bacteria, organizing them into a dictionary for further use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing bacterial data with required columns for shape and position.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary with keys ‘x’ and ‘y’, specifying the column names for center coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict: A dictionary containing the extracted features:
- ‘major’: Major axis length of bacteria.
- ‘minor’: Minor axis length of bacteria.
- ‘orientation’: Orientation of the bacteria (e.g., angle or direction).
- ‘center_x’: X-coordinate of the bacteria’s center.
- ‘center_y’: Y-coordinate of the bacteria’s center.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.extract_bacteria_info">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">extract_bacteria_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bacteria_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels_per_micron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">major_axis_len_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#extract_bacteria_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.extract_bacteria_info" title="Link to this definition">¶</a></dt>
<dd><p>Extracts and converts bacterial object information and convert from micrometers (µm) to pixel.</p>
<p>This function processes spatial and shape information of bacterial objects
from a given DataFrame. The center coordinates and major axis length are
converted from micrometers to pixel using the provided conversion factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bacteria_data</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing information about bacterial objects, including
spatial measurements and orientation.</p></li>
<li><p><strong>pixels_per_micron</strong> (<em>float</em>) – The conversion factor representing the number of pixels per micrometer.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for x and y center coordinates.
Example: {‘x’: ‘Location_Center_X’, ‘y’: ‘Location_Center_Y’}.</p></li>
<li><p><strong>major_axis_len_col</strong> (<em>str</em>) – The name of the column representing the major axis length of the objects (in pixels).</p></li>
<li><p><strong>orientation_col</strong> (<em>str</em>) – The name of the column representing the orientation of the objects
(e.g., in degrees or radians, depending on the dataset).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple: A tuple containing the following elements:</dt><dd><ul class="simple">
<li><p>objects_center_x (pandas.Series): The x-coordinates of object centers in pixel.</p></li>
<li><p>objects_center_y (pandas.Series): The y-coordinates of object centers in pixel.</p></li>
<li><p>objects_major_axis (pandas.Series): The major axis length of objects in pixel.</p></li>
<li><p>objects_orientation (pandas.Series): The orientation of objects.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.identify_important_columns">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">identify_important_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#identify_important_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.identify_important_columns" title="Link to this definition">¶</a></dt>
<dd><p>Identifies key columns related to center coordinates, labels, and parent objects
from the provided DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing columns with bacterial feature data, such as tracking information
and spatial coordinates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple: A tuple containing:</p>
<ul class="simple">
<li><p><strong>center_coord_cols</strong> (<em>dict</em>): Primary center coordinate columns
(e.g., {‘x’: ‘Location_Center_X’, ‘y’: ‘Location_Center_Y’}).</p></li>
<li><p><strong>all_rel_center_coord_cols</strong> (<em>dict</em>): All available center coordinate columns
(e.g., {‘x’: [‘Location_Center_X’, ‘AreaShape_Center_X’], ‘y’: [‘Location_Center_Y’, ‘AreaShape_Center_Y’]}).</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>): Name of the column for parent image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>): Name of the column for parent object number.</p></li>
<li><p><strong>label_col</strong> (<em>str</em>): Name of the column for object labels.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="helper.update_dataframe_with_selected_rows">
<span class="sig-prename descclassname"><span class="pre">helper.</span></span><span class="sig-name descname"><span class="pre">update_dataframe_with_selected_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_rows</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/helper.html#update_dataframe_with_selected_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#helper.update_dataframe_with_selected_rows" title="Link to this definition">¶</a></dt>
<dd><p>Updates specific rows in a DataFrame based on another DataFrame of selected rows.</p>
<p>This function takes an input DataFrame and updates specific rows (identified by the indices of the <cite>selected_rows</cite>
DataFrame) with the values from the corresponding columns in <cite>selected_rows</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame to be updated.</p></li>
<li><p><strong>selected_rows</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing the selected rows and their updated values. The indices of <cite>selected_rows</cite>
must match the indices in <cite>df</cite> that are to be updated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame: The updated DataFrame with the following columns modified or added:</p>
<ul class="simple">
<li><p><strong>`prev_time_step_MajorAxisLength`</strong>:
Major axis length of the bacterium from the previous time step.</p></li>
<li><p><strong>`LengthChangeRatio`</strong>:
The ratio of the major axis length between the current and previous time steps.</p></li>
<li><p><strong>Center Coordinates</strong>:
- <cite>prev_time_step_center_x</cite>: X-coordinate of the bacterium’s center from the previous time step.
- <cite>prev_time_step_center_y</cite>: Y-coordinate of the bacterium’s center from the previous time step.</p></li>
<li><p><strong>Endpoint Coordinates</strong>:
- <cite>prev_time_step_endpoint1_X</cite>: X-coordinate of the first endpoint from the previous time step.
- <cite>prev_time_step_endpoint1_Y</cite>: Y-coordinate of the first endpoint from the previous time step.
- <cite>prev_time_step_endpoint2_X</cite>: X-coordinate of the second endpoint from the previous time step.
- <cite>prev_time_step_endpoint2_Y</cite>: Y-coordinate of the second endpoint from the previous time step.</p></li>
<li><p><strong>`bacteria_movement`</strong>:
The minimum movement of the bacterium across time steps, calculated as the smallest
displacement among the center and endpoints.</p></li>
<li><p><strong>Trajectory Features</strong>:
- <cite>direction_of_motion</cite>: The angle (in radians) representing the trajectory direction.
- <cite>TrajectoryX</cite>: X-component of the trajectory displacement.
- <cite>TrajectoryY</cite>: Y-component of the trajectory displacement.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calculateOverlap">
<span id="module-calculateoverlap"></span><h2>Module: calculateOverlap<a class="headerlink" href="#module-calculateOverlap" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calculateOverlap.calculate_frame_existence_links">
<span class="sig-prename descclassname"><span class="pre">calculateOverlap.</span></span><span class="sig-name descname"><span class="pre">calculate_frame_existence_links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">division_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuity_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateOverlap.html#calculate_frame_existence_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateOverlap.calculate_frame_existence_links" title="Link to this definition">¶</a></dt>
<dd><p>Calculates overlaps source &amp; target object of existence links in consecutive frames, distinguishing between
objects involved in divisions and those maintaining continuity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>division_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing objects involved in division, with parent and daughter indices for overlap computation.</p></li>
<li><p><strong>continuity_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing objects maintaining continuity between frames, with indices for overlap computation.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Sparse boolean array where each row corresponds to the coordinates of an object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame</p>
<p>A combined pivoted DataFrame containing IoU values:
- For objects involved in division, it shows overlaps between parent and daughter objects.
- For continuous objects, it shows overlaps between objects in the two frames.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateOverlap.compute_intersections_and_unions">
<span class="sig-prename descclassname"><span class="pre">calculateOverlap.</span></span><span class="sig-name descname"><span class="pre">compute_intersections_and_unions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateOverlap.html#compute_intersections_and_unions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateOverlap.compute_intersections_and_unions" title="Link to this definition">¶</a></dt>
<dd><p>Computes intersections and unions between two sets of objects based on their spatial coordinates,
and calculates the Intersection over Union (IoU) for each pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing object indices in columns <cite>col1</cite> and <cite>col2</cite>.</p></li>
<li><p><strong>col1</strong> (<em>str</em>) – Column names representing indices of two sets of objects.</p></li>
<li><p><strong>col2</strong> (<em>str</em>) – Column names representing indices of two sets of objects.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Sparse boolean array where each row corresponds to the coordinates of an object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: Updated DataFrame with a new column <cite>iou</cite> containing the IoU values for each pair of objects.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateOverlap.compute_intersections_and_unions_division">
<span class="sig-prename descclassname"><span class="pre">calculateOverlap.</span></span><span class="sig-name descname"><span class="pre">compute_intersections_and_unions_division</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateOverlap.html#compute_intersections_and_unions_division"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateOverlap.compute_intersections_and_unions_division" title="Link to this definition">¶</a></dt>
<dd><p>Computes intersections and unique areas for a pair of objects, typically for a parent-daughter relationship,
and calculates Intersection over Union (IoU) with unique area consideration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing object indices in columns <cite>col1</cite> and <cite>col2</cite>.</p></li>
<li><p><strong>col1</strong> (<em>str</em>) – Column names representing indices of two sets of objects.</p></li>
<li><p><strong>col2</strong> (<em>str</em>) – Column names representing indices of two sets of objects.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Sparse boolean array where each row corresponds to the coordinates of an object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: Updated DataFrame with a new column <cite>iou</cite> containing the IoU values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateOverlap.find_overlap_oad_mother_daughters">
<span class="sig-prename descclassname"><span class="pre">calculateOverlap.</span></span><span class="sig-name descname"><span class="pre">find_overlap_oad_mother_daughters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mother_bad_daughters_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateOverlap.html#find_overlap_oad_mother_daughters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateOverlap.find_overlap_oad_mother_daughters" title="Link to this definition">¶</a></dt>
<dd><p>Identifies overlaps between mother objects of OAD (mothers with over assign daughters status)
types and their associated daughter objects by calculating IoU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mother_bad_daughters_df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing indices of mother and daughter objects.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Sparse boolean array where each row corresponds to the coordinates of an object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: Pivoted DataFrame showing the IoU values for each mother-daughter pair.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calculateOverlap.track_object_overlaps_to_next_frame">
<span class="sig-prename descclassname"><span class="pre">calculateOverlap.</span></span><span class="sig-name descname"><span class="pre">track_object_overlaps_to_next_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_objects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_objects_in_next_time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coordinate_columns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daughter_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calculateOverlap.html#track_object_overlaps_to_next_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calculateOverlap.track_object_overlaps_to_next_frame" title="Link to this definition">¶</a></dt>
<dd><p>Tracks overlaps between objects in the current frame and candidate objects in the next frame using IoU,
with optional division-specific calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing current frame objects.</p></li>
<li><p><strong>selected_objects</strong> (<em>pandas.DataFrame</em>) – Subset of objects selected from the current frame.</p></li>
<li><p><strong>next_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing next frame objects.</p></li>
<li><p><strong>selected_objects_in_next_time_step</strong> (<em>pandas.DataFrame</em>) – Subset of objects selected from the next frame.</p></li>
<li><p><strong>center_coordinate_columns</strong> (<em>dict</em>) – Dictionary containing column names for x and y center coordinates.</p></li>
<li><p><strong>color_array</strong> (<em>numpy.ndarray</em>) – Array storing colors for each object.</p></li>
<li><p><strong>daughter_flag</strong> (<em>bool</em>) – Whether to calculate unique areas for division analysis.</p></li>
<li><p><strong>coordinate_array</strong> (<em>csr_matrix</em>) – Sparse boolean array where each row corresponds to the coordinates of an object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple: Pivoted DataFrame showing IoU values for overlaps and a product DataFrame with detailed pairwise data.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-neighborAnalysis">
<span id="module-neighboranalysis"></span><h2>Module: neighborAnalysis<a class="headerlink" href="#module-neighborAnalysis" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="neighborAnalysis.compare_neighbor_sets">
<span class="sig-prename descclassname"><span class="pre">neighborAnalysis.</span></span><span class="sig-name descname"><span class="pre">compare_neighbor_sets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_rows_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_time_step_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_common_elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neighborAnalysis.html#compare_neighbor_sets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neighborAnalysis.compare_neighbor_sets" title="Link to this definition">¶</a></dt>
<dd><p>Compares neighbor sets of source and target bacteria for each link to calculate differences and commonalities.</p>
<dl class="simple">
<dt><strong>This function determines</strong>:</dt><dd><ul class="simple">
<li><p>How many neighbors are different between the source and target bacteria.</p></li>
<li><p>How many neighbors are shared (common) between the source and target bacteria.</p></li>
</ul>
</dd>
</dl>
<p>The results are stored as new columns in the DataFrame (<cite>difference_neighbors</cite> and <cite>common_neighbors</cite>).</p>
<dl class="simple">
<dt><strong>Key Operations</strong>:</dt><dd><ol class="arabic simple">
<li><p><strong>Neighbor Extraction</strong>:
- Extracts the neighbor sets for each bacterium (source and target) from the <cite>neighbor_list_array</cite>.
- Accounts for neighbors in the current and previous time steps.</p></li>
<li><p><strong>Comparison</strong>:
- Calculates the difference in neighbors (i.e., neighbors present in one bacterium but not in the other).
- Identifies common neighbors (i.e., neighbors shared between source and target).</p></li>
<li><p><strong>Handling Special Cases</strong>:
- Accounts for bacteria with unexpected beginnings or ends.
- Ensures proper handling of bacteria flagged with parent-child relationships.</p></li>
<li><dl class="simple">
<dt><strong>Updating DataFrame</strong>:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Updates <cite>df</cite> with calculated values for:</dt><dd><ul>
<li><p><cite>difference_neighbors_&lt;col_target&gt;</cite>: Number of differing neighbors between source and target.</p></li>
<li><p><cite>common_neighbors_&lt;col_target&gt;</cite>: Number of shared neighbors.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing bacterial data, including neighbor information and flags.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>scipy.sparse.lil_matrix</em>) – A sparse matrix representing neighbor relationships, where rows correspond to bacteria and columns
represent their neighbors.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – The column name in <cite>df</cite> representing the parent bacterium’s image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – The column name in <cite>df</cite> representing the parent bacterium’s object number.</p></li>
<li><p><strong>selected_rows_df</strong> (<em>pandas.DataFrame</em>) – A subset of rows from <cite>df</cite> to analyze specific bacteria and their neighbors. If <cite>None</cite>, the entire
DataFrame is considered. Default is <cite>None</cite>.</p></li>
<li><p><strong>selected_time_step_df</strong> (<em>pandas.DataFrame</em>) – A subset of rows representing bacteria from a specific time step for reference. If <cite>None</cite>, the entire
DataFrame is used as the reference. Default is <cite>None</cite>.</p></li>
<li><p><strong>return_common_elements</strong> (<em>bool</em>) – Whether to calculate and return the number of shared neighbors between source and target bacteria.
Default is <cite>True</cite>.</p></li>
<li><p><strong>col_target</strong> (<em>str</em>) – A suffix added to column names to differentiate data for specific bacteria subsets. Default is <cite>‘’</cite>.</p></li>
<li><p><strong>index2</strong> (<em>bool</em>) – Whether to use a secondary index (<cite>index2</cite>) for calculations. Default is <cite>True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>pandas.DataFrame: Updated DataFrame with columns:</dt><dd><ul class="simple">
<li><p><cite>difference_neighbors_&lt;col_target&gt;</cite>: Number of neighbors differing between source and target bacteria.</p></li>
<li><p><cite>common_neighbors_&lt;col_target&gt;</cite>: Number of shared neighbors.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neighborAnalysis.compare_neighbors_batch">
<span class="sig-prename descclassname"><span class="pre">neighborAnalysis.</span></span><span class="sig-name descname"><span class="pre">compare_neighbors_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bac1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bac2_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_common_elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neighborAnalysis.html#compare_neighbors_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neighborAnalysis.compare_neighbors_batch" title="Link to this definition">¶</a></dt>
<dd><p>Compares the neighbor sets of a single bacterium (<cite>bac1</cite>) with multiple bacteria (<cite>bac2_batch</cite>)
(candidate target bacteria) to calculate the number of differing and shared neighbors for each pair.</p>
<dl class="simple">
<dt><strong>Key Operations</strong>:</dt><dd><ul class="simple">
<li><p>Extracts the neighbor indices for <cite>bac1</cite> and all bacteria in <cite>bac2_batch</cite> from <cite>neighbor_list_array</cite>.</p></li>
<li><p>Filters neighbors based on conditions like unexpected beginnings and ends.</p></li>
<li><p>Compares neighbor sets for each pair to compute the differences and commonalities.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing bacterial data.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>scipy.sparse.lil_matrix</em>) – Sparse matrix representing neighbor relationships for bacteria.</p></li>
<li><p><strong>bac1</strong> (<em>pandas.Series</em>) – Data for the first bacterium (source) in the relationship.</p></li>
<li><p><strong>bac2_batch</strong> (<em>pandas.DataFrame</em>) – Data for multiple target bacteria in the relationship.</p></li>
<li><p><strong>return_common_elements</strong> (<em>bool</em>) – If <cite>True</cite>, returns the number of shared neighbors in addition to differing neighbors.
Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p><cite>diff_neighbor_list</cite> (np.ndarray): Array of differing neighbor counts for each pair.</p></li>
<li><p><cite>common_neighbor_list</cite> (np.ndarray, optional): Array of shared neighbor counts for each pair if
<cite>return_common_elements=True</cite>.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neighborAnalysis.compare_neighbors_single_pair">
<span class="sig-prename descclassname"><span class="pre">neighborAnalysis.</span></span><span class="sig-name descname"><span class="pre">compare_neighbors_single_pair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bac1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bac2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_common_elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neighborAnalysis.html#compare_neighbors_single_pair"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neighborAnalysis.compare_neighbors_single_pair" title="Link to this definition">¶</a></dt>
<dd><p>Compares the neighbor sets of two bacteria (bac1 and bac2) to calculate the number of differing
and shared neighbors.</p>
<dl class="simple">
<dt><strong>Key Operations</strong>:</dt><dd><ul class="simple">
<li><p>Extracts the neighbor indices for <cite>bac1</cite> and <cite>bac2</cite> from <cite>neighbor_list_array</cite>.</p></li>
<li><p>Filters neighbors based on conditions like unexpected beginnings and ends.</p></li>
<li><p>Compares the neighbor sets to compute the differences and commonalities.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing bacterial data.</p></li>
<li><p><strong>neighbor_list_array</strong> (<em>scipy.sparse.lil_matrix</em>) – Sparse matrix representing neighbor relationships for bacteria.</p></li>
<li><p><strong>bac1</strong> (<em>pandas.Series</em>) – Data for the first bacterium (source) in the relationship.</p></li>
<li><p><strong>bac2</strong> (<em>pandas.Series</em>) – Data for the second bacterium (target) in the relationship.</p></li>
<li><p><strong>return_common_elements</strong> (<em>bool</em>) – If <cite>True</cite>, returns the number of shared neighbors in addition to differing neighbors.
Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p><cite>diff_neighbor</cite> (int): Number of differing neighbors.</p></li>
<li><p><cite>common_neighbor</cite> (int, optional): Number of shared neighbors if <cite>return_common_elements=True</cite>.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calcDistanceForML">
<span id="module-calcdistanceforml"></span><h2>Module: calcDistanceForML<a class="headerlink" href="#module-calcDistanceForML" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calcDistanceForML.calc_min_distance_ml">
<span class="sig-prename descclassname"><span class="pre">calcDistanceForML.</span></span><span class="sig-name descname"><span class="pre">calc_min_distance_ml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calcDistanceForML.html#calc_min_distance_ml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calcDistanceForML.calc_min_distance_ml" title="Link to this definition">¶</a></dt>
<dd><p>Computes the minimum distance between source and target bacteria based on their centroid
and endpoint coordinates. Supports multiple distance calculations, including distances for
division-specific comparisons.</p>
<dl class="simple">
<dt><strong>Details</strong>:</dt><dd><ul class="simple">
<li><p><strong>Centroid Distance</strong>: Euclidean distance between the centroids of source and target bacteria.</p></li>
<li><dl class="simple">
<dt><strong>Endpoint Distances</strong>:</dt><dd><ul>
<li><p>Endpoint1-to-Endpoint1 and Endpoint2-to-Endpoint2.</p></li>
<li><p>For division-specific calculations, additional distances are considered:
- Endpoint1-to-Endpoint2 and vice versa.
- Centroid-to-Endpoints for cross-movement.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing bacterial data.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of bacterial centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>postfix_source</strong> (<em>str</em>) – Suffix used to identify source-related columns in the DataFrame.</p></li>
<li><p><strong>postfix_target</strong> (<em>str</em>) – Suffix used to identify target-related columns in the DataFrame.</p></li>
<li><p><strong>link_type</strong> (<em>str</em>) – Specifies the type of distance calculation:
- <cite>‘div’</cite>: Includes additional cross-movement distances (e.g., endpoint-to-endpoint).
- <cite>None</cite>: Computes only basic distances (centroid-to-centroid and same-endpoint distances).</p></li>
<li><p><strong>df_view</strong> (<em>pandas.DataFrame</em>) – A subset of the main DataFrame for efficient computation (optional).</p></li>
</ul>
</dd>
</dl>
<dl>
<dt><strong>Returns</strong>:</dt><dd><p>pandas.DataFrame:</p>
<dl class="simple">
<dt>The updated DataFrame with the following additional columns:</dt><dd><ul class="simple">
<li><p><cite>‘min_distance’</cite>: Minimum distance between source and target considering all point pairs.</p></li>
<li><p><cite>‘min_distance_continuity’</cite> (if <cite>stat=’div’</cite>): Minimum distance excluding cross-movement distances.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calMotionAlignmentAngle">
<span id="module-calmotionalignmentangle"></span><h2>Module: calMotionAlignmentAngle<a class="headerlink" href="#module-calMotionAlignmentAngle" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calMotionAlignmentAngle.calc_motion_alignment_angle_ml">
<span class="sig-prename descclassname"><span class="pre">calMotionAlignmentAngle.</span></span><span class="sig-name descname"><span class="pre">calc_motion_alignment_angle_ml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calMotionAlignmentAngle.html#calc_motion_alignment_angle_ml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calMotionAlignmentAngle.calc_motion_alignment_angle_ml" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the motion alignment angle between the movement direction of a link (source-to-target)
and the average motion direction of neighboring bacteria. The alignment is computed in degrees,
representing the angular difference between the link’s motion and its neighbors’ average motion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The main DataFrame containing bacterial data.</p></li>
<li><p><strong>neighbor_df</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing neighbor relationships (e.g., First and Second Image/Object Numbers).</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary specifying the column names for the x and y coordinates of bacterial centroids
(e.g., <cite>{“x”: “Center_X”, “y”: “Center_Y”}</cite>).</p></li>
<li><p><strong>selected_rows</strong> (<em>pandas.DataFrame</em>) – The subset of rows for which motion alignment angles need to be computed.</p></li>
<li><p><strong>col_target</strong> (<em>str</em>) – Suffix for target-related columns in <cite>selected_rows</cite>.</p></li>
<li><p><strong>col_source</strong> (<em>str</em>) – Suffix for source-related columns in <cite>selected_rows</cite>.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt><strong>Returns</strong>:</dt><dd><p>pandas.DataFrame:</p>
<dl class="simple">
<dt>The updated <cite>selected_rows</cite> DataFrame with a new column:</dt><dd><ul class="simple">
<li><p><cite>“MotionAlignmentAngle” + col_target</cite>: The calculated motion alignment angle (degrees).</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-iouCalForML">
<span id="module-ioucalforml"></span><h2>Module: iouCalForML<a class="headerlink" href="#module-iouCalForML" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="iouCalForML.calculate_iou_ml">
<span class="sig-prename descclassname"><span class="pre">iouCalForML.</span></span><span class="sig-name descname"><span class="pre">calculate_iou_ml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prev_index_prev'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prev_index'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">both</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/iouCalForML.html#calculate_iou_ml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iouCalForML.calculate_iou_ml" title="Link to this definition">¶</a></dt>
<dd><p>Wrapper function for calculating Intersection over Union (IoU) values using <cite>compute_intersection_union</cite> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the source (<cite>col_source</cite>) and target (<cite>col_target</cite>) indices.</p></li>
<li><p><strong>link_type</strong> (<em>str</em>) – The type of link to evaluate, passed to <cite>calculate_intersections_and_unions</cite>. Options:
- <cite>‘continuity’</cite>
- <cite>‘div’</cite></p></li>
<li><p><strong>col_source</strong> (<em>str</em>) – Column name in <cite>df</cite> for source indices. Default is <cite>‘prev_index_prev’</cite>.</p></li>
<li><p><strong>col_target</strong> (<em>str</em>) – Column name in <cite>df</cite> for target indices. Default is <cite>‘prev_index’</cite>.</p></li>
<li><p><strong>df_view</strong> (<em>pandas.DataFrame</em>) – Optional subset of <cite>df</cite> to use for efficient computation. Defaults to <cite>None</cite>.</p></li>
<li><p><strong>coordinate_array</strong> (<em>scipy.sparse.csr_matrix</em>) – Sparse matrix representing the coordinate of bacteria.</p></li>
<li><p><strong>both</strong> (<em>bool</em>) – If <cite>True</cite>, computes additional IoU metrics for continuity in division links.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt><strong>Returns</strong>:</dt><dd><p>pandas.DataFrame:</p>
<dl class="simple">
<dt>The updated DataFrame <cite>df</cite> with added columns:</dt><dd><ul class="simple">
<li><p><cite>‘iou’</cite>: Inverted IoU values (1 - IoU).</p></li>
<li><p><cite>‘iou_continuity’</cite> (optional): Inverted IoU for continuity when <cite>link_type=’div’</cite> and <cite>both=True</cite>.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iouCalForML.compute_intersection_union">
<span class="sig-prename descclassname"><span class="pre">iouCalForML.</span></span><span class="sig-name descname"><span class="pre">compute_intersection_union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'continuity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">both</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/iouCalForML.html#compute_intersection_union"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iouCalForML.compute_intersection_union" title="Link to this definition">¶</a></dt>
<dd><p>Calculates intersections and unions for sparse matrices represented bacteria coordinates in <cite>coordinate_array</cite>
and derives Intersection over Union (IoU) metrics for tracking links.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the indices (<cite>col1</cite> and <cite>col2</cite>) used to query the binary matrices.</p></li>
<li><p><strong>col1</strong> (<em>str</em>) – Column name in <cite>df</cite> representing the source indices.</p></li>
<li><p><strong>col2</strong> (<em>str</em>) – Column name in <cite>df</cite> representing the target indices.</p></li>
<li><p><strong>link_type</strong> (<em>str</em>) – The type of link to evaluate. Options:
- <cite>‘continuity’</cite>: Evaluates IoU using standard intersection and union metrics.
- <cite>‘div’</cite>: Includes a modified IoU calculation for division links, where unique daughter areas are considered.</p></li>
<li><p><strong>df_view</strong> (<em>pandas.DataFrame</em>) – Optional subset of <cite>df</cite> to use for calculations. Defaults to <cite>None</cite>.</p></li>
<li><p><strong>coordinate_array</strong> (<em>scipy.sparse.csr_matrix</em>) – Sparse matrix representing the coordinate of bacteria.</p></li>
<li><p><strong>both</strong> (<em>bool</em>) – If <cite>True</cite>, computes additional IoU metrics for continuity in division links.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt><strong>Returns</strong>:</dt><dd><p>pandas.DataFrame:</p>
<dl class="simple">
<dt>The updated DataFrame <cite>df</cite> with added columns:</dt><dd><ul class="simple">
<li><p><cite>‘iou’</cite>: Calculated IoU values.</p></li>
<li><p><cite>‘iou_continuity’</cite> (optional): IoU for continuity when <cite>link_type=’div’</cite> and <cite>both=True</cite>.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-lengthRatio">
<span id="module-lengthratio"></span><h2>Module: lengthRatio<a class="headerlink" href="#module-lengthRatio" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="lengthRatio.check_len_ratio">
<span class="sig-prename descclassname"><span class="pre">lengthRatio.</span></span><span class="sig-name descname"><span class="pre">check_len_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_source</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lengthRatio.html#check_len_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lengthRatio.check_len_ratio" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the length change ratio between target and source bacteria and computes the dynamic length change.</p>
<dl class="simple">
<dt><strong>Details</strong>:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><strong>LengthChangeRatio</strong>:</dt><dd><ul>
<li><p>Computed as the ratio of the major axis lengths of the target and source bacteria.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Dynamic Length Change</strong>:</dt><dd><ul>
<li><dl class="simple">
<dt>For bacteria where the target is smaller than the source (<cite>LengthChangeRatio &lt; 1</cite>):</dt><dd><ul>
<li><p>If the source bacterium’s age is less than 2, the dynamic length is <cite>1 - LengthChangeRatio</cite>.</p></li>
<li><p>If the source bacterium’s age is 2 or greater, the dynamic length is adjusted using
the average changes in the source bacterium’s history.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>For bacteria where the target is larger than or equal to the source (<cite>LengthChangeRatio &gt;= 1</cite>),
the dynamic length is set to <cite>0</cite>.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The DataFrame containing all bacterial data.</p></li>
<li><p><strong>selected_rows</strong> (<em>pandas.DataFrame</em>) – Subset of <cite>df</cite> containing the rows to process.</p></li>
<li><p><strong>col_target</strong> (<em>str</em>) – Column suffix for the target bacterium.</p></li>
<li><p><strong>col_source</strong> (<em>str</em>) – Column suffix for the source bacterium.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt><strong>Returns</strong>:</dt><dd><p>pandas.DataFrame:</p>
<p>The updated <cite>selected_rows</cite> DataFrame with a new column <cite>length_dynamic</cite> appended for the target bacteria.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-propagateBacteriaLabels">
<span id="module-propagatebacterialabels"></span><h2>Module: propagateBacteriaLabels<a class="headerlink" href="#module-propagateBacteriaLabels" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="propagateBacteriaLabels.propagate_bacteria_labels">
<span class="sig-prename descclassname"><span class="pre">propagateBacteriaLabels.</span></span><span class="sig-name descname"><span class="pre">propagate_bacteria_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_image_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_object_number_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/propagateBacteriaLabels.html#propagate_bacteria_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propagateBacteriaLabels.propagate_bacteria_labels" title="Link to this definition">¶</a></dt>
<dd><p>Assign or propagate labels for bacteria based on parent-child relationships.</p>
<p>This function assigns unique labels to bacteria and propagates them across frames based on
parent-child relationships in tracking data. It ensures consistent labeling of bacteria
across multiple time steps by leveraging parent image and object identifiers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Input dataframe containing bacterial tracking data, including parent-child relationships.</p></li>
<li><p><strong>parent_image_number_col</strong> (<em>str</em>) – Name of the column representing the parent image number.</p></li>
<li><p><strong>parent_object_number_col</strong> (<em>str</em>) – Name of the column representing the parent object number.</p></li>
<li><p><strong>label_col</strong> (<em>str</em>) – Name of the column to assign or propagate labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pd.DataFrame</p>
<p>Updated dataframe with assigned or propagated labels in the specified column.
Also adds a <cite>checked</cite> column to indicate whether a row has been processed.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bacterialLifeHistoryAnalysis">
<span id="module-bacteriallifehistoryanalysis"></span><h2>Module: bacterialLifeHistoryAnalysis<a class="headerlink" href="#module-bacterialLifeHistoryAnalysis" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bacterialLifeHistoryAnalysis.process_bacterial_life_and_family">
<span class="sig-prename descclassname"><span class="pre">bacterialLifeHistoryAnalysis.</span></span><span class="sig-name descname"><span class="pre">process_bacterial_life_and_family</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processed_cp_out_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elongation_rate_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assigning_cell_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_type_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacterialLifeHistoryAnalysis.html#process_bacterial_life_and_family"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bacterialLifeHistoryAnalysis.process_bacterial_life_and_family" title="Link to this definition">¶</a></dt>
<dd><p>Calculates additional features related to the life history of bacteria from a processed
CellProfiler output DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processed_cp_out_df</strong> (<em>pandas.DataFrame</em>) – Processed CellProfiler output DataFrame containing measured bacterial features.</p></li>
<li><p><strong>interval_time</strong> (<em>float</em>) – Time interval between consecutive images (in minutes).</p></li>
<li><p><strong>elongation_rate_method</strong> (<em>str</em>) – Method for calculating the Elongation rate. Options:
- ‘Average’: Computes the average elongation rate.
- ‘Linear Regression’: Estimates the elongation rate using linear regression.</p></li>
<li><p><strong>assigning_cell_type</strong> (<em>bool</em>) – If True, assigns cell types to objects based on intensity thresholds.</p></li>
<li><p><strong>cell_type_array</strong> (<em>numpy.ndarray</em>) – A boolean array indicating the channel in which the intensity exceeds the threshold for each bacterium.</p></li>
<li><p><strong>label_col</strong> (<em>str</em>) – Column name in the CellProfiler DataFrame that indicates the label of bacteria during tracking.</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary with keys ‘x’ and ‘y’, specifying the column names for center coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>processed_cp_out_df (pandas.DataFrame):</dt><dd><p>A DataFrame including new features related to the life history and family of bacteria.</p>
</dd>
<dt>data_frame_with_selected_col (pandas.DataFrame):</dt><dd><p>A subset of <cite>processed_cp_out_df</cite> that includes specific columns to save in numpy output files.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calcElongationRate">
<span id="module-calcelongationrate"></span><h2>Module: calcElongationRate<a class="headerlink" href="#module-calcElongationRate" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calcElongationRate.calculate_average_elongation_rate">
<span class="sig-prename descclassname"><span class="pre">calcElongationRate.</span></span><span class="sig-name descname"><span class="pre">calculate_average_elongation_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">division_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">birth_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calcElongationRate.html#calculate_average_elongation_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calcElongationRate.calculate_average_elongation_rate" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the average elongation rate of a bacterium over its lifecycle based on initial and final logarithm lengths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>division_length</strong> (<em>float</em>) – The length of the bacterium at the time of division (final length).</p></li>
<li><p><strong>birth_length</strong> (<em>float</em>) – The length of the bacterium at birth (initial length).</p></li>
<li><p><strong>t</strong> (<em>float</em>) – The total time duration of the lifecycle (unit: minute).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>float:</p>
<p>The calculated average elongation rate. This represents the logarithmic elongation rate per minute.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calcElongationRate.calculate_elongation_rate">
<span class="sig-prename descclassname"><span class="pre">calcElongationRate.</span></span><span class="sig-name descname"><span class="pre">calculate_elongation_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_life_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elongation_rate_method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calcElongationRate.html#calculate_elongation_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calcElongationRate.calculate_elongation_rate" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the elongation rate of a bacterium based on its life history data and the specified method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_life_history</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing the life history of bacteria</p></li>
<li><p><strong>interval_time</strong> (<em>float</em>) – Time interval between consecutive images (in minutes).</p></li>
<li><p><strong>elongation_rate_method</strong> (<em>str</em>) – The method used for calculating the elongation rate. Options include:
- “Average”: Calculates the average elongation rate based on initial and final lengths.
- “Linear Regression”: Fits a linear regression to the length vs. time data to estimate the elongation rate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>float:</p>
<p>The calculated elongation rate. If the bacterium is observed for only one time step, returns NaN.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="calcElongationRate.calculate_linear_regression_elongation_rate">
<span class="sig-prename descclassname"><span class="pre">calcElongationRate.</span></span><span class="sig-name descname"><span class="pre">calculate_linear_regression_elongation_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calcElongationRate.html#calculate_linear_regression_elongation_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calcElongationRate.calculate_linear_regression_elongation_rate" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the elongation rate of a bacterium using linear regression on the logarithm of length
as a function of time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>numpy.ndarray</em>) – Array of time points corresponding to the bacterium’s lifecycle.</p></li>
<li><p><strong>length</strong> (<em>numpy.ndarray</em>) – Array of major length measurements for the bacterium at the corresponding time points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>float:</p>
<p>The calculated elongation rate (slope of the logarithm of length vs. time).</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-calcVelocity">
<span id="module-calcvelocity"></span><h2>Module: calcVelocity<a class="headerlink" href="#module-calcVelocity" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="calcVelocity.calc_average_velocity">
<span class="sig-prename descclassname"><span class="pre">calcVelocity.</span></span><span class="sig-name descname"><span class="pre">calc_average_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_life_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coord_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/calcVelocity.html#calc_average_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#calcVelocity.calc_average_velocity" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the velocity of a bacterium based on its life history data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_life_history</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing the life history of bacteria</p></li>
<li><p><strong>center_coord_cols</strong> (<em>dict</em>) – A dictionary with keys ‘x’ and ‘y’, specifying the column names for center coordinates.</p></li>
<li><p><strong>interval_time</strong> (<em>float</em>) – Time interval between consecutive images (in minutes).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>float:</p>
<p>The calculated velocity. If the bacterium is observed for only one time step, returns NaN.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fluorescenceIntensity">
<span id="module-fluorescenceintensity"></span><h2>Module: fluorescenceIntensity<a class="headerlink" href="#module-fluorescenceIntensity" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fluorescenceIntensity.assign_cell_types">
<span class="sig-prename descclassname"><span class="pre">fluorescenceIntensity.</span></span><span class="sig-name descname"><span class="pre">assign_cell_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity_threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluorescenceIntensity.html#assign_cell_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluorescenceIntensity.assign_cell_types" title="Link to this definition">¶</a></dt>
<dd><p>Assigns binary cell type labels based on fluorescence intensity thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing intensity data and other features.</p></li>
<li><p><strong>intensity_threshold</strong> (<em>float</em>) – Threshold value above which a cell type is marked as present (1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>numpy.ndarray:</p>
<p>A 2D numpy array where each row represents a cell, and each column represents a cell type, marked as 1 or 0
based on intensity threshold.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluorescenceIntensity.determine_final_cell_type">
<span class="sig-prename descclassname"><span class="pre">fluorescenceIntensity.</span></span><span class="sig-name descname"><span class="pre">determine_final_cell_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_type_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluorescenceIntensity.html#determine_final_cell_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluorescenceIntensity.determine_final_cell_type" title="Link to this definition">¶</a></dt>
<dd><p>Determines and assigns the final cell type classification for each bacterium based on fluorescence intensity data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing bacterial data and fluorescence intensity columns.</p></li>
<li><p><strong>cell_type_array</strong> (<em>numpy.ndarray</em>) – A 2D numpy array where each row represents a bacterial cell, and each column represents
a binary classification (1 or 0) of a specific cell type based on intensity thresholds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>pandas.DataFrame:
Updated DataFrame with a new column ‘cellType’ representing the final cell type
classification for each bacterium:</p>
<blockquote>
<div><ul class="simple">
<li><p>3: Assigned if the fluorescence intensities of at least two channels exceed the defined threshold.</p></li>
<li><p>Specific values (e.g., 2, 3, etc.): Assigned if only one channel’s intensity exceeds the threshold.</p></li>
<li><p>0: Assigned if none of the fluorescence intensities across all channels exceed the defined threshold.</p></li>
<li><p>1: Default cell type assigned when only one intensity column exists.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluorescenceIntensity.get_fluorescence_intensity_columns">
<span class="sig-prename descclassname"><span class="pre">fluorescenceIntensity.</span></span><span class="sig-name descname"><span class="pre">get_fluorescence_intensity_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluorescenceIntensity.html#get_fluorescence_intensity_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluorescenceIntensity.get_fluorescence_intensity_columns" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves a sorted list of fluorescence intensity column names from the provided DataFrame column names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataframe_col</strong> (<em>pandas.Series</em>) – A Pandas Series containing column names from a DataFrame.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>list:</p>
<p>A sorted list of column names that contain the substring <cite>Intensity_MeanIntensity_</cite>.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluorescenceIntensity.mark_cell_types_by_intensity">
<span class="sig-prename descclassname"><span class="pre">fluorescenceIntensity.</span></span><span class="sig-name descname"><span class="pre">mark_cell_types_by_intensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_type_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity_threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluorescenceIntensity.html#mark_cell_types_by_intensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluorescenceIntensity.mark_cell_types_by_intensity" title="Link to this definition">¶</a></dt>
<dd><p>Marks cell types as present (1) or absent (0) based on intensity threshold values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing intensity data for each cell type across multiple columns.</p></li>
<li><p><strong>cell_type_array</strong> (<em>numpy.ndarray</em>) – A 2D numpy array where each row represents a bacterial cell, and each column represents
a cell type. This array will be updated with binary values (0 or 1) based on the intensity threshold.</p></li>
<li><p><strong>cols</strong> (<em>list</em>) – List of column names in <cite>df</cite> corresponding to cell types whose intensities need to be checked.</p></li>
<li><p><strong>intensity_threshold</strong> (<em>float</em>) – Threshold value above which the cell type is considered present (marked as 1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>numpy.ndarray:</p>
<p>Updated 2D numpy array with binary marks indicating cell type presence for each bacterial cell.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-drawDistributionPlot">
<span id="module-drawdistributionplot"></span><h2>Module: drawDistributionPlot<a class="headerlink" href="#module-drawDistributionPlot" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="drawDistributionPlot.calculate_frequency">
<span class="sig-prename descclassname"><span class="pre">drawDistributionPlot.</span></span><span class="sig-name descname"><span class="pre">calculate_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_related_col_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drawDistributionPlot.html#calculate_frequency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drawDistributionPlot.calculate_frequency" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the frequency of unique values in a given array and return the result as a DataFrame.</p>
<p>This function computes the frequency of each unique value in the input array and returns
the results in a pandas DataFrame with columns for the unique values and their respective frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>numpy.ndarray</em>) – A 1D array of values for which the frequency distribution is to be calculated.</p></li>
<li><p><strong>feature_related_col_name</strong> (<em>str</em>) – The name to use for the column representing unique values in the output DataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame: A DataFrame with the following columns:
- ‘&lt;feature_related_col_name&gt;’: The unique values from the array.
- ‘Frequency’: The count of each unique value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drawDistributionPlot.draw_feature_distribution">
<span class="sig-prename descclassname"><span class="pre">drawDistributionPlot.</span></span><span class="sig-name descname"><span class="pre">draw_feature_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doubling_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drawDistributionPlot.html#draw_feature_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drawDistributionPlot.draw_feature_distribution" title="Link to this definition">¶</a></dt>
<dd><p>Generate and plot the distribution of selected features from a DataFrame.</p>
<p>This function iterates through a dictionary of features, calculates their frequency distribution,
assigns them to bins, and visualizes the distribution with bar plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The input DataFrame containing feature data to analyze.</p></li>
<li><p><strong>features_dict</strong> (<em>dict</em>) – A dictionary mapping feature column names to descriptive labels and type of analysis for plotting.</p></li>
<li><p><strong>label_col</strong> (<em>str</em>) – Name of the column for object labels.</p></li>
<li><p><strong>interval_time</strong> (<em>float</em>) – Time interval to scale the ‘LifeHistory’ feature.</p></li>
<li><p><strong>doubling_time</strong> (<em>float</em>) – Threshold for filtering ‘LifeHistory’ values.</p></li>
<li><p><strong>output_path</strong> (<em>str</em>) – The directory path where the plots will be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. The plots are saved as JPG files in the specified output directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drawDistributionPlot.plot_frequency_distribution">
<span class="sig-prename descclassname"><span class="pre">drawDistributionPlot.</span></span><span class="sig-name descname"><span class="pre">plot_frequency_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grouped_sel_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_axis_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drawDistributionPlot.html#plot_frequency_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drawDistributionPlot.plot_frequency_distribution" title="Link to this definition">¶</a></dt>
<dd><p>Plot the frequency distribution of a selected feature and save the output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_positions</strong> (<em>numpy.ndarray</em>) – An array of x-axis positions for the grouped frequency bars.</p></li>
<li><p><strong>grouped_sel_feature</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing grouped frequency data to plot.</p></li>
<li><p><strong>bin_labels</strong> (<em>list</em>) – Labels for the x-axis bins.</p></li>
<li><p><strong>feature</strong> (<em>str</em>) – The name of the feature being plotted.</p></li>
<li><p><strong>feature_name</strong> (<em>str</em>) – A descriptive label for the feature (used for x-axis labeling).</p></li>
<li><p><strong>y_axis_value</strong> (<em>str</em>) – A descriptive label for y-axis labeling.</p></li>
<li><p><strong>output_path</strong> (<em>str</em>) – The directory path where the plot will be saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Atiyeh Ahmadi
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Modules</a><ul>
<li><a class="reference internal" href="#module-processCellProfilerData">Module: processCellProfilerData</a><ul>
<li><a class="reference internal" href="#processCellProfilerData.process_objects_data"><code class="docutils literal notranslate"><span class="pre">process_objects_data()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-findFixTrackingErrors">Module: findFixTrackingErrors</a><ul>
<li><a class="reference internal" href="#findFixTrackingErrors.calculate_bacteria_features_and_assign_flags"><code class="docutils literal notranslate"><span class="pre">calculate_bacteria_features_and_assign_flags()</span></code></a></li>
<li><a class="reference internal" href="#findFixTrackingErrors.find_fix_tracking_errors"><code class="docutils literal notranslate"><span class="pre">find_fix_tracking_errors()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-multiRegionsDetection">Module: multiRegionsDetection</a><ul>
<li><a class="reference internal" href="#multiRegionsDetection.map_and_detect_multi_regions"><code class="docutils literal notranslate"><span class="pre">map_and_detect_multi_regions()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-multiRegionsCorrection">Module: multiRegionsCorrection</a><ul>
<li><a class="reference internal" href="#multiRegionsCorrection.modify_existing_object"><code class="docutils literal notranslate"><span class="pre">modify_existing_object()</span></code></a></li>
<li><a class="reference internal" href="#multiRegionsCorrection.multi_region_correction"><code class="docutils literal notranslate"><span class="pre">multi_region_correction()</span></code></a></li>
<li><a class="reference internal" href="#multiRegionsCorrection.remove_object_from_image"><code class="docutils literal notranslate"><span class="pre">remove_object_from_image()</span></code></a></li>
<li><a class="reference internal" href="#multiRegionsCorrection.update_object_records"><code class="docutils literal notranslate"><span class="pre">update_object_records()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-regionOfInterestFilter">Module: regionOfInterestFilter</a><ul>
<li><a class="reference internal" href="#regionOfInterestFilter.filter_objects_outside_boundary"><code class="docutils literal notranslate"><span class="pre">filter_objects_outside_boundary()</span></code></a></li>
<li><a class="reference internal" href="#regionOfInterestFilter.filter_objects_outside_dynamic_boundary"><code class="docutils literal notranslate"><span class="pre">filter_objects_outside_dynamic_boundary()</span></code></a></li>
<li><a class="reference internal" href="#regionOfInterestFilter.find_inside_boundary_objects"><code class="docutils literal notranslate"><span class="pre">find_inside_boundary_objects()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-noiseObjects">Module: noiseObjects</a><ul>
<li><a class="reference internal" href="#noiseObjects.detect_and_remove_noise_bacteria"><code class="docutils literal notranslate"><span class="pre">detect_and_remove_noise_bacteria()</span></code></a></li>
<li><a class="reference internal" href="#noiseObjects.update_tracking_after_removing_noise"><code class="docutils literal notranslate"><span class="pre">update_tracking_after_removing_noise()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-bacterialBehaviorModelTraining">Module: bacterialBehaviorModelTraining</a><ul>
<li><a class="reference internal" href="#bacterialBehaviorModelTraining.train_bacterial_behavior_models"><code class="docutils literal notranslate"><span class="pre">train_bacterial_behavior_models()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-mlModelDivisionVsNonDivision">Module: mlModelDivisionVsNonDivision</a><ul>
<li><a class="reference internal" href="#mlModelDivisionVsNonDivision.train_division_vs_non_division_model"><code class="docutils literal notranslate"><span class="pre">train_division_vs_non_division_model()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-mlModelNonDividedBacteria">Module: mlModelNonDividedBacteria</a><ul>
<li><a class="reference internal" href="#mlModelNonDividedBacteria.train_non_divided_bacteria_model"><code class="docutils literal notranslate"><span class="pre">train_non_divided_bacteria_model()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-mlModelDividedBacteria">Module: mlModelDividedBacteria</a><ul>
<li><a class="reference internal" href="#mlModelDividedBacteria.train_divided_bacteria_model"><code class="docutils literal notranslate"><span class="pre">train_divided_bacteria_model()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-machineLearningPipeline">Module: machineLearningPipeline</a><ul>
<li><a class="reference internal" href="#machineLearningPipeline.log_model_performance"><code class="docutils literal notranslate"><span class="pre">log_model_performance()</span></code></a></li>
<li><a class="reference internal" href="#machineLearningPipeline.train_model"><code class="docutils literal notranslate"><span class="pre">train_model()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-findOutlier">Module: findOutlier</a><ul>
<li><a class="reference internal" href="#findOutlier.calculate_bacterial_length_boundary"><code class="docutils literal notranslate"><span class="pre">calculate_bacterial_length_boundary()</span></code></a></li>
<li><a class="reference internal" href="#findOutlier.calculate_length_change_ratio_boundary"><code class="docutils literal notranslate"><span class="pre">calculate_length_change_ratio_boundary()</span></code></a></li>
<li><a class="reference internal" href="#findOutlier.calculate_lower_statistical_bound"><code class="docutils literal notranslate"><span class="pre">calculate_lower_statistical_bound()</span></code></a></li>
<li><a class="reference internal" href="#findOutlier.calculate_max_daughter_to_mother_boundary"><code class="docutils literal notranslate"><span class="pre">calculate_max_daughter_to_mother_boundary()</span></code></a></li>
<li><a class="reference internal" href="#findOutlier.calculate_sum_daughter_to_mother_len_boundary"><code class="docutils literal notranslate"><span class="pre">calculate_sum_daughter_to_mother_len_boundary()</span></code></a></li>
<li><a class="reference internal" href="#findOutlier.calculate_upper_statistical_bound"><code class="docutils literal notranslate"><span class="pre">calculate_upper_statistical_bound()</span></code></a></li>
<li><a class="reference internal" href="#findOutlier.detect_daughter_to_mother_length_outliers"><code class="docutils literal notranslate"><span class="pre">detect_daughter_to_mother_length_outliers()</span></code></a></li>
<li><a class="reference internal" href="#findOutlier.detect_length_change_ratio_outliers"><code class="docutils literal notranslate"><span class="pre">detect_length_change_ratio_outliers()</span></code></a></li>
<li><a class="reference internal" href="#findOutlier.find_bacterial_length_outliers"><code class="docutils literal notranslate"><span class="pre">find_bacterial_length_outliers()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-overAssignedDaughters">Module: overAssignedDaughters</a><ul>
<li><a class="reference internal" href="#overAssignedDaughters.resolve_over_assigned_daughters_link"><code class="docutils literal notranslate"><span class="pre">resolve_over_assigned_daughters_link()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-redundantParentLink">Module: redundantParentLink</a><ul>
<li><a class="reference internal" href="#redundantParentLink.detect_and_resolve_redundant_parent_link"><code class="docutils literal notranslate"><span class="pre">detect_and_resolve_redundant_parent_link()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-missingConnectivityLink">Module: missingConnectivityLink</a><ul>
<li><a class="reference internal" href="#missingConnectivityLink.detect_and_resolve_missing_connectivity_link"><code class="docutils literal notranslate"><span class="pre">detect_and_resolve_missing_connectivity_link()</span></code></a></li>
<li><a class="reference internal" href="#missingConnectivityLink.resolve_missing_connectivity_links"><code class="docutils literal notranslate"><span class="pre">resolve_missing_connectivity_links()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-unexpectedBeginning">Module: unexpectedBeginning</a><ul>
<li><a class="reference internal" href="#unexpectedBeginning.handle_unexpected_beginning_bacteria"><code class="docutils literal notranslate"><span class="pre">handle_unexpected_beginning_bacteria()</span></code></a></li>
<li><a class="reference internal" href="#unexpectedBeginning.resolve_unexpected_beginning_bacteria"><code class="docutils literal notranslate"><span class="pre">resolve_unexpected_beginning_bacteria()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-unExpectedEnd">Module: unExpectedEnd</a><ul>
<li><a class="reference internal" href="#unExpectedEnd.handle_unexpected_end_bacteria"><code class="docutils literal notranslate"><span class="pre">handle_unexpected_end_bacteria()</span></code></a></li>
<li><a class="reference internal" href="#unExpectedEnd.resolve_unexpected_end_bacteria"><code class="docutils literal notranslate"><span class="pre">resolve_unexpected_end_bacteria()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-restoringTrackingLinks">Module: restoringTrackingLinks</a><ul>
<li><a class="reference internal" href="#restoringTrackingLinks.add_tracking_link"><code class="docutils literal notranslate"><span class="pre">add_tracking_link()</span></code></a></li>
<li><a class="reference internal" href="#restoringTrackingLinks.restore_tracking_links"><code class="docutils literal notranslate"><span class="pre">restore_tracking_links()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-candidateBacteriaFeatureSpace">Module: candidateBacteriaFeatureSpace</a><ul>
<li><a class="reference internal" href="#candidateBacteriaFeatureSpace.find_candidates_for_unexpected_beginning"><code class="docutils literal notranslate"><span class="pre">find_candidates_for_unexpected_beginning()</span></code></a></li>
<li><a class="reference internal" href="#candidateBacteriaFeatureSpace.find_candidates_for_unexpected_end"><code class="docutils literal notranslate"><span class="pre">find_candidates_for_unexpected_end()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calculateInitialCostTerms">Module: calculateInitialCostTerms</a><ul>
<li><a class="reference internal" href="#calculateInitialCostTerms.calc_distance_and_overlap_matrices"><code class="docutils literal notranslate"><span class="pre">calc_distance_and_overlap_matrices()</span></code></a></li>
<li><a class="reference internal" href="#calculateInitialCostTerms.calc_distance_term_for_maintain_continuity_links"><code class="docutils literal notranslate"><span class="pre">calc_distance_term_for_maintain_continuity_links()</span></code></a></li>
<li><a class="reference internal" href="#calculateInitialCostTerms.calc_distance_term_for_maintain_division"><code class="docutils literal notranslate"><span class="pre">calc_distance_term_for_maintain_division()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calculateCreateLinkCost">Module: calculateCreateLinkCost</a><ul>
<li><a class="reference internal" href="#calculateCreateLinkCost.calc_continuity_link_cost"><code class="docutils literal notranslate"><span class="pre">calc_continuity_link_cost()</span></code></a></li>
<li><a class="reference internal" href="#calculateCreateLinkCost.calc_continuity_link_cost_for_restoring_links"><code class="docutils literal notranslate"><span class="pre">calc_continuity_link_cost_for_restoring_links()</span></code></a></li>
<li><a class="reference internal" href="#calculateCreateLinkCost.calc_division_link_cost"><code class="docutils literal notranslate"><span class="pre">calc_division_link_cost()</span></code></a></li>
<li><a class="reference internal" href="#calculateCreateLinkCost.calc_division_link_cost_for_restoring_links"><code class="docutils literal notranslate"><span class="pre">calc_division_link_cost_for_restoring_links()</span></code></a></li>
<li><a class="reference internal" href="#calculateCreateLinkCost.optimize_assignment_using_hungarian"><code class="docutils literal notranslate"><span class="pre">optimize_assignment_using_hungarian()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calculateMaintainingLinkCost">Module: calculateMaintainingLinkCost</a><ul>
<li><a class="reference internal" href="#calculateMaintainingLinkCost.calc_maintain_exist_link_cost"><code class="docutils literal notranslate"><span class="pre">calc_maintain_exist_link_cost()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calculateCreateLinkCostMCC">Module: calculateCreateLinkCostMCC</a><ul>
<li><a class="reference internal" href="#calculateCreateLinkCostMCC.create_continuity_link_cost"><code class="docutils literal notranslate"><span class="pre">create_continuity_link_cost()</span></code></a></li>
<li><a class="reference internal" href="#calculateCreateLinkCostMCC.division_detection_cost"><code class="docutils literal notranslate"><span class="pre">division_detection_cost()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calculateCreateLinkCostUB">Module: calculateCreateLinkCostUB</a><ul>
<li><a class="reference internal" href="#calculateCreateLinkCostUB.compute_create_link_to_unexpected_beginning_cost"><code class="docutils literal notranslate"><span class="pre">compute_create_link_to_unexpected_beginning_cost()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-evaluateDivisionLinkForUB">Module: evaluateDivisionLinkForUB</a><ul>
<li><a class="reference internal" href="#evaluateDivisionLinkForUB.evaluate_division_link_feasibility"><code class="docutils literal notranslate"><span class="pre">evaluate_division_link_feasibility()</span></code></a></li>
<li><a class="reference internal" href="#evaluateDivisionLinkForUB.evaluate_new_division_link"><code class="docutils literal notranslate"><span class="pre">evaluate_new_division_link()</span></code></a></li>
<li><a class="reference internal" href="#evaluateDivisionLinkForUB.evaluate_replacement_daughter_link"><code class="docutils literal notranslate"><span class="pre">evaluate_replacement_daughter_link()</span></code></a></li>
<li><a class="reference internal" href="#evaluateDivisionLinkForUB.handle_two_daughter_links"><code class="docutils literal notranslate"><span class="pre">handle_two_daughter_links()</span></code></a></li>
<li><a class="reference internal" href="#evaluateDivisionLinkForUB.update_division_cost_and_redundant_links"><code class="docutils literal notranslate"><span class="pre">update_division_cost_and_redundant_links()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calculateCreateLinkCostUE">Module: calculateCreateLinkCostUE</a><ul>
<li><a class="reference internal" href="#calculateCreateLinkCostUE.compute_create_link_from_unexpected_end_cost"><code class="docutils literal notranslate"><span class="pre">compute_create_link_from_unexpected_end_cost()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-bacteriaTrackingUpdate">Module: bacteriaTrackingUpdate</a><ul>
<li><a class="reference internal" href="#bacteriaTrackingUpdate.bacteria_modification"><code class="docutils literal notranslate"><span class="pre">bacteria_modification()</span></code></a></li>
<li><a class="reference internal" href="#bacteriaTrackingUpdate.calc_modified_features"><code class="docutils literal notranslate"><span class="pre">calc_modified_features()</span></code></a></li>
<li><a class="reference internal" href="#bacteriaTrackingUpdate.remove_redundant_link"><code class="docutils literal notranslate"><span class="pre">remove_redundant_link()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-0">Module: helper</a><ul>
<li><a class="reference internal" href="#helper.calc_distance_matrix"><code class="docutils literal notranslate"><span class="pre">calc_distance_matrix()</span></code></a></li>
<li><a class="reference internal" href="#helper.calc_movement"><code class="docutils literal notranslate"><span class="pre">calc_movement()</span></code></a></li>
<li><a class="reference internal" href="#helper.calc_neighbors_dir_motion_all"><code class="docutils literal notranslate"><span class="pre">calc_neighbors_dir_motion_all()</span></code></a></li>
<li><a class="reference internal" href="#helper.calc_normalized_angle_between_motion_for_df"><code class="docutils literal notranslate"><span class="pre">calc_normalized_angle_between_motion_for_df()</span></code></a></li>
<li><a class="reference internal" href="#helper.calculate_all_bac_endpoints"><code class="docutils literal notranslate"><span class="pre">calculate_all_bac_endpoints()</span></code></a></li>
<li><a class="reference internal" href="#helper.calculate_all_bac_slopes"><code class="docutils literal notranslate"><span class="pre">calculate_all_bac_slopes()</span></code></a></li>
<li><a class="reference internal" href="#helper.calculate_angles_between_slopes"><code class="docutils literal notranslate"><span class="pre">calculate_angles_between_slopes()</span></code></a></li>
<li><a class="reference internal" href="#helper.calculate_bac_endpoints"><code class="docutils literal notranslate"><span class="pre">calculate_bac_endpoints()</span></code></a></li>
<li><a class="reference internal" href="#helper.calculate_bacterial_life_history_features"><code class="docutils literal notranslate"><span class="pre">calculate_bacterial_life_history_features()</span></code></a></li>
<li><a class="reference internal" href="#helper.calculate_normalized_angle_between_motion_vectors"><code class="docutils literal notranslate"><span class="pre">calculate_normalized_angle_between_motion_vectors()</span></code></a></li>
<li><a class="reference internal" href="#helper.calculate_trajectory_angles"><code class="docutils literal notranslate"><span class="pre">calculate_trajectory_angles()</span></code></a></li>
<li><a class="reference internal" href="#helper.calculate_trajectory_displacement"><code class="docutils literal notranslate"><span class="pre">calculate_trajectory_displacement()</span></code></a></li>
<li><a class="reference internal" href="#helper.convert_angle_to_radian"><code class="docutils literal notranslate"><span class="pre">convert_angle_to_radian()</span></code></a></li>
<li><a class="reference internal" href="#helper.convert_end_points_um_to_pixel"><code class="docutils literal notranslate"><span class="pre">convert_end_points_um_to_pixel()</span></code></a></li>
<li><a class="reference internal" href="#helper.convert_pixel_to_um"><code class="docutils literal notranslate"><span class="pre">convert_pixel_to_um()</span></code></a></li>
<li><a class="reference internal" href="#helper.convert_um_to_pixel"><code class="docutils literal notranslate"><span class="pre">convert_um_to_pixel()</span></code></a></li>
<li><a class="reference internal" href="#helper.extract_bacteria_features"><code class="docutils literal notranslate"><span class="pre">extract_bacteria_features()</span></code></a></li>
<li><a class="reference internal" href="#helper.extract_bacteria_info"><code class="docutils literal notranslate"><span class="pre">extract_bacteria_info()</span></code></a></li>
<li><a class="reference internal" href="#helper.identify_important_columns"><code class="docutils literal notranslate"><span class="pre">identify_important_columns()</span></code></a></li>
<li><a class="reference internal" href="#helper.update_dataframe_with_selected_rows"><code class="docutils literal notranslate"><span class="pre">update_dataframe_with_selected_rows()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calculateOverlap">Module: calculateOverlap</a><ul>
<li><a class="reference internal" href="#calculateOverlap.calculate_frame_existence_links"><code class="docutils literal notranslate"><span class="pre">calculate_frame_existence_links()</span></code></a></li>
<li><a class="reference internal" href="#calculateOverlap.compute_intersections_and_unions"><code class="docutils literal notranslate"><span class="pre">compute_intersections_and_unions()</span></code></a></li>
<li><a class="reference internal" href="#calculateOverlap.compute_intersections_and_unions_division"><code class="docutils literal notranslate"><span class="pre">compute_intersections_and_unions_division()</span></code></a></li>
<li><a class="reference internal" href="#calculateOverlap.find_overlap_oad_mother_daughters"><code class="docutils literal notranslate"><span class="pre">find_overlap_oad_mother_daughters()</span></code></a></li>
<li><a class="reference internal" href="#calculateOverlap.track_object_overlaps_to_next_frame"><code class="docutils literal notranslate"><span class="pre">track_object_overlaps_to_next_frame()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-neighborAnalysis">Module: neighborAnalysis</a><ul>
<li><a class="reference internal" href="#neighborAnalysis.compare_neighbor_sets"><code class="docutils literal notranslate"><span class="pre">compare_neighbor_sets()</span></code></a></li>
<li><a class="reference internal" href="#neighborAnalysis.compare_neighbors_batch"><code class="docutils literal notranslate"><span class="pre">compare_neighbors_batch()</span></code></a></li>
<li><a class="reference internal" href="#neighborAnalysis.compare_neighbors_single_pair"><code class="docutils literal notranslate"><span class="pre">compare_neighbors_single_pair()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calcDistanceForML">Module: calcDistanceForML</a><ul>
<li><a class="reference internal" href="#calcDistanceForML.calc_min_distance_ml"><code class="docutils literal notranslate"><span class="pre">calc_min_distance_ml()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calMotionAlignmentAngle">Module: calMotionAlignmentAngle</a><ul>
<li><a class="reference internal" href="#calMotionAlignmentAngle.calc_motion_alignment_angle_ml"><code class="docutils literal notranslate"><span class="pre">calc_motion_alignment_angle_ml()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-iouCalForML">Module: iouCalForML</a><ul>
<li><a class="reference internal" href="#iouCalForML.calculate_iou_ml"><code class="docutils literal notranslate"><span class="pre">calculate_iou_ml()</span></code></a></li>
<li><a class="reference internal" href="#iouCalForML.compute_intersection_union"><code class="docutils literal notranslate"><span class="pre">compute_intersection_union()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-lengthRatio">Module: lengthRatio</a><ul>
<li><a class="reference internal" href="#lengthRatio.check_len_ratio"><code class="docutils literal notranslate"><span class="pre">check_len_ratio()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-propagateBacteriaLabels">Module: propagateBacteriaLabels</a><ul>
<li><a class="reference internal" href="#propagateBacteriaLabels.propagate_bacteria_labels"><code class="docutils literal notranslate"><span class="pre">propagate_bacteria_labels()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-bacterialLifeHistoryAnalysis">Module: bacterialLifeHistoryAnalysis</a><ul>
<li><a class="reference internal" href="#bacterialLifeHistoryAnalysis.process_bacterial_life_and_family"><code class="docutils literal notranslate"><span class="pre">process_bacterial_life_and_family()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calcElongationRate">Module: calcElongationRate</a><ul>
<li><a class="reference internal" href="#calcElongationRate.calculate_average_elongation_rate"><code class="docutils literal notranslate"><span class="pre">calculate_average_elongation_rate()</span></code></a></li>
<li><a class="reference internal" href="#calcElongationRate.calculate_elongation_rate"><code class="docutils literal notranslate"><span class="pre">calculate_elongation_rate()</span></code></a></li>
<li><a class="reference internal" href="#calcElongationRate.calculate_linear_regression_elongation_rate"><code class="docutils literal notranslate"><span class="pre">calculate_linear_regression_elongation_rate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-calcVelocity">Module: calcVelocity</a><ul>
<li><a class="reference internal" href="#calcVelocity.calc_average_velocity"><code class="docutils literal notranslate"><span class="pre">calc_average_velocity()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-fluorescenceIntensity">Module: fluorescenceIntensity</a><ul>
<li><a class="reference internal" href="#fluorescenceIntensity.assign_cell_types"><code class="docutils literal notranslate"><span class="pre">assign_cell_types()</span></code></a></li>
<li><a class="reference internal" href="#fluorescenceIntensity.determine_final_cell_type"><code class="docutils literal notranslate"><span class="pre">determine_final_cell_type()</span></code></a></li>
<li><a class="reference internal" href="#fluorescenceIntensity.get_fluorescence_intensity_columns"><code class="docutils literal notranslate"><span class="pre">get_fluorescence_intensity_columns()</span></code></a></li>
<li><a class="reference internal" href="#fluorescenceIntensity.mark_cell_types_by_intensity"><code class="docutils literal notranslate"><span class="pre">mark_cell_types_by_intensity()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-drawDistributionPlot">Module: drawDistributionPlot</a><ul>
<li><a class="reference internal" href="#drawDistributionPlot.calculate_frequency"><code class="docutils literal notranslate"><span class="pre">calculate_frequency()</span></code></a></li>
<li><a class="reference internal" href="#drawDistributionPlot.draw_feature_distribution"><code class="docutils literal notranslate"><span class="pre">draw_feature_distribution()</span></code></a></li>
<li><a class="reference internal" href="#drawDistributionPlot.plot_frequency_distribution"><code class="docutils literal notranslate"><span class="pre">plot_frequency_distribution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=cb975c41"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>